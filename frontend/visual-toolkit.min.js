"use strict";var VisualToolkit=(()=>{var wn=Object.defineProperty;var Ht=Object.getOwnPropertyDescriptor;var Yt=Object.getOwnPropertyNames;var qt=Object.prototype.hasOwnProperty;var W=(e,n)=>{for(var r in n)wn(e,r,{get:n[r],enumerable:!0})},Ft=(e,n,r,o)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of Yt(n))!qt.call(e,t)&&t!==r&&wn(e,t,{get:()=>n[t],enumerable:!(o=Ht(n,t))||o.enumerable});return e};var Vt=e=>Ft(wn({},"__esModule",{value:!0}),e);var Da={};W(Da,{amplitude:()=>te,applyShadow:()=>Tr,bioGlow:()=>Be,bioluminescence:()=>oe,bob:()=>fr,calculateDirectionalIllumination:()=>Hr,calculateIllumination:()=>pe,clearShadow:()=>kr,createBioParticles:()=>Ue,createDeepParticles:()=>Je,createEye:()=>Tn,createEyes:()=>Vr,createMarineSnow:()=>Ne,createSeeker:()=>vr,createSeekerSwarm:()=>Mr,cssBioGlow:()=>Ye,cssBreathingGlow:()=>Lr,cssCreatureBody:()=>qe,cssDeepWater:()=>He,cssDistantCreature:()=>Ve,cssEyeGlow:()=>Gr,cssFishGlow:()=>Dr,cssGlow:()=>Or,cssHudGlow:()=>Ar,cssJellyfishBell:()=>Fe,cssJellyfishGlow:()=>Ir,cssTimings:()=>wr,darkness:()=>Ae,deepSea:()=>F,deepWaterBackground:()=>Ee,depthPresets:()=>$n,drawBarnacles:()=>tn,drawBioParticles:()=>Ze,drawBiolumGlow:()=>Pn,drawCaustics:()=>Fr,drawEye:()=>On,drawEyes:()=>_r,drawGrille:()=>fe,drawJellyfish:()=>en,drawLens:()=>De,drawLight:()=>Ge,drawLightCone:()=>xe,drawMarineSnow:()=>je,drawOffsetShadow:()=>$r,drawOrganicSurface:()=>rn,drawOrganicTexture:()=>qr,drawPanelLines:()=>Oe,drawPlayerLight:()=>Yr,drawROV:()=>Qe,drawScarring:()=>an,drawSeeker:()=>Rn,drawSeekerSwarm:()=>Cr,drawSpecimen:()=>nn,drawTentacle:()=>Wr,drawTether:()=>Ie,drawTrackingEye:()=>Xr,drawWithDepth:()=>Br,drift:()=>cr,eyeGlow:()=>We,getTheme:()=>Ur,getThemeNames:()=>Zr,hexToRgb:()=>jr,lightBeam:()=>Xe,material3D:()=>ke,materials:()=>Y,organicRadii:()=>zr,organicRadius:()=>Er,playerLight:()=>ze,pulse:()=>ce,radialGlow:()=>Pr,randomBioHue:()=>Le,registerTheme:()=>x,scenes:()=>Kr,staggerDelay:()=>Sr,surfacePalettes:()=>ee,themes:()=>Qr,timing:()=>Q,updateDeepParticles:()=>Ke,updateEye:()=>kn,updateEyes:()=>Nr,updateMarineSnow:()=>_e,updateSeeker:()=>Te,updateSeekerSwarm:()=>yr,updateSeekerWithDrift:()=>Sn,vignette:()=>Rr,waver:()=>pr});var Q={glacial:8e-4,verySlow:.001,slow:.002,medium:.003,fast:.005,rapid:.01},te={micro:.02,small:.03,medium:.1,large:.3};function cr(e,n=Q.verySlow,r=Q.slow){return{x:Math.sin(e*n)*te.micro+Math.sin(e*r)*te.micro*.5,y:Math.cos(e*n*1.1)*te.micro+Math.cos(e*r*.9)*te.micro*.3,rotation:Math.sin(e*Q.glacial)*te.small}}function fr(e,n=Q.slow,r=.02){return Math.sin(e*n)*r}function ce(e,n=Q.medium,r=.8,o=1.2){let t=(Math.sin(e*n)+1)/2;return r+t*(o-r)}function pr(e,n,r=Q.slow){return{x:Math.sin(e*r+n*.5)*.5,y:Math.cos(e*r+n*.3)*.5}}function vr(e,n){return{x:Math.random()*e,y:Math.random()*n,vx:0,vy:0,size:2+Math.random()*6,maxSpeed:1+Math.random()*3,awareness:150+Math.random()*250,timidity:.3+Math.random()*.7,glow:0,hue:180+Math.random()*40}}function Te(e,n,r,o,t,a){let s=n-e.x,i=r-e.y,l=Math.sqrt(s*s+i*i);l<e.awareness?o>15*e.timidity?(e.vx-=s/l*.5,e.vy-=i/l*.5,e.glow=Math.max(0,e.glow-.1)):l>40?(e.vx+=s/l*.08,e.vy+=i/l*.08,e.glow=Math.min(1,e.glow+.02)):(e.vx+=i/l*.1,e.vy-=s/l*.1,e.glow=1):(e.vx+=(Math.random()-.5)*.1,e.vy+=(Math.random()-.5)*.1,e.glow=Math.max(0,e.glow-.01));let u=Math.sqrt(e.vx*e.vx+e.vy*e.vy);u>e.maxSpeed&&(e.vx=e.vx/u*e.maxSpeed,e.vy=e.vy/u*e.maxSpeed),e.vx*=.98,e.vy*=.98,e.x+=e.vx,e.y+=e.vy,e.x<-50&&(e.x=t+50),e.x>t+50&&(e.x=-50),e.y<-50&&(e.y=a+50),e.y>a+50&&(e.y=-50)}function Mr(e,n,r,o={}){let{spawnBias:t="uniform",sizeRange:a=[2,8],speedRange:s=[1,4],hueRange:i=[180,220]}=o,l=[];for(let u=0;u<e;u++){let m,d;switch(t){case"center":{let b=Math.random()*Math.PI*2,h=Math.random()*Math.random()*Math.min(n,r)*.4;m=n/2+Math.cos(b)*h,d=r/2+Math.sin(b)*h;break}case"edges":{let b=Math.floor(Math.random()*4),h=Math.random();switch(b){case 0:m=h*n,d=Math.random()*50;break;case 1:m=n-Math.random()*50,d=h*r;break;case 2:m=h*n,d=r-Math.random()*50;break;default:m=Math.random()*50,d=h*r}break}default:m=Math.random()*n,d=Math.random()*r}l.push({x:m,y:d,vx:0,vy:0,size:a[0]+Math.random()*(a[1]-a[0]),maxSpeed:s[0]+Math.random()*(s[1]-s[0]),awareness:150+Math.random()*250,timidity:.3+Math.random()*.7,glow:0,hue:i[0]+Math.random()*(i[1]-i[0])})}return l}function Sn(e,n,r,o,t,a,s=0){if(Te(e,n,r,o,t,a),s>0){let i=n-e.x,l=r-e.y;if(Math.sqrt(i*i+l*l)>e.awareness){let m=t/2,d=a/2,b=m-e.x,h=d-e.y,c=Math.sqrt(b*b+h*h);c>0&&(e.vx+=b/c*s,e.vy+=h/c*s)}}}function yr(e,n,r,o,t,a,s=0){for(let i of e)s>0?Sn(i,n,r,o,t,a,s):Te(i,n,r,o,t,a)}function Pn(e,n,r,o,t,a,s){let i=s!==void 0?(Math.sin(s*.003)+1)/2:1,l=a*(.7+i*.3),u=o*(.9+i*.2),m=e.createRadialGradient(n,r,0,n,r,u*3);m.addColorStop(0,`hsla(${t}, 70%, 60%, ${l*.6})`),m.addColorStop(.5,`hsla(${t}, 60%, 40%, ${l*.2})`),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.arc(n,r,u*3,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${t}, 50%, 70%, ${l*.8})`,e.beginPath(),e.arc(n,r,u*.6,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${t}, 30%, 90%, ${l*.9})`,e.beginPath(),e.arc(n,r,u*.2,0,Math.PI*2),e.fill()}function Rn(e,n,r=150,o,t,a){let s=n.glow;if(o!==void 0&&t!==void 0){let i=Math.sqrt((n.x-o)**2+(n.y-t)**2);i<r&&(s=Math.max(s,(1-i/r)*.8))}s<.05||Pn(e,n.x,n.y,n.size,n.hue,s,a)}function Cr(e,n,r={}){let{lightX:o,lightY:t,lightRadius:a=150,time:s}=r,i=[...n].sort((l,u)=>{let m=l.glow,d=u.glow;if(o!==void 0&&t!==void 0){let b=Math.sqrt((l.x-o)**2+(l.y-t)**2),h=Math.sqrt((u.x-o)**2+(u.y-t)**2);b<a&&(m=Math.max(m,(1-b/a)*.8)),h<a&&(d=Math.max(d,(1-h/a)*.8))}return m-d});for(let l of i)Rn(e,l,a,o,t,s)}var wr={pulse:"4s",drift:"8s",creature:"12s",ambient:"20s",glacial:"30s"};function Sr(e,n=.3){return`${e*n}s`}function ke(e,n,r,o,t,a){let s=e.createLinearGradient(n,r,n,r+t);return s.addColorStop(0,a.highlight),s.addColorStop(.5,a.mid),s.addColorStop(1,a.shadow),s}function Pr(e,n,r,o,t,a){let s=e.createRadialGradient(n,r,o,n,r,t);return s.addColorStop(0,a.core),s.addColorStop(.4,a.mid),s.addColorStop(.7,a.outer),s.addColorStop(1,"transparent"),s}function Rr(e,n,r,o,t,a=.5){let s=e.createRadialGradient(n,r,o,n,r,t);return s.addColorStop(0,"transparent"),s.addColorStop(1,`rgba(0, 0, 0, ${a})`),s}function $r(e,n,r=4,o=4,t="rgba(0, 0, 0, 0.4)"){e.save(),e.translate(r,o),e.fillStyle=t,n(),e.restore()}function Tr(e,n,r,o=0,t=0){e.shadowColor=r,e.shadowBlur=n,e.shadowOffsetX=o,e.shadowOffsetY=t}function kr(e){e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}function Or(e,n="medium"){let r={subtle:[.3,.15],medium:[.6,.3],strong:[.9,.5]},[o,t]=r[n],a=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(!a)return"none";let[,s,i,l]=a;return`
    0 0 20px rgba(${s}, ${i}, ${l}, ${o}),
    0 0 40px rgba(${s}, ${i}, ${l}, ${t})
  `.trim()}function Ir(){return`
    0 0 20px rgba(150, 200, 255, 0.3),
    inset 0 -10px 20px rgba(100, 180, 255, 0.2)
  `.trim()}function Dr(){return`
    0 0 10px rgba(100, 200, 255, 0.5),
    0 0 20px rgba(80, 180, 255, 0.3)
  `.trim()}function Gr(){return`
    0 0 15px rgba(255, 100, 80, 0.6),
    0 0 30px rgba(255, 80, 60, 0.3)
  `.trim()}function Ar(){return"0 0 10px rgba(77, 208, 225, 0.3)"}function Lr(){return{dim:"0 0 10px rgba(77, 208, 225, 0.2)",bright:"0 0 25px rgba(77, 208, 225, 0.5)"}}var $n={equipment:{shadowOffset:{x:4,y:4},shadowColor:"rgba(0, 0, 0, 0.4)",outlineWidth:2,outlineColor:"#8a5a15"},light:{shadowOffset:{x:2,y:2},shadowColor:"rgba(0, 0, 0, 0.3)",outlineWidth:1,outlineColor:"#cc4420"},creature:{shadowOffset:{x:0,y:0},shadowColor:"transparent",outlineWidth:0,outlineColor:"transparent"}};function Br(e,n,r,o){let t=$n[n];(t.shadowOffset.x!==0||t.shadowOffset.y!==0)&&(e.save(),e.translate(t.shadowOffset.x,t.shadowOffset.y),e.fillStyle=t.shadowColor,r(),e.restore()),e.fillStyle=o,r(),t.outlineWidth>0&&(e.strokeStyle=t.outlineColor,e.lineWidth=t.outlineWidth,r(),e.stroke())}function Er(){let e=[40+Math.random()*30,40+Math.random()*30,40+Math.random()*30,40+Math.random()*30];return`${e[0]}% ${e[1]}% ${e[2]}% ${e[3]}%`}var zr={blob:"60% 50% 45% 55%",fish:"60% 40% 40% 60%",bell:"50% 50% 40% 40%",head:"55% 45% 50% 50%",tail:"30% 70% 60% 40%"};function Oe(e,n,r,o,t,a=[.25,.75],s="rgba(100, 60, 20, 0.5)"){e.strokeStyle=s,e.lineWidth=1;for(let i of a){let l=n+o*i;e.beginPath(),e.moveTo(l,r),e.lineTo(l,r+t),e.stroke()}}function fe(e,n,r,o,t,a=4,s="#555"){e.strokeStyle=s,e.lineWidth=2;let i=t/(a+1);for(let l=1;l<=a;l++){let u=r+i*l;e.beginPath(),e.moveTo(n,u),e.lineTo(n+o,u),e.stroke()}}function Ie(e,n,r,o,t,a,s=10,i="rgba(80, 80, 80, 0.6)"){e.strokeStyle=i,e.lineWidth=3,e.setLineDash([8,4]);let l=n+Math.sin(a*.002)*s;e.beginPath(),e.moveTo(n,r),e.lineTo(l,t),e.stroke(),e.setLineDash([])}function De(e,n,r,o,t,a="#222",s="#1a1a2e",i="rgba(100, 150, 200, 0.5)"){e.fillStyle=a,e.beginPath(),e.arc(n,r,o,0,Math.PI*2),e.fill(),e.fillStyle=s,e.beginPath(),e.arc(n,r,t,0,Math.PI*2),e.fill(),e.fillStyle=i,e.beginPath(),e.arc(n-2,r-2,t*.4,0,Math.PI*2),e.fill()}function Ge(e,n,r,o,t,a){if(e.fillStyle="#444",e.beginPath(),e.arc(n,r,o,0,Math.PI*2),e.fill(),t){let s=.8+Math.sin(a*.005)*.1,i=e.createRadialGradient(n,r,0,n,r,o*8);i.addColorStop(0,`rgba(255, 250, 230, ${s})`),i.addColorStop(.2,`rgba(255, 240, 200, ${s*.5})`),i.addColorStop(1,"rgba(255, 240, 200, 0)"),e.fillStyle=i,e.beginPath(),e.arc(n,r,o*8,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(255, 255, 240, ${s})`,e.beginPath(),e.arc(n,r,o*.6,0,Math.PI*2),e.fill()}}function Xr(e,n,r,o,t,a,s=0){let i=30+s*30,l=e.createRadialGradient(n,r,0,n,r,i);l.addColorStop(0,`rgba(${180+s*75}, ${60+s*40}, ${60+s*20}, 0.8)`),l.addColorStop(.5,`rgba(${120+s*60}, 40, 40, 0.3)`),l.addColorStop(1,"transparent"),e.fillStyle=l,e.beginPath(),e.arc(n,r,i,0,Math.PI*2),e.fill();let u=o*(1+s*.5);e.fillStyle=`rgba(${200+s*55}, ${80+s*80}, ${60+s*40}, 1)`,e.beginPath(),e.arc(n,r,u,0,Math.PI*2),e.fill();let m=t-n,d=a-r,b=Math.sqrt(m*m+d*d),h=b>0?m/b*3:0,c=b>0?d/b*3:0;e.fillStyle="rgba(10, 0, 0, 1)",e.beginPath(),s>.4?e.ellipse(n+h,r+c,2,u*.7,0,0,Math.PI*2):e.arc(n+h,r+c,4-s*2,0,Math.PI*2),e.fill()}function Wr(e,n,r,o="rgba(10, 10, 15, 0.9)"){if(!(n.length<2)){e.beginPath(),e.moveTo(n[0].x,n[0].y);for(let t=1;t<n.length;t++)e.lineTo(n[t].x,n[t].y);e.strokeStyle=o,e.lineWidth=r,e.lineCap="round",e.stroke()}}function pe(e,n,r,o,t=200){let a=e-r,s=n-o,i=Math.sqrt(a*a+s*s);if(i>=t)return 0;let l=1-i/t;return l*l}function Hr(e,n,r,o,t,a=200){let s=pe(e,n,r,o,a);if(s===0)return 0;let i=e-r,l=n-o,u=Math.atan2(l,i),m=Math.abs(u-t),b=1-Math.min(m,Math.PI*2-m)/Math.PI;return s*(.3+b*.7)}function Yr(e,n,r,o=120,t={}){let{intensity:a=1,pulseTime:s,coreColor:i={r:255,g:255,b:255},ambientColor:l={r:180,g:220,b:255}}=t,u=s!==void 0?Math.sin(s*.003)*20:0,m=o+u;for(let b=5;b>=1;b--){let h=m*(b/2),c=.15/b*a,g=e.createRadialGradient(n,r,0,n,r,h);g.addColorStop(0,`rgba(${l.r}, ${l.g}, ${l.b}, ${c})`),g.addColorStop(.5,`rgba(${Math.round(l.r*.55)}, ${l.g}, ${Math.round(l.b*.85)}, ${c*.5})`),g.addColorStop(1,"transparent"),e.fillStyle=g,e.beginPath(),e.arc(n,r,h,0,Math.PI*2),e.fill()}let d=e.createRadialGradient(n,r,0,n,r,15);d.addColorStop(0,`rgba(${i.r}, ${i.g}, ${i.b}, ${.9*a})`),d.addColorStop(.5,`rgba(${Math.round(i.r*.8)}, ${Math.round(i.g*.94)}, ${i.b}, ${.5*a})`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.beginPath(),e.arc(n,r,15,0,Math.PI*2),e.fill()}function qr(e,n,r,o={}){let{density:t=20,color:a={r:20,g:30,b:40},intensity:s=.15,time:i=0,seed:l=12345}=o,u=m=>{let d=Math.sin(l+m*127.1)*43758.5453;return d-Math.floor(d)};for(let m=0;m<t;m++){let d=u(m)*n,b=u(m+1e3)*r,h=i>0?Math.sin(i*8e-4+m*.5)*3:0,c=i>0?Math.cos(i*6e-4+m*.3)*2:0,g=d+h,v=b+c,p=30+u(m+2e3)*80,f=s*(.5+u(m+3e3)*.5),R=e.createRadialGradient(g,v,0,g,v,p);R.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, ${f})`),R.addColorStop(.6,`rgba(${a.r}, ${a.g}, ${a.b}, ${f*.3})`),R.addColorStop(1,"transparent"),e.fillStyle=R,e.beginPath(),e.arc(g,v,p,0,Math.PI*2),e.fill()}}function Fr(e,n,r,o,t={}){let{count:a=5,heightRatio:s=.4,intensity:i=.03}=t;for(let l=0;l<a;l++){let u=(Math.sin(o*.001+l)*.3+.5)*n,m=r*.1,d=e.createRadialGradient(u,m,0,u,m,150);d.addColorStop(0,`rgba(100, 150, 200, ${i})`),d.addColorStop(1,"rgba(100, 150, 200, 0)"),e.fillStyle=d,e.fillRect(0,0,n,r*s)}}function Tn(e){return{x:e.x,y:e.y,size:e.size??8,openness:1,awarenessRadius:e.awarenessRadius??200,blinkTimer:2e3+Math.random()*3e3,isBlinking:!1,blinkProgress:0,dilation:.5,hue:e.hue??0,illumination:0,pupilOffset:{x:0,y:0}}}function kn(e,n,r,o=16){e.illumination=pe(n,r,e.x,e.y,e.awarenessRadius);let t=n-e.x,a=r-e.y,s=Math.sqrt(t*t+a*a);if(s>0){let l=e.size*.3,u=t/s*l,m=a/s*l;e.pupilOffset.x+=(u-e.pupilOffset.x)*.1,e.pupilOffset.y+=(m-e.pupilOffset.y)*.1}let i=1-e.illumination*.8;e.dilation+=(i-e.dilation)*.05,e.isBlinking?(e.blinkProgress+=o/150,e.blinkProgress<.5?e.openness=1-e.blinkProgress*2:e.openness=(e.blinkProgress-.5)*2,e.blinkProgress>=1&&(e.isBlinking=!1,e.blinkProgress=0,e.openness=1,e.blinkTimer=2e3+Math.random()*4e3)):(e.blinkTimer-=o,e.blinkTimer<=0&&(e.isBlinking=!0,e.blinkProgress=0))}function On(e,n,r={}){let{showGlow:o=!0,glowSize:t=2.5}=r,a=n.size*n.openness;if(a<.5)return;let s=n.hue===0||n.hue<60?200:100,i=n.hue>30&&n.hue<90?150:50,l=n.hue>150?200:50,u=n.illumination*55,m=Math.min(255,s+u),d=Math.min(255,i+n.illumination*40),b=Math.min(255,l+n.illumination*20);if(o){let g=a*t+n.illumination*a,v=e.createRadialGradient(n.x,n.y,0,n.x,n.y,g);v.addColorStop(0,`rgba(${m}, ${d}, ${b}, ${.6+n.illumination*.2})`),v.addColorStop(.5,`rgba(${m*.6}, ${d*.6}, ${b*.6}, ${.2+n.illumination*.2})`),v.addColorStop(1,"transparent"),e.fillStyle=v,e.beginPath(),e.arc(n.x,n.y,g,0,Math.PI*2),e.fill()}e.fillStyle=`rgba(${m}, ${d}, ${b}, ${.8+n.illumination*.2})`,e.beginPath(),e.arc(n.x,n.y,a,0,Math.PI*2),e.fill();let h=n.x+n.pupilOffset.x,c=n.y+n.pupilOffset.y;if(e.fillStyle="rgba(10, 0, 0, 0.9)",e.beginPath(),n.illumination>.4){let g=2*n.dilation,v=a*.7;e.ellipse(h,c,g,v,0,0,Math.PI*2)}else{let g=2+n.dilation*2;e.arc(h,c,g,0,Math.PI*2)}e.fill(),n.openness>.5&&(e.fillStyle=`rgba(255, 255, 255, ${.3*n.openness})`,e.beginPath(),e.arc(n.x-a*.3,n.y-a*.3,a*.2,0,Math.PI*2),e.fill())}function Vr(e){return e.map(Tn)}function Nr(e,n,r,o=16){for(let t of e)kn(t,n,r,o)}function _r(e,n,r){for(let o of n)On(e,o,r)}function jr(e){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:0,g:0,b:0}}var ve=class{constructor(n){this.onFrame=n;this.animationId=null;this.frameCount=0;this.lastFrameTime=0;this.isRunning=!1;this.render=()=>{if(!this.isRunning)return;let n=performance.now(),r=n-this.lastFrameTime;this.lastFrameTime=n,this.onFrame(this.frameCount,r),this.frameCount++,this.animationId=requestAnimationFrame(this.render)}}start(){this.isRunning||(this.isRunning=!0,this.lastFrameTime=performance.now(),this.frameCount=0,this.render())}stop(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.isRunning=!1}reset(){this.frameCount=0,this.lastFrameTime=performance.now()}getFrameNum(){return this.frameCount}isRunning_(){return this.isRunning}};var Me=class{constructor(n){this.resizeObserver=null;this.canvas=n}startResizing(){if(this.resizeObserver)return;let n=this.handleResize.bind(this);this.resizeObserver=new ResizeObserver(n),this.handleResize(),this.resizeObserver.observe(this.canvas.parentElement)}stopResizing(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}registerResizeCallback(n){this.resizeCallback=n}getSize(){return{width:this.canvas.width,height:this.canvas.height}}getCenter(){return{x:this.canvas.width/2,y:this.canvas.height/2}}getBounds(){return this.canvas.getBoundingClientRect()}handleResize(){let n=this.canvas.getBoundingClientRect(),r=window.devicePixelRatio||1;this.canvas.width=n.width*r,this.canvas.height=n.height*r;let o=this.canvas.getContext("2d");o&&o.scale(r,r),this.resizeCallback&&this.resizeCallback()}};var ye=class{constructor(n){this.pos={x:-1e3,y:-1e3,angle:0,distance:0,isOver:!1};this.centerX=0;this.centerY=0;this.onMouseMove=this.handleMouseMove.bind(this);this.onMouseLeave=this.handleMouseLeave.bind(this);this.onMouseEnter=this.handleMouseEnter.bind(this);this.canvas=n,this.updateCenter()}startTracking(){this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseleave",this.onMouseLeave),this.canvas.addEventListener("mouseenter",this.onMouseEnter)}stopTracking(){this.canvas.removeEventListener("mousemove",this.onMouseMove),this.canvas.removeEventListener("mouseleave",this.onMouseLeave),this.canvas.removeEventListener("mouseenter",this.onMouseEnter)}getPosition(){return{...this.pos}}isOver(){return this.pos.isOver}updateCenter(){this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2}handleMouseMove(n){let r=this.canvas.getBoundingClientRect(),o=(n.clientX-r.left)*(this.canvas.width/r.width),t=(n.clientY-r.top)*(this.canvas.height/r.height);this.pos.x=o,this.pos.y=t;let a=o-this.centerX,s=t-this.centerY;this.pos.distance=Math.sqrt(a*a+s*s),this.pos.angle=Math.atan2(s,a)*(180/Math.PI),this.pos.angle<0&&(this.pos.angle+=360),this.pos.isOver=!0}handleMouseLeave(){this.pos.x=-1e3,this.pos.y=-1e3,this.pos.isOver=!1}handleMouseEnter(){this.pos.isOver=!0}};var ue=class{constructor(){this.frameNum=0;this.deltaTime=0}async init(n,r){this.canvas=n,this.ctx=n.getContext("2d"),this.config={...this.defaultConfig,...r},this.responsiveCanvas=new Me(n),this.responsiveCanvas.registerResizeCallback(()=>this.onCanvasResize()),this.responsiveCanvas.startResizing(),this.animationLoop=new ve((o,t)=>{this.frameNum=o,this.deltaTime=t,this.render(this.ctx,t),this.config.onFrame&&this.config.onFrame(o,t)}),await this.onInit(),this.animationLoop.start()}cleanup(){this.animationLoop?.stop(),this.responsiveCanvas?.stopResizing(),this.cursorManager?.stopTracking(),this.onCleanup()}async onInit(){}onCanvasResize(){}onCleanup(){}startCursorTracking(){if(this.cursorManager||(this.cursorManager=new ye(this.canvas)),this.cursorManager.startTracking(),this.responsiveCanvas){let n=this.onCanvasResize.bind(this),r=()=>{this.cursorManager?.updateCenter(),n()};this.onCanvasResize=r}}getCursorPos(){return this.cursorManager?.getPosition()??{x:-1e3,y:-1e3,angle:0,distance:0,isOver:!1}}getCanvasSize(){return this.responsiveCanvas?.getSize()??{width:this.canvas.width,height:this.canvas.height}}getCanvasCenter(){return this.responsiveCanvas?.getCenter()??{x:this.canvas.width/2,y:this.canvas.height/2}}};var Ce=class extends ue{constructor(){super(...arguments);this.name="Shadows";this.description="Jellyfish-like creatures drifting in the deep";this.defaultConfig={intensity:.5,scale:1,duration:1/0};this.shadows=[];this.particles=[];this.time=0;this.lastW=0;this.lastH=0}async onInit(){this.startCursorTracking(),this.initializeParticles(),this.resizeShadows()}onCanvasResize(){let{width:r,height:o}=this.getCanvasSize();(this.shadows.length===0||Math.abs(r-this.lastW)>20||Math.abs(o-this.lastH)>20)&&this.resizeShadows()}onCleanup(){this.shadows=[],this.particles=[]}render(r,o){let{width:t,height:a}=this.getCanvasSize(),s=r.createLinearGradient(0,0,0,a);s.addColorStop(0,"#020911"),s.addColorStop(.5,"#010508"),s.addColorStop(1,"#000305"),r.fillStyle=s,r.fillRect(0,0,t,a),this.updateAndDrawShadows(r,t,a),this.drawLightSource(r,t,a),this.drawMarineSnow(r,t,a),this.drawVignette(r,t,a),this.time+=16}initializeParticles(){this.particles=[];for(let r=0;r<10;r++)this.particles.push({x:Math.random(),y:Math.random(),size:.5+Math.random()*1.5,speed:5e-4+Math.random()*.001,alpha:.1+Math.random()*.2})}resizeShadows(){let{width:r,height:o}=this.getCanvasSize();this.shadows=[];let t=4+Math.floor(Math.random()*4);for(let a=0;a<t;a++)this.shadows.push({x:Math.random()*r,y:Math.random()*o,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*1.5-.5,size:60+Math.random()*80,bellSize:40+Math.random()*50,tentacleCount:5+Math.floor(Math.random()*4),angle:Math.random()*Math.PI*2,angleSpeed:(Math.random()-.5)*.03,pulsePhase:Math.random()*Math.PI*2,pulseSpeed:.5+Math.random()*.5,timeOffset:Math.random()*1e3});this.lastW=r,this.lastH=o}updateAndDrawShadows(r,o,t){let a=this.getCursorPos();for(let s of this.shadows){s.x+=s.vx,s.y+=s.vy,s.angle+=s.angleSpeed,s.pulsePhase+=s.pulseSpeed*.01,Math.random()<.01&&(s.vx+=(Math.random()-.5)*.5,s.vy+=(Math.random()-.5)*.3),s.x<-s.size*2&&(s.x=o+s.size),s.x>o+s.size*2&&(s.x=-s.size),s.y<-s.size*2&&(s.y=t+s.size),s.y>t+s.size*2&&(s.y=-s.size);let i=Math.sqrt(s.vx**2+s.vy**2);i>3&&(s.vx=s.vx/i*3,s.vy=s.vy/i*3),s.vx*=.995,s.vy*=.995}for(let s of this.shadows){r.save();let i=this.time*.001+s.timeOffset,l=Math.sin(s.pulsePhase)*.15+1,u=s.bellSize*l;r.translate(s.x,s.y),r.rotate(s.angle),r.beginPath();let m=12;for(let g=0;g<=m;g++){let v=g/m*Math.PI*2,p=u*(.7+Math.sin(v*3+i)*.1),f=Math.cos(v)*p,R=Math.sin(v)*p-u*.3;g===0?r.moveTo(f,R):r.lineTo(f,R)}r.closePath();let d=this.calculateIllumination(s.x,s.y,a),h=.8+d*.08;r.fillStyle=`rgba(5, 3, 8, ${h})`,r.shadowBlur=12,r.shadowColor="rgba(0, 0, 0, 0.4)",r.fill();let c=s.size*1.5;for(let g=0;g<s.tentacleCount;g++){let v=g/s.tentacleCount*Math.PI*2,p=Math.cos(v)*u*.6,f=Math.sin(v)*u*.3,R=8;r.beginPath(),r.moveTo(p,f);for(let $=1;$<=R;$++){let P=$/R,D=p+Math.sin(i*1.5+g+P*2)*u*.15,w=f+P*c+Math.sin(i*2+g*2+P*3)*u*.1;r.lineTo(D,w)}let M=.8+d*.08;r.strokeStyle=`rgba(5, 3, 8, ${M})`,r.lineWidth=u*.1,r.lineCap="round",r.lineJoin="round",r.shadowBlur=6,r.shadowColor="rgba(0, 0, 0, 0.3)",r.stroke()}r.restore()}}calculateIllumination(r,o,t){if(!t.isOver)return 0;let a=r-t.x,s=o-t.y,i=a*a+s*s,l=200,u=l*l;return i<u?Math.pow(1-Math.sqrt(i)/l,2.5):0}drawLightSource(r,o,t){let a=this.getCursorPos();if(!a.isOver)return;let s=r.createRadialGradient(a.x,a.y,0,a.x,a.y,200);s.addColorStop(0,"rgba(200, 240, 255, 0.15)"),s.addColorStop(.5,"rgba(150, 200, 255, 0.08)"),s.addColorStop(1,"transparent"),r.fillStyle=s,r.beginPath(),r.arc(a.x,a.y,200,0,Math.PI*2),r.fill();let i=r.createRadialGradient(a.x,a.y,0,a.x,a.y,16);i.addColorStop(0,"rgba(255, 255, 255, 0.9)"),i.addColorStop(.6,"rgba(220, 240, 255, 0.5)"),i.addColorStop(1,"transparent"),r.fillStyle=i,r.beginPath(),r.arc(a.x,a.y,16,0,Math.PI*2),r.fill()}drawMarineSnow(r,o,t){for(let a of this.particles)a.y+=a.speed,a.x+=Math.sin(this.time*.001+a.y*5)*3e-4,a.y>1.05&&(a.y=-.05,a.x=Math.random()),r.fillStyle=`rgba(150, 180, 200, ${a.alpha})`,r.beginPath(),r.arc(a.x*o,a.y*t,a.size,0,Math.PI*2),r.fill()}drawVignette(r,o,t){let a=r.createRadialGradient(o/2,t/2,t*.25,o/2,t/2,t*.85);a.addColorStop(0,"transparent"),a.addColorStop(1,"rgba(0, 0, 0, 0.4)"),r.fillStyle=a,r.fillRect(0,0,o,t)}},xa=new Ce;var we=class extends ue{constructor(){super(...arguments);this.name="Seekers";this.description="Bioluminescent swarm responding to light";this.defaultConfig={intensity:.7,scale:1,duration:1/0};this.seekers=[];this.particles=[];this.time=0}async onInit(){this.startCursorTracking(),this.initializeParticles(),this.resizeSeekersSwarm()}onCanvasResize(){let{width:r,height:o}=this.getCanvasSize();this.seekers.length===0&&this.resizeSeekersSwarm()}onCleanup(){this.seekers=[],this.particles=[]}initializeParticles(){this.particles=[];for(let r=0;r<30;r++)this.particles.push({x:Math.random(),y:Math.random(),size:.5+Math.random()*1.5,speed:5e-4+Math.random()*.001,alpha:.1+Math.random()*.2})}resizeSeekersSwarm(){let{width:r,height:o}=this.getCanvasSize();this.seekers=[];for(let t=0;t<50;t++){let a=Math.random()*Math.PI*2,s=Math.random()*Math.random()*100,i=r/2+Math.cos(a)*s,l=o/2+Math.sin(a)*s;i=Math.max(0,Math.min(r,i)),l=Math.max(0,Math.min(o,l)),this.seekers.push({x:i,y:l,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*2,size:3+Math.random()*5,brightness:.4+Math.random()*.4,bodyHue:190+Math.random()*20})}}render(r,o){let{width:t,height:a}=this.getCanvasSize(),s=this.getCursorPos(),i=r.createLinearGradient(0,0,0,a);i.addColorStop(0,"#020810"),i.addColorStop(.5,"#010508"),i.addColorStop(1,"#000305"),r.fillStyle=i,r.fillRect(0,0,t,a);let l=Math.sqrt((s.x-(s.x-o*.1))**2+(s.y-(s.y-o*.1))**2);for(let d of this.seekers){let b=s.x-d.x,h=s.y-d.y,c=Math.sqrt(b*b+h*h);if(s.isOver&&c<300){let f=Math.atan2(h,b),R=Math.max(0,1-c/300)*.15;d.vx+=Math.cos(f)*R,d.vy+=Math.sin(f)*R}else d.vx+=(Math.random()-.5)*.05,d.vy+=(Math.random()-.5)*.05;let g=t/2-d.x,v=a/2-d.y,p=Math.sqrt(g*g+v*v);if(p>200){let f=Math.atan2(v,g),R=Math.max(0,(p-200)/200)*.02;d.vx+=Math.cos(f)*R,d.vy+=Math.sin(f)*R}d.x+=d.vx,d.y+=d.vy,d.vx*=.98,d.vy*=.98,d.x<-10&&(d.x=t+10),d.x>t+10&&(d.x=-10),d.y<-10&&(d.y=a+10),d.y>a+10&&(d.y=-10)}let u=[...this.seekers].sort((d,b)=>d.y-b.y);for(let d of u){let b=s.x-d.x,h=s.y-d.y,c=Math.sqrt(b*b+h*h),g=d.brightness;s.isOver&&c<300&&(g=.6+Math.max(0,1-c/300)*.4);let v=d.size*3,p=r.createRadialGradient(d.x,d.y,0,d.x,d.y,v);p.addColorStop(0,`hsla(${d.bodyHue}, 100%, 60%, ${g*.6})`),p.addColorStop(.5,`hsla(${d.bodyHue}, 100%, 50%, ${g*.2})`),p.addColorStop(1,"transparent"),r.fillStyle=p,r.beginPath(),r.arc(d.x,d.y,v,0,Math.PI*2),r.fill(),r.fillStyle=`hsla(${d.bodyHue}, 100%, 50%, ${g})`,r.beginPath(),r.arc(d.x,d.y,d.size,0,Math.PI*2),r.fill(),r.fillStyle=`hsla(${d.bodyHue}, 100%, 70%, ${g*.8})`,r.beginPath(),r.arc(d.x,d.y,d.size*.5,0,Math.PI*2),r.fill()}for(let d of this.particles)d.y+=d.speed,d.x+=Math.sin(this.time*.001+d.y*5)*3e-4,d.y>1.05&&(d.y=-.05,d.x=Math.random()),r.fillStyle=`rgba(150, 180, 200, ${d.alpha})`,r.beginPath(),r.arc(d.x*t,d.y*a,d.size,0,Math.PI*2),r.fill();if(s.isOver&&s.x>0&&s.x<t){for(let b=3;b>=1;b--){let h=100*(b/2),c=.08/b,g=r.createRadialGradient(s.x,s.y,0,s.x,s.y,h);g.addColorStop(0,`rgba(180, 220, 255, ${c})`),g.addColorStop(.5,`rgba(100, 180, 220, ${c*.5})`),g.addColorStop(1,"transparent"),r.fillStyle=g,r.beginPath(),r.arc(s.x,s.y,h,0,Math.PI*2),r.fill()}let d=r.createRadialGradient(s.x,s.y,0,s.x,s.y,10);d.addColorStop(0,"rgba(255, 255, 255, 0.7)"),d.addColorStop(.5,"rgba(200, 240, 255, 0.3)"),d.addColorStop(1,"transparent"),r.fillStyle=d,r.beginPath(),r.arc(s.x,s.y,10,0,Math.PI*2),r.fill()}let m=r.createRadialGradient(t/2,a/2,a*.3,t/2,a/2,a*.85);m.addColorStop(0,"transparent"),m.addColorStop(1,"rgba(0, 0, 0, 0.5)"),r.fillStyle=m,r.fillRect(0,0,t,a),this.time+=16}},ro=new we;var Nt=new Ce,_t=new we,Jr={shadows:Nt,seekers:_t};var Kr={deepSea:Jr};var ae={};function x(e,n){ae[e]&&console.warn(`Theme "${e}" is already registered. Overwriting.`),ae[e]=n}function Ur(e){return ae[e]}function Zr(){return Object.keys(ae)}var Qr=new Proxy({},{get(e,n){if(typeof n=="string")return ae[n]},ownKeys(){return Object.keys(ae)},has(e,n){return n in ae}});var In={};W(In,{bioGlow:()=>Be,bioluminescence:()=>oe,darkness:()=>Ae,deepSea:()=>F,materials:()=>Y,randomBioHue:()=>Le});var F={background:{surface:"#020810",mid:"#051018",deep:"#020a12",abyss:"#010508",void:"#000000"},water:{ambient:"rgba(100, 150, 200, 0.03)",light:"rgba(180, 200, 220, 0.4)",particleDim:"rgba(180, 200, 230, 0.3)"},hud:{text:"rgba(77, 208, 225, 0.5)",recording:"rgba(255, 150, 100, 0.7)"}},oe={cyan:{core:"rgba(100, 200, 255, 0.9)",mid:"rgba(80, 180, 255, 0.5)",outer:"rgba(60, 150, 255, 0.2)",halo:"rgba(77, 208, 225, 0.5)"},warm:{core:"rgba(255, 100, 80, 0.8)",mid:"rgba(255, 80, 60, 0.4)",outer:"rgba(200, 50, 50, 0.3)"},playerLight:{core:"rgba(255, 255, 255, 0.9)",inner:"rgba(200, 240, 255, 0.5)",mid:"rgba(180, 220, 255, 0.15)",ambient:"rgba(100, 180, 220, 0.1)"},hueRange:{min:180,max:220}},Y={rovYellow:{highlight:"#e8a832",mid:"#d4942a",shadow:"#b87820",outline:"#8a5a15"},flotation:{fill:"#ff6b35",outline:"#cc4420"},metal:{light:"#666666",mid:"#444444",dark:"#333333",darkest:"#222222"},lens:{body:"#1a1a2e",glint:"rgba(100, 150, 200, 0.5)"},panel:{line:"rgba(100, 60, 20, 0.5)",shadow:"rgba(0, 0, 0, 0.4)"},creatureFlesh:e=>({r:15+e*25,g:12+e*18,b:20+e*25})},Ae={true:"#000000",soft:"#010508",tendril:"rgba(10, 10, 15, 0.9)",vignette:"rgba(0, 0, 0, 0.4)",shadow:"rgba(0, 0, 0, 0.4)"};function Le(){let{min:e,max:n}=oe.hueRange;return e+Math.random()*(n-e)}function Be(e,n=70,r=60,o=.6){return`hsla(${e}, ${n}%, ${r}%, ${o})`}var Dn={};W(Dn,{cssBioGlow:()=>Ye,cssCreatureBody:()=>qe,cssDeepWater:()=>He,cssDistantCreature:()=>Ve,cssJellyfishBell:()=>Fe,deepWaterBackground:()=>Ee,eyeGlow:()=>We,lightBeam:()=>Xe,playerLight:()=>ze});function Ee(e,n){let r=e.createLinearGradient(0,0,0,n);return r.addColorStop(0,F.background.surface),r.addColorStop(.3,F.background.mid),r.addColorStop(.6,F.background.deep),r.addColorStop(1,F.background.abyss),r}function ze(e,n,r,o,t=1){let a=[];for(let i=5;i>=1;i--){let l=o*(i/2),u=.15/i*t,m=e.createRadialGradient(n,r,0,n,r,l);m.addColorStop(0,`rgba(180, 220, 255, ${u})`),m.addColorStop(.5,`rgba(100, 180, 220, ${u*.5})`),m.addColorStop(1,"transparent"),a.push(m)}let s=e.createRadialGradient(n,r,0,n,r,15);return s.addColorStop(0,`rgba(255, 255, 255, ${.9*t})`),s.addColorStop(.5,`rgba(200, 240, 255, ${.5*t})`),s.addColorStop(1,"transparent"),a.push(s),a}function Xe(e,n,r){let o=e.createLinearGradient(0,n,0,r);return o.addColorStop(0,"rgba(255, 250, 230, 0.15)"),o.addColorStop(.5,"rgba(200, 220, 255, 0.05)"),o.addColorStop(1,"rgba(200, 220, 255, 0)"),o}function We(e,n,r,o,t=0){let a=e.createRadialGradient(n,r,0,n,r,o),s=180+t*75,i=60+t*40,l=60+t*20;return a.addColorStop(0,`rgba(${s}, ${i}, ${l}, 0.8)`),a.addColorStop(.5,`rgba(${120+t*60}, 40, 40, 0.3)`),a.addColorStop(1,"transparent"),a}function He(){return`linear-gradient(
    180deg,
    ${F.background.surface} 0%,
    ${F.background.mid} 30%,
    ${F.background.deep} 60%,
    ${F.background.abyss} 100%
  )`}function Ye(e="cyan"){let n=oe[e];return`radial-gradient(
    circle,
    ${n.core} 0%,
    ${n.mid} 30%,
    ${n.outer} 60%,
    transparent 70%
  )`}function qe(e=.8){return`radial-gradient(
    ellipse at 40% 40%,
    rgba(20, 30, 40, ${e}) 0%,
    rgba(15, 25, 35, ${e*.8}) 50%,
    rgba(10, 20, 30, ${e*.5}) 80%,
    transparent 100%
  )`}function Fe(){return`radial-gradient(
    ellipse at 50% 30%,
    rgba(180, 220, 255, 0.4) 0%,
    rgba(150, 200, 255, 0.2) 40%,
    rgba(120, 180, 255, 0.1) 70%,
    transparent 100%
  )`}function Ve(){return`radial-gradient(
    ellipse at center,
    rgba(10, 20, 35, 0.8) 0%,
    transparent 70%
  )`}var Gn={};W(Gn,{createBioParticles:()=>Ue,createDeepParticles:()=>Je,createMarineSnow:()=>Ne,cssMarineSnowParticle:()=>jt,cssMarineSnowStyles:()=>Kt,drawBioParticles:()=>Ze,drawMarineSnow:()=>je,htmlMarineSnow:()=>Jt,updateDeepParticles:()=>Ke,updateMarineSnow:()=>_e});function Ne(e=80){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*2+.5,speed:Math.random()*.008+.003,alpha:Math.random()*.5+.2}))}function _e(e,n="down"){let r=n==="up"?-1:1;for(let o of e)o.y+=o.speed*r,n==="up"&&o.y<-.05?(o.y=1.05,o.x=Math.random()):n==="down"&&o.y>1.05&&(o.y=-.05,o.x=Math.random())}function je(e,n,r,o){for(let t of n)e.beginPath(),e.arc(t.x*r,t.y*o,t.size,0,Math.PI*2),e.fillStyle=`rgba(180, 200, 220, ${t.alpha})`,e.fill()}function Je(e=12){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*1.5+.5,speed:Math.random()*.002+.001,alpha:Math.random()*.3+.1,phase:Math.random()*Math.PI*2}))}function Ke(e,n){for(let r of e)r.y+=r.speed,r.x+=Math.sin(n*.001+(r.phase??0))*5e-4,r.y>1.05&&(r.y=-.05,r.x=Math.random())}function jt(e){let n=Math.random()*100,r=Math.random()*100,o=Math.random()*5,t=Math.random()>.5?3:2,a=Math.random()>.5?.3:.4;return{style:`
      position: absolute;
      left: ${n}%;
      top: ${r}%;
      width: ${t}px;
      height: ${t}px;
      background: rgba(200, 220, 255, ${a});
      border-radius: 50%;
      animation: snow-drift 8s linear infinite;
      animation-delay: ${o}s;
    `.trim(),animation:`
      @keyframes snow-drift {
        0% { transform: translateY(-20px) translateX(0); opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { transform: translateY(300px) translateX(20px); opacity: 0; }
      }
    `.trim()}}function Jt(e=20){return`<div class="marine-snow">${Array.from({length:e},(r,o)=>{let t=Math.random()*100,a=Math.random()*100,s=Math.random()*5;return`<div class="snow-particle" style="left: ${t}%; top: ${a}%; animation-delay: ${s}s;"></div>`}).join(`
`)}</div>`}var Kt=`
  .marine-snow {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }
  
  .snow-particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: rgba(200, 220, 255, 0.4);
    border-radius: 50%;
    animation: snow-drift 8s linear infinite;
  }
  
  .snow-particle:nth-child(odd) {
    width: 3px;
    height: 3px;
    background: rgba(180, 200, 230, 0.3);
  }
  
  @keyframes snow-drift {
    0% { transform: translateY(-20px) translateX(0); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(300px) translateX(20px); opacity: 0; }
  }
`;function Ue(e=15){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*4+2,speed:Math.random()*.002+.001,alpha:Math.random()*.6+.3,hue:180+Math.random()*40,pulseSpeed:Math.random()*.003+.002,phase:Math.random()*Math.PI*2}))}function Ze(e,n,r,o,t){for(let a of n){let s=(Math.sin(t*a.pulseSpeed+(a.phase??0))+1)/2,i=a.alpha*(.5+s*.5),l=a.size*(.8+s*.4),u=a.x*r,m=a.y*o,d=e.createRadialGradient(u,m,0,u,m,l*3);d.addColorStop(0,`hsla(${a.hue}, 70%, 60%, ${i})`),d.addColorStop(.5,`hsla(${a.hue}, 60%, 40%, ${i*.3})`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.beginPath(),e.arc(u,m,l*3,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${a.hue}, 50%, 80%, ${i})`,e.beginPath(),e.arc(u,m,l*.5,0,Math.PI*2),e.fill()}}var An={};W(An,{drawJellyfish:()=>en,drawLightCone:()=>xe,drawROV:()=>Qe,drawSpecimen:()=>nn});var Se={glacial:8e-4,verySlow:.001,slow:.002,medium:.003};function Qe(e,n,r,o=1,t={}){let{lightsOn:a=!0,showTether:s=!0,showArm:i=!0,time:l=0,rotation:u=0}=t;e.save(),e.translate(n,r),e.rotate(u),e.scale(o,o);let m=80,d=50;e.fillStyle="rgba(0, 0, 0, 0.4)",e.fillRect(-m/2+4,-d/2+4,m,d),e.fillStyle=ke(e,-m/2,-d/2,m,d,Y.rovYellow),e.fillRect(-m/2,-d/2,m,d),e.strokeStyle=Y.rovYellow.outline,e.lineWidth=2,e.strokeRect(-m/2,-d/2,m,d),Oe(e,-m/2,-d/2,m,d,[.25,.75]),e.fillStyle=Y.flotation.fill,e.fillRect(-m/2+5,-d/2-15,m-10,15),e.strokeStyle=Y.flotation.outline,e.lineWidth=1,e.strokeRect(-m/2+5,-d/2-15,m-10,15),e.fillStyle=Y.metal.dark,e.fillRect(-m/2-15,-10,15,20),e.fillRect(m/2,-10,15,20),fe(e,-m/2-15,-10,15,20,4,Y.metal.mid),fe(e,m/2,-10,15,20,4,Y.metal.mid),De(e,0,d/2+10,12,8),a?[-25,25].forEach(b=>{Ge(e,b,d/2+5,8,!0,l)}):[-25,25].forEach(b=>{e.fillStyle=Y.metal.mid,e.beginPath(),e.arc(b,d/2+5,8,0,Math.PI*2),e.fill()}),i&&(e.strokeStyle=Y.metal.mid,e.lineWidth=4,e.lineCap="round",e.beginPath(),e.moveTo(-m/2+10,d/2),e.lineTo(-m/2+5,d/2+20),e.lineTo(-m/2+15,d/2+25),e.stroke()),s&&Ie(e,0,-d/2-15,0,-d/2-100,l),e.restore()}function xe(e,n,r,o,t,a={}){let{spread:s=.5,startOpacity:i=.15,color:l={r:255,g:250,b:230}}=a;e.save(),e.translate(n,r),e.rotate(o-Math.PI/2);let u=s/2,m=Math.tan(u)*t,d=e.createLinearGradient(0,0,0,t);d.addColorStop(0,`rgba(${l.r}, ${l.g}, ${l.b}, ${i})`),d.addColorStop(.5,`rgba(${l.r}, ${l.g}, ${l.b}, ${i*.3})`),d.addColorStop(1,`rgba(${l.r}, ${l.g}, ${l.b}, 0)`),e.fillStyle=d,e.beginPath(),e.moveTo(-10,0),e.lineTo(-m,t),e.lineTo(m,t),e.lineTo(10,0),e.closePath(),e.fill(),e.restore()}function en(e,n,r,o={}){let{bellWidth:t=50,tentacleCount:a=4,time:s=0,glowIntensity:i=.4}=o,l=t*.7,u=ce(s,Se.slow,.95,1.05);e.save(),e.translate(n,r);let m=e.createRadialGradient(0,0,0,0,0,t*1.5);m.addColorStop(0,`rgba(150, 200, 255, ${i*.3})`),m.addColorStop(.5,`rgba(150, 200, 255, ${i*.1})`),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.arc(0,0,t*1.5,0,Math.PI*2),e.fill(),e.scale(u,1/u);let d=e.createRadialGradient(0,-l*.3,0,0,0,t);d.addColorStop(0,`rgba(180, 220, 255, ${i})`),d.addColorStop(.4,`rgba(150, 200, 255, ${i*.5})`),d.addColorStop(.7,`rgba(120, 180, 255, ${i*.25})`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.beginPath(),e.ellipse(0,0,t/2,l/2,0,0,Math.PI,!0),e.fill(),e.fillStyle=`rgba(200, 230, 255, ${i*.3})`,e.beginPath(),e.ellipse(0,-l*.15,t*.25,l*.2,0,0,Math.PI*2),e.fill();let b=t/(a+1),h=l*.3;for(let c=0;c<a;c++){let g=-t/2+b*(c+1),v=40+c%2*15,p=Math.sin(s*Se.slow+c*.8)*5,f=e.createLinearGradient(g,h,g+p,h+v);f.addColorStop(0,`rgba(150, 200, 255, ${i*.5})`),f.addColorStop(.5,`rgba(150, 200, 255, ${i*.2})`),f.addColorStop(1,"transparent"),e.strokeStyle=f,e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(g,h),e.quadraticCurveTo(g+p*.5,h+v*.5,g+p,h+v),e.stroke()}e.restore()}function nn(e,n,r,o={}){let{width:t=70,time:a=0,illumination:s=0,lookAt:i}=o,l=t*.65,u=Math.sin(a*Se.verySlow)*3,m=Math.sin(a*Se.glacial)*.02;e.save(),e.translate(n,r+u),e.rotate(m);let d=.6+s*.3,b=e.createRadialGradient(-t*.1,-l*.1,0,0,0,t*.7);b.addColorStop(0,`rgba(${20+s*15}, ${30+s*10}, ${40+s*10}, ${d})`),b.addColorStop(.5,`rgba(15, 25, 35, ${d*.8})`),b.addColorStop(.8,`rgba(10, 20, 30, ${d*.5})`),b.addColorStop(1,"transparent"),e.fillStyle=b,e.beginPath(),e.ellipse(0,0,t/2,l/2,0,0,Math.PI*2),e.fill();let h=ce(a,Se.medium,.6,1),c=-t*.1,g=-l*.05,v=8*h,p=e.createRadialGradient(c,g,0,c,g,v*2);p.addColorStop(0,`rgba(255, 100, 80, ${.8*h})`),p.addColorStop(.4,`rgba(255, 80, 60, ${.4*h})`),p.addColorStop(1,"transparent"),e.fillStyle=p,e.beginPath(),e.arc(c,g,v*2,0,Math.PI*2),e.fill();let f=t*.15,R=-l*.1,y=4+s*2,M=15+s*10,$=e.createRadialGradient(f,R,0,f,R,M);$.addColorStop(0,`rgba(200, 50, 50, ${.6+s*.3})`),$.addColorStop(.5,`rgba(150, 30, 30, ${.2+s*.2})`),$.addColorStop(1,"transparent"),e.fillStyle=$,e.beginPath(),e.arc(f,R,M,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(200, 50, 50, ${.8+s*.2})`,e.beginPath(),e.arc(f,R,y,0,Math.PI*2),e.fill();let P=0,D=0;if(i){let w=i.x-(n+f),S=i.y-(r+R),C=Math.sqrt(w*w+S*S);C>0&&(P=w/C*2,D=S/C*2)}if(e.fillStyle="rgba(10, 0, 0, 0.9)",e.beginPath(),s>.4?e.ellipse(f+P,R+D,1.5,y*.6,0,0,Math.PI*2):e.arc(f+P,R+D,2,0,Math.PI*2),e.fill(),s>.3){let w=(s-.3)*1.4,S=t*.05,C=l*.15;e.fillStyle=`rgba(180, 40, 40, ${w*.5})`,e.beginPath(),e.arc(S,C,3,0,Math.PI*2),e.fill()}e.restore()}var Bn={};W(Bn,{drawBarnacles:()=>tn,drawOrganicSurface:()=>rn,drawScarring:()=>an,surfacePalettes:()=>ee});var Ut=.5*(Math.sqrt(3)-1),Pe=(3-Math.sqrt(3))/6,me=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];function et(e){let n=Array.from({length:256},(o,t)=>t),r=e;for(let o=255;o>0;o--){r=r*1103515245+12345&2147483647;let t=r%(o+1);[n[o],n[t]]=[n[t],n[o]]}return[...n,...n]}function O(e,n,r){let o=(e+n)*Ut,t=Math.floor(e+o),a=Math.floor(n+o),s=(t+a)*Pe,i=t-s,l=a-s,u=e-i,m=n-l,d=u>m?1:0,b=u>m?0:1,h=u-d+Pe,c=m-b+Pe,g=u-1+2*Pe,v=m-1+2*Pe,p=t&255,f=a&255,R=r[p+r[f]]%8,y=r[p+d+r[f+b]]%8,M=r[p+1+r[f+1]]%8,$=0,P=0,D=0,w=.5-u*u-m*m;w>=0&&(w*=w,$=w*w*(me[R][0]*u+me[R][1]*m));let S=.5-h*h-c*c;S>=0&&(S*=S,P=S*S*(me[y][0]*h+me[y][1]*c));let C=.5-g*g-v*v;return C>=0&&(C*=C,D=C*C*(me[M][0]*g+me[M][1]*v)),70*($+P+D)}function xr(e,n,r,o=4){let t=0,a=.5,s=1,i=0;for(let l=0;l<o;l++)t+=a*O(e*s,n*s,r),i+=a,a*=.5,s*=2;return t/i}var ee={fleshy:{base:{r:28,g:22,b:26},mid:{r:38,g:30,b:35},highlight:{r:58,g:48,b:52},shadow:{r:18,g:14,b:18},vein:{r:50,g:28,b:35},veinHighlight:{r:85,g:50,b:55}},abyssal:{base:{r:20,g:25,b:32},mid:{r:30,g:38,b:48},highlight:{r:50,g:62,b:75},shadow:{r:12,g:15,b:22},vein:{r:35,g:45,b:60},veinHighlight:{r:60,g:80,b:100}},rocky:{base:{r:25,g:28,b:25},mid:{r:38,g:42,b:38},highlight:{r:55,g:62,b:55},shadow:{r:15,g:18,b:16},vein:{r:35,g:32,b:30},veinHighlight:{r:55,g:50,b:45}},membranous:{base:{r:25,g:20,b:30},mid:{r:38,g:30,b:45},highlight:{r:60,g:48,b:68},shadow:{r:15,g:12,b:20},vein:{r:70,g:40,b:55},veinHighlight:{r:100,g:60,b:75}}},Zt={visible:{noiseScale:.003,showVeins:!0,veinCount:6},subtle:{noiseScale:.005,showVeins:!0,veinCount:3},dramatic:{noiseScale:.002,showVeins:!0,veinCount:10}};function rn(e,n,r,o={}){let t=o.preset?Zt[o.preset]:{},{type:a="fleshy",noiseScale:s=t.noiseScale??.003,showVeins:i=t.showVeins??!0,veinCount:l=t.veinCount??6,seed:u=42,time:m=0,lightX:d,lightY:b,lightRadius:h=250}={...t,...o},c=ee[a]||ee.fleshy,g=et(u);Ln(e,n,r,c,g,s,m),Qt(e,n,r,c,g,s),i&&xt(e,n,r,c,g,l,m),ea(e,n,r,c,g,s*3),d!==void 0&&b!==void 0&&na(e,n,r,d,b,h,c,g)}function Ln(e,n,r,o,t,a,s){let m=Math.min(n,1920),d=Math.min(r,1080),b=m*d;if((n>1920||r>1080)&&console.warn(`drawOrganicSurface: Dimensions ${n}x${r} exceed safe limit (1920x1080). Using reduced size ${m}x${d} to prevent memory allocation failure.`),b>2073600){let v=Math.sqrt(2073600/b),p=Math.floor(m*v),f=Math.floor(d*v);return console.warn(`drawOrganicSurface: Pixel count ${b} exceeds limit 2073600. Scaling to ${p}x${f}.`),Ln(e,p,f,o,t,a,s)}let h;try{h=e.createImageData(m,d)}catch(v){if(v instanceof RangeError||v instanceof DOMException){let p=Math.floor(m*.5),f=Math.floor(d*.5);return console.error(`drawOrganicSurface: Failed to allocate ${m}x${d} buffer. Falling back to ${p}x${f}.`,v),Ln(e,p,f,o,t,a,s)}throw v}let c=h.data,g=s*5e-5;for(let v=0;v<d;v++)for(let p=0;p<m;p++){let f=xr(p*a+g,v*a,t,4),R=xr(p*a*2+100,v*a*2+100,t,3),y=(f+1)/2,M=(R+1)/2,$,P,D;if(y<.4){let S=y/.4;$=o.shadow.r+(o.base.r-o.shadow.r)*S,P=o.shadow.g+(o.base.g-o.shadow.g)*S,D=o.shadow.b+(o.base.b-o.shadow.b)*S}else if(y<.7){let S=(y-.4)/.3;$=o.base.r+(o.mid.r-o.base.r)*S,P=o.base.g+(o.mid.g-o.base.g)*S,D=o.base.b+(o.mid.b-o.base.b)*S}else{let S=(y-.7)/.3;$=o.mid.r+(o.highlight.r-o.mid.r)*S*.3,P=o.mid.g+(o.highlight.g-o.mid.g)*S*.3,D=o.mid.b+(o.highlight.b-o.mid.b)*S*.3}$+=(M-.5)*8,P+=(M-.5)*6,D+=(M-.5)*8;let w=(v*n+p)*4;c[w]=Math.max(0,Math.min(255,$)),c[w+1]=Math.max(0,Math.min(255,P)),c[w+2]=Math.max(0,Math.min(255,D)),c[w+3]=255}if(m===n&&d===r)e.putImageData(h,0,0);else{let v=document.createElement("canvas");v.width=m,v.height=d,v.getContext("2d").putImageData(h,0,0),e.drawImage(v,0,0,n,r)}}function Qt(e,n,r,o,t,a){let s=a*.5;e.globalCompositeOperation="overlay";for(let i=0;i<8;i++){let l=O(i*50,0,t)*.5+.5,u=O(0,i*50,t)*.5+.5,m=l*n,d=u*r,b=100+Math.abs(O(i*30,i*30,t))*200;if(O(i*20,i*20+500,t)>0){let c=O(i*10,0,t)*Math.PI;e.save(),e.translate(m,d),e.rotate(c);let g=e.createLinearGradient(0,-b*.3,0,b*.3);g.addColorStop(0,`rgba(${o.highlight.r}, ${o.highlight.g}, ${o.highlight.b}, 0.15)`),g.addColorStop(.5,"rgba(128, 128, 128, 0)"),g.addColorStop(1,`rgba(${o.shadow.r}, ${o.shadow.g}, ${o.shadow.b}, 0.1)`),e.fillStyle=g,e.beginPath(),e.ellipse(0,0,b,b*.4,0,0,Math.PI*2),e.fill(),e.restore()}}e.globalCompositeOperation="source-over"}function xt(e,n,r,o,t,a,s){for(let i=0;i<a;i++){let l=Math.floor((O(i*100,0,t)+1)*2)%4,u,m,d,b=(O(i*50,i*50,t)+1)/2;switch(l){case 0:u=b*n,m=-20,d=Math.PI/2+O(i*30,0,t)*.4;break;case 1:u=n+20,m=b*r,d=Math.PI+O(i*30,100,t)*.4;break;case 2:u=b*n,m=r+20,d=-Math.PI/2+O(i*30,200,t)*.4;break;default:u=-20,m=b*r,d=O(i*30,300,t)*.4}nt(e,u,m,d,5+Math.abs(O(i*20,i*20,t))*4,0,t,o,s,n,r,i*1e3)}}function nt(e,n,r,o,t,a,s,i,l,u,m,d){if(t<1||a>4)return;let b=[{x:n,y:r,thickness:t}],h=n,c=r,g=o,v=t,p=8+Math.floor(Math.abs(O(d,0,s))*6);for(let f=0;f<p;f++){let R=O(d+f*10,a*100,s)*.6;g+=R;let y=30+O(d+f*20,0,s)*20,M=l>0?Math.sin(l*.002+f*.5+d*.01)*2:0;h+=Math.cos(g)*y,c+=Math.sin(g)*y+M;let $=O(d+f*15,a*50+500,s);if(v*=.92+$*.1,$>.6&&(v*=1.15),b.push({x:h,y:c,thickness:Math.max(.5,v)}),h<-50||h>u+50||c<-50||c>m+50)break;if(f>2&&O(d+f*25,a*200,s)>.7&&a<3){let P=g+(O(d+f*30,0,s)>0?1:-1)*(.5+Math.abs(O(d+f*35,0,s))*.5);nt(e,h,c,P,v*.6,a+1,s,i,l,u,m,d+f*1e3+a*1e4)}}if(!(b.length<2)){e.lineCap="round",e.lineJoin="round";for(let f=0;f<b.length-1;f++){let R=b[Math.max(0,f-1)],y=b[f],M=b[f+1],$=b[Math.min(b.length-1,f+2)],P=y.x+(M.x-R.x)/6,D=y.y+(M.y-R.y)/6,w=M.x-($.x-y.x)/6,S=M.y-($.y-y.y)/6,C=(y.thickness+M.thickness)/2;e.strokeStyle=`rgba(${i.shadow.r}, ${i.shadow.g}, ${i.shadow.b}, 0.4)`,e.lineWidth=C+2,e.beginPath(),e.moveTo(y.x+1,y.y+1),e.bezierCurveTo(P+1,D+1,w+1,S+1,M.x+1,M.y+1),e.stroke(),e.strokeStyle=`rgba(${i.vein.r}, ${i.vein.g}, ${i.vein.b}, 0.7)`,e.lineWidth=C,e.beginPath(),e.moveTo(y.x,y.y),e.bezierCurveTo(P,D,w,S,M.x,M.y),e.stroke(),e.strokeStyle=`rgba(${i.veinHighlight.r}, ${i.veinHighlight.g}, ${i.veinHighlight.b}, 0.25)`,e.lineWidth=C*.4,e.beginPath(),e.moveTo(y.x,y.y-C*.25),e.bezierCurveTo(P,D-C*.25,w,S-C*.25,M.x,M.y-C*.25),e.stroke()}}}function ea(e,n,r,o,t,a){e.globalCompositeOperation="soft-light";for(let s=0;s<15;s++){let i=(O(s*70,0,t)+1)/2*n,l=(O(0,s*70,t)+1)/2*r,u=40+Math.abs(O(s*40,s*40,t))*100,m=O(s*25,500,t)*Math.PI;e.save(),e.translate(i,l),e.rotate(m);let d=.3+Math.abs(O(s*35,0,t))*.4,b=e.createRadialGradient(0,0,0,0,0,u),h=O(s*45,250,t)>0?1.2:.8;b.addColorStop(0,`rgba(${o.mid.r*h}, ${o.mid.g*h}, ${o.mid.b*h}, 0.15)`),b.addColorStop(.7,`rgba(${o.base.r}, ${o.base.g}, ${o.base.b}, 0.05)`),b.addColorStop(1,"transparent"),e.fillStyle=b,e.beginPath(),e.ellipse(0,0,u,u*d,0,0,Math.PI*2),e.fill(),e.restore()}e.globalCompositeOperation="source-over"}function na(e,n,r,o,t,a,s,i){let l=e.createRadialGradient(o,t,0,o,t,a*1.5);l.addColorStop(0,`rgba(${s.veinHighlight.r+20}, ${s.veinHighlight.g}, ${s.veinHighlight.b-10}, 0.12)`),l.addColorStop(.3,`rgba(${s.vein.r+15}, ${s.vein.g}, ${s.vein.b}, 0.08)`),l.addColorStop(.6,`rgba(${s.mid.r+10}, ${s.mid.g+5}, ${s.mid.b+5}, 0.04)`),l.addColorStop(1,"transparent"),e.fillStyle=l,e.fillRect(0,0,n,r);let u=e.createRadialGradient(o,t,0,o,t,a*.5);u.addColorStop(0,`rgba(${s.highlight.r+40}, ${s.highlight.g+35}, ${s.highlight.b+30}, 0.2)`),u.addColorStop(.5,`rgba(${s.highlight.r+20}, ${s.highlight.g+15}, ${s.highlight.b+10}, 0.08)`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.fillRect(0,0,n,r),e.globalCompositeOperation="overlay";let m=a*1.2;for(let d=0;d<5;d++){let b=(O(o*.01+d*20,t*.01,i)+1)*Math.PI,h=20+Math.abs(O(d*30,0,i))*60,c=o+Math.cos(b)*h,g=t+Math.sin(b)*h,v=Math.max(0,1-Math.sqrt((c-o)**2+(g-t)**2)/m)*.3;if(v>.05){e.strokeStyle=`rgba(${s.vein.r+20}, ${s.vein.g}, ${s.vein.b}, ${v})`,e.lineWidth=1+Math.abs(O(d*25,0,i))*2,e.lineCap="round",e.beginPath(),e.moveTo(c,g);let p=b+O(d*15,500,i)*.8,f=20+Math.abs(O(d*35,0,i))*40,R=f*.5,y=b+O(d*20,250,i)*.5;e.quadraticCurveTo(c+Math.cos(y)*R,g+Math.sin(y)*R,c+Math.cos(p)*f,g+Math.sin(p)*f),e.stroke()}}e.globalCompositeOperation="source-over"}function tn(e,n,r,o,t={}){let{count:a=8,seed:s=123,palette:i=ee.rocky}=t,l=et(s);for(let u=0;u<a;u++){let m=(O(u*50,0,l)+1)*Math.PI,d=Math.abs(O(u*30,u*30,l))*o,b=n+Math.cos(m)*d,h=r+Math.sin(m)*d,c=3+Math.abs(O(u*40,0,l))*8;e.strokeStyle=`rgba(${i.highlight.r}, ${i.highlight.g}, ${i.highlight.b}, 0.5)`,e.lineWidth=2,e.beginPath(),e.arc(b,h,c,Math.PI*.7,Math.PI*1.9),e.stroke(),e.strokeStyle=`rgba(${i.shadow.r}, ${i.shadow.g}, ${i.shadow.b}, 0.6)`,e.beginPath(),e.arc(b,h,c,Math.PI*1.9,Math.PI*.7),e.stroke(),e.fillStyle=`rgba(${i.mid.r}, ${i.mid.g}, ${i.mid.b}, 0.7)`,e.beginPath(),e.arc(b,h,c*.5,0,Math.PI*2),e.fill()}}function an(e,n,r,o,t={}){let{angle:a=0,width:s=3,palette:i=ee.fleshy}=t,l=n+Math.cos(a)*o*.5,u=r+Math.sin(a)*o*.5,m=n+Math.cos(a)*o,d=r+Math.sin(a)*o,b=(Math.random()-.5)*15,h=l+Math.cos(a+Math.PI/2)*b,c=u+Math.sin(a+Math.PI/2)*b;e.strokeStyle=`rgba(${i.shadow.r}, ${i.shadow.g}, ${i.shadow.b}, 0.7)`,e.lineWidth=s,e.lineCap="round",e.beginPath(),e.moveTo(n,r),e.quadraticCurveTo(h,c,m,d),e.stroke(),e.strokeStyle=`rgba(${i.veinHighlight.r}, ${i.veinHighlight.g}, ${i.veinHighlight.b}, 0.35)`,e.lineWidth=s*.4,e.beginPath(),e.moveTo(n,r-s*.4),e.quadraticCurveTo(h,c-s*.4,m,d-s*.4),e.stroke()}x("deepSea",{colors:In,gradients:Dn,particles:Gn,recipes:An,surfaces:Bn});var En={};W(En,{addAlphaToColor:()=>on,getGrowthColor:()=>at,livingOs:()=>G,rgbToHex:()=>rt,rgbToRgba:()=>tt});var G={bark:{dark:{r:29,g:20,b:23},mid:{r:61,g:40,b:23},light:{r:92,g:61,b:42}},foliage:{dark:{r:29,g:58,b:45},mid:{r:45,g:90,b:61},light:{r:61,g:106,b:77},vibrant:{r:77,g:122,b:93}},growth:{new:{r:90,g:122,b:77},young:{r:106,g:138,b:93}},decay:{old:{r:29,g:58,b:45},withered:{r:23,g:45,b:35}},unsettling:{hungry:{r:100,g:80,b:60},satisfied:{r:60,g:80,b:60},starving:{r:40,g:50,b:40}}};function rt(e){let n=Math.round(e.r).toString(16).padStart(2,"0"),r=Math.round(e.g).toString(16).padStart(2,"0"),o=Math.round(e.b).toString(16).padStart(2,"0");return`#${n}${r}${o}`}function tt(e,n=1){return`rgba(${Math.round(e.r)}, ${Math.round(e.g)}, ${Math.round(e.b)}, ${n})`}function at(e){let n=Math.max(0,Math.min(100,e));if(n<20)return G.foliage.mid;if(n<50){let r=(n-20)/30;return{r:Math.round(G.foliage.mid.r+(G.growth.new.r-G.foliage.mid.r)*r),g:Math.round(G.foliage.mid.g+(G.growth.new.g-G.foliage.mid.g)*r),b:Math.round(G.foliage.mid.b+(G.growth.new.b-G.foliage.mid.b)*r)}}else if(n<80){let r=(n-50)/30;return{r:Math.round(G.growth.new.r+(G.unsettling.hungry.r-G.growth.new.r)*r),g:Math.round(G.growth.new.g+(G.unsettling.hungry.g-G.growth.new.g)*r),b:Math.round(G.growth.new.b+(G.unsettling.hungry.b-G.growth.new.b)*r)}}else{let r=(n-80)/20;return{r:Math.round(G.unsettling.hungry.r+(G.unsettling.starving.r-G.unsettling.hungry.r)*r),g:Math.round(G.unsettling.hungry.g+(G.unsettling.starving.g-G.unsettling.hungry.g)*r),b:Math.round(G.unsettling.hungry.b+(G.unsettling.starving.b-G.unsettling.hungry.b)*r)}}}function on(e,n){let r=Math.max(0,Math.min(1,n)),o=e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\s*\)/i);if(o)return`rgba(${o[1]}, ${o[2]}, ${o[3]}, ${r})`;let t=e.match(/#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})/);if(t){let a=t[1],s,i,l;return a.length===3?(s=parseInt(a[0]+a[0],16),i=parseInt(a[1]+a[1],16),l=parseInt(a[2]+a[2],16)):(s=parseInt(a.slice(0,2),16),i=parseInt(a.slice(2,4),16),l=parseInt(a.slice(4,6),16)),`rgba(${s}, ${i}, ${l}, ${r})`}return console.warn(`Could not parse color format: "${e}". Returning as-is.`),e}var qn={};W(qn,{drawGrowingRoots:()=>Hn,drawGrowthIndicator:()=>ht,drawOrganicRoots:()=>ct,drawOrganicVine:()=>gt,drawVines:()=>Yn});var Wn={};W(Wn,{clearPermutationCache:()=>st,clearTextureCache:()=>it,createPermutation:()=>zn,drawBarkTexture:()=>J,drawBarkTextureCached:()=>dt,drawOrganicSurface:()=>ut,fbm:()=>N,getOrCreatePermutation:()=>K,getTextureCacheSize:()=>lt,precomputePermutations:()=>ot,simplex2D:()=>T,woodPalettes:()=>Xn});var ra=.5*(Math.sqrt(3)-1),Re=(3-Math.sqrt(3))/6,be=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];function zn(e){let n=Array.from({length:256},(o,t)=>t),r=e;for(let o=255;o>0;o--){r=r*1103515245+12345&2147483647;let t=r%(o+1);[n[o],n[t]]=[n[t],n[o]]}return[...n,...n]}var sn=new Map;function K(e){if(sn.has(e))return sn.get(e);let n=zn(e);return sn.set(e,n),n}function ot(e){for(let n of e)K(n)}function st(){sn.clear()}function T(e,n,r){let o=(e+n)*ra,t=Math.floor(e+o),a=Math.floor(n+o),s=(t+a)*Re,i=t-s,l=a-s,u=e-i,m=n-l,d=u>m?1:0,b=u>m?0:1,h=u-d+Re,c=m-b+Re,g=u-1+2*Re,v=m-1+2*Re,p=t&255,f=a&255,R=r[p+r[f]]%8,y=r[p+d+r[f+b]]%8,M=r[p+1+r[f+1]]%8,$=0,P=0,D=0,w=.5-u*u-m*m;w>=0&&(w*=w,$=w*w*(be[R][0]*u+be[R][1]*m));let S=.5-h*h-c*c;S>=0&&(S*=S,P=S*S*(be[y][0]*h+be[y][1]*c));let C=.5-g*g-v*v;return C>=0&&(C*=C,D=C*C*(be[M][0]*g+be[M][1]*v)),70*($+P+D)}function N(e,n,r,o=4){let t=0,a=.5,s=1,i=0;for(let l=0;l<o;l++)t+=a*T(e*s,n*s,r),i+=a,a*=.5,s*=2;return t/i}var Xn={oak:{darkBrown:{r:35,g:22,b:12},baseBrown:{r:61,g:40,b:23},midBrown:{r:85,g:58,b:35},lightBrown:{r:110,g:78,b:50},grain:{r:45,g:28,b:15},moss:{r:55,g:75,b:40}},darkWood:{darkBrown:{r:20,g:12,b:8},baseBrown:{r:38,g:25,b:15},midBrown:{r:55,g:38,b:25},lightBrown:{r:75,g:52,b:35},grain:{r:28,g:18,b:10},moss:{r:45,g:65,b:35}},weathered:{darkBrown:{r:40,g:35,b:28},baseBrown:{r:65,g:55,b:42},midBrown:{r:88,g:75,b:58},lightBrown:{r:115,g:100,b:80},grain:{r:50,g:42,b:32},moss:{r:60,g:80,b:45}}},se=new Map,ta=.1,aa=10;function it(){se.clear()}function lt(){return se.size}function J(e,n){let{width:r,height:o,grainFlow:t="vertical",age:a=.5,growthLevel:s=0,knotDensity:i=.3,mossPatches:l=!1,roughness:u=.5,color:m,woodType:d="oak",seed:b=0,time:h=0}=n,c=1920,g=1080,v=c*g,p=Math.min(r,c),f=Math.min(o,g),R=p*f;if((r>c||o>g)&&console.warn(`drawBarkTexture: Dimensions ${r}x${o} exceed safe limit. Using ${p}x${f}.`),R>v){let w=Math.sqrt(v/R);return J(e,{...n,width:Math.floor(p*w),height:Math.floor(f*w)})}let y=zn(b),M=m?oa(m):Xn[d],$;try{$=e.createImageData(p,f)}catch(w){if(w instanceof RangeError||w instanceof DOMException){let S=Math.floor(p*.5),C=Math.floor(f*.5);return console.error(`drawBarkTexture: Allocation failed. Falling back to ${S}x${C}.`),J(e,{...n,width:S,height:C})}throw w}let P=$.data,D=h*5e-5;for(let w=0;w<f;w++)for(let S=0;S<p;S++){let C=(w*p+S)*4,k=N(S*.008+D,w*.008,y,4),E=N(S*.016+100,w*.016+100,y,3),A=(k+1)/2,L=(E+1)/2,z,B,X;if(A<.3){let I=A/.3;z=M.darkBrown.r+(M.baseBrown.r-M.darkBrown.r)*I,B=M.darkBrown.g+(M.baseBrown.g-M.darkBrown.g)*I,X=M.darkBrown.b+(M.baseBrown.b-M.darkBrown.b)*I}else if(A<.6){let I=(A-.3)/.3;z=M.baseBrown.r+(M.midBrown.r-M.baseBrown.r)*I,B=M.baseBrown.g+(M.midBrown.g-M.baseBrown.g)*I,X=M.baseBrown.b+(M.midBrown.b-M.baseBrown.b)*I}else{let I=(A-.6)/.4;z=M.midBrown.r+(M.lightBrown.r-M.midBrown.r)*I*.4,B=M.midBrown.g+(M.lightBrown.g-M.midBrown.g)*I*.4,X=M.midBrown.b+(M.lightBrown.b-M.midBrown.b)*I*.4}z+=(L-.5)*8,B+=(L-.5)*6,X+=(L-.5)*5;let H;if(t==="vertical")H=N(S*.08,w*.008+b*.1,y,3);else if(t==="horizontal")H=N(S*.008+b*.1,w*.08,y,3);else if(t==="radial"){let I=p/2,_=f/2,Z=S-I,j=w-_,le=Math.atan2(j,Z),de=Math.sqrt(Z*Z+j*j);H=N(le*2+de*.01,de*.02,y,3)}else{let I=N(S*.01,w*.01,y,2)*30,_=N(S*.01+50,w*.01+50,y,2)*30;H=N((S+I)*.03,(w+_)*.03,y,3)}if(H>.3&&H<.5){let I=1-Math.abs(H-.4)*10;z=z*(1-I*.3)+M.grain.r*I*.3,B=B*(1-I*.3)+M.grain.g*I*.3,X=X*(1-I*.3)+M.grain.b*I*.3}P[C]=Math.max(0,Math.min(255,z)),P[C+1]=Math.max(0,Math.min(255,B)),P[C+2]=Math.max(0,Math.min(255,X)),P[C+3]=255}if(i>0){let w=Math.floor(i*5*(p*f)/16e4),S=[];for(let C=0;C<w;C++){let k=T(C*100+b,0,y)*.5+.5,E=T(C*100+b,100,y)*.5+.5;S.push({x:k*p,y:E*f,radius:15+T(C*50,b,y)*20})}for(let C=0;C<f;C++)for(let k=0;k<p;k++){let E=(C*p+k)*4;for(let A of S){let L=k-A.x,z=C-A.y,B=Math.sqrt(L*L+z*z);if(B<A.radius*1.5){let X=B/A.radius;if(X<1){let H=Math.sin(B*.5)*.5+.5,I=(1-X)*.4*(1+H*.3);P[E]=Math.max(0,P[E]-I*40),P[E+1]=Math.max(0,P[E+1]-I*35),P[E+2]=Math.max(0,P[E+2]-I*30)}}}}}if(s>.1){let w=Math.min(1,(s-.1)*2)*a,S=Math.floor(w*8);for(let C=0;C<S;C++){let k=T(C*200+b,0,y)*.5+.5,E=T(C*200+b,200,y)*.5+.5,A=50+T(C*100,b,y)*100,L=T(C*150,b+50,y)*Math.PI;for(let z=0;z<f;z++)for(let B=0;B<p;B++){let X=(z*p+B)*4,H=k*p,I=E*f,_=B-H,Z=z-I,j=_*Math.cos(L)+Z*Math.sin(L),le=Math.abs(-_*Math.sin(L)+Z*Math.cos(L));if(j>0&&j<A&&le<3){let de=1-le/3,yn=1-j/A,re=de*yn*w*.5;P[X]=Math.max(0,P[X]-re*50),P[X+1]=Math.max(0,P[X+1]-re*45),P[X+2]=Math.max(0,P[X+2]-re*40)}}}}if(s>.3){let w=Math.min(1,(s-.3)*2.5)*u;for(let S=0;S<f;S++)for(let C=0;C<p;C++){let k=(S*p+C)*4,A=N(C*.1,S*.1,y,5)*w*12;P[k]=Math.max(0,Math.min(255,P[k]+A)),P[k+1]=Math.max(0,Math.min(255,P[k+1]+A*.8)),P[k+2]=Math.max(0,Math.min(255,P[k+2]+A*.6))}}if(l&&s>.5){let w=(s-.5)*2;for(let S=0;S<f;S++)for(let C=0;C<p;C++){let k=(S*p+C)*4,E=N(C*.015+b*.5,S*.015,y,3);if(E>.3){let A=(E-.3)*1.4*w,L=Math.min(.6,A);P[k]=P[k]*(1-L)+M.moss.r*L,P[k+1]=P[k+1]*(1-L)+M.moss.g*L,P[k+2]=P[k+2]*(1-L)+M.moss.b*L}}}if(p===r&&f===o)e.putImageData($,0,0);else{let w=document.createElement("canvas");w.width=p,w.height=f,w.getContext("2d").putImageData($,0,0),e.drawImage(w,0,0,r,o)}}function dt(e,n){let{cacheKey:r,cacheTolerance:o=ta,growthLevel:t=0,...a}=n;if(!r){J(e,n);return}let s=se.get(r);if(s&&Math.abs(s.growthLevel-t)<o){e.drawImage(s.canvas,0,0);return}let i=typeof OffscreenCanvas<"u"?new OffscreenCanvas(n.width,n.height):document.createElement("canvas");i instanceof OffscreenCanvas,i.width=n.width,i.height=n.height;let l=i.getContext("2d");if(J(l,n),e.drawImage(i,0,0),se.size>=aa){let u=se.keys().next().value;se.delete(u)}se.set(r,{canvas:i,growthLevel:t,timestamp:Date.now()})}function ut(e,n){let{type:r="organic",...o}=n;r==="bark"?J(e,{...o,grainFlow:"vertical",roughness:.7}):r==="wood"?J(e,{...o,grainFlow:"vertical",roughness:.4}):J(e,{...o,grainFlow:"chaotic",roughness:(o.roughness||.5)*.6})}function oa(e){let n=sa(e);return{darkBrown:{r:n.r*.5,g:n.g*.5,b:n.b*.5},baseBrown:n,midBrown:{r:n.r*1.3,g:n.g*1.3,b:n.b*1.3},lightBrown:{r:n.r*1.6,g:n.g*1.6,b:n.b*1.6},grain:{r:n.r*.7,g:n.g*.7,b:n.b*.7},moss:{r:55,g:75,b:40}}}function sa(e){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:61,g:40,b:23}}function Hn(e,n){let{origin:r,direction:o="down",length:t,branches:a=2,thickness:s=3,color:i="#3d2817",time:l=0,seed:u=0}=n;e.save(),e.strokeStyle=i,e.lineCap="round",e.lineJoin="round";let m={down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1}}[o],d=t*150,b=30+u%20,h=r.x+m.x*d,c=r.y+m.y*d,g=r.x+m.x*(d*.3)+(u%15-7),v=r.y+m.y*(d*.3)+(u%15-7),p=r.x+m.x*(d*.7)+(u%10-5),f=r.y+m.y*(d*.7)+(u%10-5);e.beginPath(),e.moveTo(r.x,r.y),e.bezierCurveTo(g,v,p,f,h,c);let R=e.createLinearGradient(r.x,r.y,h,c);R.addColorStop(0,i);let y=on(i,0);R.addColorStop(1,y),e.strokeStyle=R,e.lineWidth=s*(1-t*.3),e.stroke();for(let M=0;M<a;M++){let $=(M+1)/(a+1),P=mt(r.x,g,p,h,$),D=mt(r.y,v,f,c,$),w=-m.y,S=m.x,k=((u+M*100)%60-30)*Math.PI/180,E=w*Math.cos(k)-S*Math.sin(k),A=w*Math.sin(k)+S*Math.cos(k),L=t*40*(.5+u%50/100),z=P+E*L,B=D+A*L;e.beginPath(),e.moveTo(P,D),e.lineTo(z,B),e.lineWidth=s*.5*(1-$),e.strokeStyle=i,e.stroke()}e.restore()}function Yn(e,n){let{origin:r,length:o,thickness:t=2,color:a="#2d5a3d",path:s}=n;if(e.save(),e.strokeStyle=a,e.lineCap="round",e.lineJoin="round",e.lineWidth=t,s&&s.length>1){let i=s.filter(l=>l!=null&&typeof l=="object"&&typeof l.x=="number"&&typeof l.y=="number"&&!isNaN(l.x)&&!isNaN(l.y));if(i.length<2)console.warn(`drawVines: Path array has insufficient valid points (${i.length} valid out of ${s.length} total). Falling back to generated path.`);else{e.beginPath(),e.moveTo(i[0].x,i[0].y);for(let l=1;l<i.length;l++){let u=i[l-1],m=i[l];if(l<i.length-1){let d=i[l+1],b=u.x+(m.x-u.x)*.5,h=u.y+(m.y-u.y)*.5,c=m.x+(d.x-m.x)*.3,g=m.y+(d.y-m.y)*.3;e.bezierCurveTo(b,h,c,g,m.x,m.y)}else e.lineTo(m.x,m.y)}e.stroke(),e.restore();return}}{let i=Math.floor(o*20);e.beginPath(),e.moveTo(r.x,r.y);let l=r.x,u=r.y;for(let m=1;m<=i;m++){let d=m/i,b=Math.sin(d*Math.PI*3)*.3,h=Math.cos(b)*10,c=Math.sin(b)*10+5;l+=h,u+=c,e.lineTo(l,u)}e.stroke()}e.restore()}function ht(e,n){let{x:r,y:o,width:t,height:a,growthLevel:s,style:i="vines",color:l="#5a7a4d"}=n;e.save();let u=Math.max(0,Math.min(1,s)),m=a*u;switch(i){case"vines":let d=Math.floor(t/15);for(let c=0;c<d;c++){let g=r+c*t/d+5;Yn(e,{origin:{x:g,y:o+a},length:u,thickness:2,color:l,direction:"up"})}break;case"roots":let b=Math.floor(t/20);for(let c=0;c<b;c++){let g=r+c*t/b+10;Hn(e,{origin:{x:g,y:o},length:u,thickness:2,color:l,direction:"down",branches:1,seed:c*100})}break;case"leaves":let h=Math.floor(u*10);for(let c=0;c<h;c++){let g=r+Math.random()*t,v=o+a-Math.random()*m;e.fillStyle=l,e.beginPath(),e.arc(g,v,4,0,Math.PI*2),e.fill()}break;case"bark":e.fillStyle=l,e.fillRect(r,o+a-m,t,m);break}e.restore()}function mt(e,n,r,o,t){let a=1-t;return a*a*a*e+3*a*a*t*n+3*a*t*t*r+t*t*t*o}function gt(e,n){let{origin:r,target:o,length:t,branchingDepth:a=2,organicVariation:s=.5,hasLeaves:i=!1,hasTendrils:l=!1,growthLevel:u=1,thickness:m=4,color:d="#2d5a3d",leafColor:b,time:h=0,seed:c=0}=n,g=pt(d),v=K(c),p=b||da(g,.15);e.save(),e.lineCap="round",e.lineJoin="round",e.strokeStyle=g,e.fillStyle=p;let f;o?f=Math.atan2(o.y-r.y,o.x-r.x):f=T(c,0,v)*Math.PI*2;let R=[],y=[];bt(e,r.x,r.y,f,m,t*u,0,a,s,v,c,h,g,o,R,y,i,l);for(let M of R)M.thickness>=1.5&&bt(e,M.x,M.y,M.angle,M.thickness,t*u*(1-M.progress)*.6,1,a,s,v,c+M.progress*1e3,h,g,void 0,[],y,i,l);if(i&&y.length>0)for(let M of y)la(e,M.x,M.y,M.angle,M.size,p);e.restore()}function bt(e,n,r,o,t,a,s,i,l,u,m,d,b,h,c,g,v,p){if(a<5||t<.5)return;let f=Math.max(4,Math.floor(a/15)),R=a/f,y=n,M=r,$=o,P=t,D=Math.sin(d*.0015+m)*.03*l;for(let w=0;w<f;w++){let S=w/f,C=m+w*100+s*1e4,k=T(C,s*50,u)*.4*l,E=h?Math.atan2(h.y-M,h.x-y)*.1:0;$+=k+E+D;let L=.94+(T(C+500,m,u)>.6?.08:0);P*=L,P=Math.max(.5,P);let z=y+Math.cos($)*R,B=M+Math.sin($)*R,X=R*.3*(1+T(C+200,0,u)*l*.5),H=R*.3*(1+T(C+300,0,u)*l*.5),I=$+T(C+400,0,u)*.2*l,_=$-T(C+450,0,u)*.2*l,Z=y+Math.cos(I)*X,j=M+Math.sin(I)*X,le=z-Math.cos(_)*H,de=B-Math.sin(_)*H;e.beginPath(),e.moveTo(y,M),e.bezierCurveTo(Z,j,le,de,z,B);let yn=1-S*.2;if(e.strokeStyle=$e(b,yn),e.lineWidth=P,e.stroke(),s<i&&w>1&&w<f-1&&T(C+600,s,u)>.6-s*.1){let re=T(C+700,0,u)>0?1:-1,Cn=$+re*(.4+T(C+800,0,u)*.4);c.push({x:y,y:M,angle:Cn,thickness:P*.55,progress:S})}if(v&&w>0&&w%3===0&&P>1){let re=T(C+900,0,u)>0?1:-1,Cn=$+re*Math.PI*.4,Wt=6+T(C+950,0,u)*4;g.push({x:y,y:M,angle:Cn,size:Wt*(1-S*.3)})}y=z,M=B}p&&P<t*.5&&ia(e,y,M,$,P,u,m,b)}function ia(e,n,r,o,t,a,s,i){let l=2+T(s,100,a)*1.5,u=l*Math.PI*2,m=15+T(s+200,0,a)*10,d=T(s+300,0,a)>0?1:-1;e.beginPath(),e.moveTo(n,r);let b=n,h=r,c=m/(l*Math.PI*2),g=30;for(let v=1;v<=g;v++){let p=v/g,f=o+d*p*u,R=c*(1-p*.7);b=n+Math.cos(f)*R*p*m*.5,h=r+Math.sin(f)*R*p*m*.5,e.lineTo(b,h)}e.strokeStyle=$e(i,.85),e.lineWidth=Math.max(.5,t*.4),e.stroke()}function la(e,n,r,o,t,a){e.save(),e.translate(n,r),e.rotate(o),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(t*.5,-t*.4,t,0),e.quadraticCurveTo(t*.5,t*.4,0,0),e.fillStyle=a,e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(t*.8,0),e.strokeStyle=$e(a,.7),e.lineWidth=.5,e.stroke(),e.restore()}function ct(e,n){let{origin:r,mainRootCount:o=4,maxDepth:t=3,length:a,growthLevel:s=1,thickness:i=5,color:l="#3d2817",surfaceY:u,time:m=0,seed:d=0}=n,b=K(d);e.save(),e.lineCap="round",e.lineJoin="round";let h=Math.max(2,Math.min(6,o));for(let c=0;c<h;c++){let g=d+c*1e4,v=Math.PI*.5,p=Math.PI*.6,f=(c/(h-1)-.5)*p,R=T(g,0,b)*.2,y=v+f+R,M=a*(.7+T(g+100,0,b)*.5)*s,$=i*(.8+T(g+200,0,b)*.4);ft(e,r.x,r.y,y,$,M,0,t,b,g,m,l,u)}e.restore()}function ft(e,n,r,o,t,a,s,i,l,u,m,d,b){if(a<8||t<1||s>i)return;let h=Math.max(3,Math.floor(a/20)),c=a/h,g=n,v=r,p=o,f=t,R=.6;for(let y=0;y<h;y++){let M=y/h,$=u+y*100+s*5e3,P=T($,s*30,l)*.6*R,D=(s===0?.02:.01)*(p<Math.PI?1:-1);p+=P+D;let w=T($+500,u,l)>.65?1.12:.92;f*=w,f=Math.max(1,Math.min(t*1.2,f));let S=g+Math.cos(p)*c,C=v+Math.sin(p)*c,k=c*.35,E=p+T($+200,0,l)*.3,A=p-T($+250,0,l)*.3,L=g+Math.cos(E)*k,z=v+Math.sin(E)*k,B=S-Math.cos(A)*k,X=C-Math.sin(A)*k;if(e.beginPath(),e.moveTo(g,v),e.bezierCurveTo(L,z,B,X,S,C),e.strokeStyle=$e(d,.85-s*.05),e.lineWidth=f,e.stroke(),s<i&&y>0&&T($+600,s,l)>.5-s*.1){let H=T($+700,0,l)>0?1:-1,I=p+H*(.5+T($+800,0,l)*.5);ft(e,g,v,I,f*.5,a*(1-M)*.5,s+1,i,l,$+1e3,m,d,b)}b!==void 0&&v<b&&r>=b&&(e.fillStyle=$e(d,.6),e.beginPath(),e.ellipse(g,b,f*1.5,f*.8,0,0,Math.PI*2),e.fill()),g=S,v=C}}function $e(e,n){let r=vt(e);return Mt(Math.round(r.r*n),Math.round(r.g*n),Math.round(r.b*n))}function da(e,n){let r=vt(e);return Mt(Math.round(r.r+(255-r.r)*n),Math.round(r.g+(255-r.g)*n),Math.round(r.b+(255-r.b)*n))}function pt(e){return e?/^#([a-f\d]{3}){1,2}$/i.test(e)||e.startsWith("rgb")?e:(console.warn(`Invalid color format: ${e}, using default green`),"#2d5a3d"):"#2d5a3d"}function vt(e){let n=pt(e),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:{r:45,g:90,b:61}}function Mt(e,n,r){return"#"+[e,n,r].map(o=>{let t=Math.max(0,Math.min(255,o)).toString(16);return t.length===1?"0"+t:t}).join("")}var Nn={};W(Nn,{drawFlower:()=>wt,drawLeaf:()=>Fn,drawLeaves:()=>yt});function Fn(e,n){let{x:r,y:o,size:t=20,rotation:a=0,type:s="simple",color:i="#3d6a4d",opacity:l=1,growthLevel:u=1,seed:m=0}=n;switch(e.save(),e.translate(r,o),e.rotate(a),e.globalAlpha=l,s){case"simple":Ct(e,t,i);break;case"veined":ua(e,t,i);break;case"organic":ma(e,t,i);break;case"detailed":ba(e,t,i,u,m);break}e.restore()}function yt(e,n){n.forEach(r=>{let o=r.x+(r.driftX||0),t=r.y+(r.driftY||0);Fn(e,{...r,x:o,y:t})})}function Ct(e,n,r){e.fillStyle=r,e.beginPath(),e.moveTo(0,-n*.5),e.bezierCurveTo(n*.3,-n*.2,n*.4,n*.3,0,n*.5),e.bezierCurveTo(-n*.4,n*.3,-n*.3,-n*.2,0,-n*.5),e.closePath(),e.fill()}function ua(e,n,r){Ct(e,n,r),e.strokeStyle=r,e.lineWidth=1,e.globalAlpha=.4,e.beginPath(),e.moveTo(0,-n*.5),e.lineTo(0,n*.5),e.stroke();let o=3;for(let t=0;t<o;t++){let a=(t+1)/(o+1),s=-n*.5+n*a;e.beginPath(),e.moveTo(0,s),e.lineTo(-n*.3,s+n*.1),e.stroke(),e.beginPath(),e.moveTo(0,s),e.lineTo(n*.3,s+n*.1),e.stroke()}e.globalAlpha=1}function ma(e,n,r){e.fillStyle=r,e.beginPath();let o=8,t=Math.PI*2/o;e.moveTo(0,-n*.5);for(let a=0;a<=o;a++){let s=t*a-Math.PI/2,i=n*.5*(1+Math.sin(a*.7)*.2),l=Math.cos(s)*i,u=Math.sin(s)*i;if(a===0)e.moveTo(l,u);else{let m=t*(a-1)-Math.PI/2,d=n*.5*(1+Math.sin((a-1)*.7)*.2),b=Math.cos(m)*d,h=Math.sin(m)*d,c=(b+l)/2+Math.sin(a)*n*.1,g=(h+u)/2+Math.cos(a)*n*.1;e.quadraticCurveTo(c,g,l,u)}}e.closePath(),e.fill(),e.strokeStyle=r,e.lineWidth=.5,e.globalAlpha=.3,e.beginPath(),e.moveTo(0,-n*.5),e.lineTo(0,n*.5),e.stroke(),e.globalAlpha=1}function ba(e,n,r,o,t){let a=K(t),s=ln(r);e.beginPath();let l=24/2,u=[],m=[];for(let d=0;d<=l;d++){let b=d/l,c=Math.sin(b*Math.PI)*.4*n,g=-n*.5+b*n,v=T(t+d*10,0,a)*n*.08,p=T(t+d*10,100,a)*n*.03;u.push({x:-c+v,y:g+p}),m.push({x:c-v,y:g+p})}e.moveTo(0,-n*.5);for(let d=0;d<m.length-1;d++){let b=m[d],h=m[d+1],c=(b.x+h.x)/2+T(t+d*20,200,a)*n*.05,g=(b.y+h.y)/2;e.quadraticCurveTo(b.x,b.y,c,g)}e.lineTo(0,n*.5);for(let d=u.length-1;d>0;d--){let b=u[d],h=u[d-1],c=(b.x+h.x)/2-T(t+d*20,300,a)*n*.05,g=(b.y+h.y)/2;e.quadraticCurveTo(b.x,b.y,c,g)}e.closePath(),e.fillStyle=r,e.fill(),o>.3&&ha(e,n,s,a,t,o),o>.2&&ga(e,n,r,a,t,o)}function ha(e,n,r,o,t,a){let s=(a-.3)*1.4,i=Math.floor(s*8);e.save();for(let l=0;l<i;l++){let u=T(t+l*50,0,o)*n*.35,m=T(t+l*50,50,o)*n*.4,d=3+T(t+l*50,100,o)*4,b=T(t+l*50,150,o)*20,h=`rgba(${Math.max(0,r.r+b)}, ${Math.max(0,r.g+b)}, ${Math.max(0,r.b+b)}, 0.3)`;e.fillStyle=h,e.beginPath(),e.ellipse(u,m,d,d*.7,T(t+l,0,o),0,Math.PI*2),e.fill()}e.restore()}function ga(e,n,r,o,t,a){let s=St(r,.7),i=Math.min(1,a*1.2);e.save(),e.strokeStyle=s,e.lineCap="round",e.lineWidth=1.5,e.globalAlpha=.5*i,e.beginPath(),e.moveTo(0,-n*.45),e.bezierCurveTo(T(t,0,o)*2,0,T(t+100,0,o)*2,n*.3,0,n*.45),e.stroke();let l=Math.floor(4+i*2);for(let u=0;u<l;u++){let m=(u+1)/(l+1),d=-n*.45+m*n*.9,b=Math.sin(m*Math.PI)*n*.35;for(let h of[-1,1]){let c=h*b*.85,g=d+n*.05;if(e.lineWidth=1,e.globalAlpha=.4*i,e.beginPath(),e.moveTo(0,d),e.quadraticCurveTo(h*b*.3+T(t+u*20,h*100,o)*3,d+n*.02,c,g),e.stroke(),a>.5){let v=2+Math.floor((a-.5)*4);for(let p=0;p<v;p++){let f=(p+1)/(v+1),R=h*b*.3*f,y=d+n*.02*f,M=R+h*b*.2,$=y+n*.03;e.lineWidth=.5,e.globalAlpha=.3*i,e.beginPath(),e.moveTo(R,y),e.lineTo(M,$),e.stroke()}}}}e.restore()}function wt(e,n){let{x:r,y:o,petalCount:t=5,petalLength:a=15,color:s="#e8a0b0",centerColor:i="#f5d76e",growthStage:l=1,rotation:u=0,seed:m=0}=n,d=K(m);e.save(),e.translate(r,o),e.rotate(u);let b=l*Math.PI*.4,h=Math.max(4,Math.min(8,t)),c=Math.PI*2/h;for(let g=0;g<h;g++){let v=c*g-Math.PI/2,p=m+g*100,f=1+T(p,0,d)*.15,R=1+T(p,50,d)*.1,y=T(p,100,d)*15,M=(1-l)*a*.3;e.save(),e.rotate(v);let $=ln(s),P=Vn(Math.min(255,Math.max(0,$.r+y)),Math.min(255,Math.max(0,$.g+y)),Math.min(255,Math.max(0,$.b+y)));ca(e,M,a*f*l,a*.35*R,b,P,d,p),e.restore()}if(l>.3){let g=a*.25*Math.min(1,(l-.3)*1.5);fa(e,g,i,d,m)}e.restore()}function ca(e,n,r,o,t,a,s,i){e.save(),e.translate(0,-n),e.rotate(-t*.3),e.fillStyle=a,e.beginPath(),e.moveTo(0,0),e.bezierCurveTo(o*.8+T(i,0,s)*o*.2,-r*.3,o*.6+T(i,50,s)*o*.2,-r*.7,T(i,100,s)*o*.1,-r),e.bezierCurveTo(-o*.6-T(i,150,s)*o*.2,-r*.7,-o*.8-T(i,200,s)*o*.2,-r*.3,0,0),e.closePath(),e.fill(),e.strokeStyle=St(a,.85),e.lineWidth=.5,e.globalAlpha=.4,e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(T(i+300,0,s)*o*.2,-r*.5,0,-r*.85),e.stroke(),e.restore()}function fa(e,n,r,o,t){let a=ln(r);e.fillStyle=r,e.beginPath(),e.arc(0,0,n,0,Math.PI*2),e.fill();let s=Math.floor(n*2);for(let i=0;i<s;i++){let l=i/s*Math.PI*2,u=T(t+i*10,0,o),m=n*(.3+u*.5),d=Math.cos(l)*m,b=Math.sin(l)*m,h=1+T(t+i*10,100,o)*1,c=T(t+i*10,200,o)*30;e.fillStyle=Vn(Math.max(0,Math.min(255,a.r-c)),Math.max(0,Math.min(255,a.g-c)),Math.max(0,Math.min(255,a.b-c))),e.beginPath(),e.arc(d,b,h,0,Math.PI*2),e.fill()}}function ln(e){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:61,g:106,b:77}}function Vn(e,n,r){return"#"+[e,n,r].map(o=>{let t=Math.max(0,Math.min(255,Math.round(o))).toString(16);return t.length===1?"0"+t:t}).join("")}function St(e,n){let r=ln(e);return Vn(Math.round(r.r*n),Math.round(r.g*n),Math.round(r.b*n))}var Kn={};W(Kn,{GROWTH_TIMING:()=>Jn,applyDrift:()=>Rt,applyGrowthTiming:()=>It,applySway:()=>Pt,calculateDrift:()=>jn,calculateGrowthProgress:()=>$t,calculatePulse:()=>kt,calculateScalePulse:()=>Ot,calculateSway:()=>_n,calculateTipGrowthMultiplier:()=>Tt});function _n(e){let{intensity:n=.5,speed:r=1,time:o,baseRotation:t=0}=e,a=Math.sin(o*r*.5)*n*.05;return t+a}function jn(e){let{intensity:n=.5,speed:r=1,time:o,baseX:t=0,baseY:a=0}=e,s=Math.sin(o*r*.3)*n*5,i=Math.cos(o*r*.2)*n*3;return{x:t+s,y:a+i}}function Pt(e,n,r,o){let t=_n(o);e.save(),e.translate(n,r),e.rotate(t),e.translate(-n,-r)}function Rt(e,n){let{x:r,y:o}=jn(n);e.translate(r,o)}function $t(e){let{baseGrowth:n,time:r,seed:o=0,style:t="linear"}=e,a=Math.max(0,Math.min(1,n));switch(t){case"linear":return a;case"pulse":{let i=1+(Math.sin(r*.0015+o)*.5+.5)*.3;return Math.min(1,a*i)}case"surge":{let s=a*a,i=Math.sin(r*.001+o*.1)*.05;return Math.max(0,Math.min(1,s+i))}case"glacial":{let l=(Math.sin(r*2e-4+o)*.5+.5-.5)*.04;return Math.max(0,Math.min(1,a+l))}default:return a}}function Tt(e,n,r=0){let o=e*.3,t=Math.sin(n*.002+r+e*10)*.1;return 1+o+t*e}function kt(e){let{time:n,intensity:r=.15,speed:o=1,minOpacity:t=.8}=e,a=Math.sin(n*.002*o)*.5+.5,s=1-t;return t+pa(a,s,r)}function pa(e,n,r){return e*n*r+n*(1-r)}function Ot(e,n=.02,r=1){return 1+Math.sin(e*.001*r)*n}var Jn={glacial:{baseSpeed:2e-4,pulseSpeed:.001,tipMultiplier:1.2},slow:{baseSpeed:5e-4,pulseSpeed:.0015,tipMultiplier:1.3},normal:{baseSpeed:.001,pulseSpeed:.002,tipMultiplier:1.4},fast:{baseSpeed:.003,pulseSpeed:.004,tipMultiplier:1.5}};function It(e,n,r="slow",o=0){let t=Jn[r],a=n*t.baseSpeed,s=Math.sin(n*t.pulseSpeed+o)*.1,i=e+s*e;return Math.max(0,Math.min(1,i))}x("livingOs",{colors:En,growth:qn,plants:Nn,textures:Wn,motion:Kn});var dn={};W(dn,{gardenWindow:()=>U,interpolateColor:()=>Gt,overgrown:()=>V,softGarden:()=>ne,terrarium:()=>q,withAlpha:()=>Dt});var ne={background:{light:"#faf6f1",mid:"#efe8dc",dark:"#dfd4c8"},accents:{pollen:"#f5e5b8",warmth:"#ffd9a3",sunRay:"#fff8eb"},particles:{pollen:{bright:"rgba(245, 229, 184, 0.6)",mid:"rgba(235, 215, 160, 0.4)",dim:"rgba(220, 200, 140, 0.2)"}}},q={background:{surface:"#c8d5b9",mid:"#7a9b76",deep:"#4a6b47",shadow:"#2d4a2c"},foliage:{new:"#a8c69f",mature:"#6b8f67",shadow:"#4a6247",accent:"#8fb581"},particles:{leaves:{light:"rgba(168, 198, 159, 0.5)",mid:"rgba(107, 143, 103, 0.35)",dark:"rgba(74, 98, 71, 0.2)"}}},U={glass:{tint:"rgba(245, 248, 250, 0.3)",edge:"rgba(220, 230, 235, 0.5)",smudge:"rgba(200, 210, 220, 0.15)"},garden:{muted:"#b8c9b5",soft:"#9db09a",distant:"#8a998763"},particles:{dust:{bright:"rgba(220, 230, 240, 0.25)",dim:"rgba(180, 200, 220, 0.12)",veryDim:"rgba(150, 170, 190, 0.05)"}}},V={background:{dense:"#3d5a3c",vibrant:"#5a7f58",light:"#7fa67d"},growth:{vine:"#4f6b4e",leaf:"#6d8f6b",wild:"#5f9a5c",shadow:"#3a5538"},particles:{fragments:{bright:"rgba(127, 166, 125, 0.6)",mid:"rgba(95, 154, 92, 0.4)",dim:"rgba(62, 85, 60, 0.2)"}}};function Dt(e,n){let r=e.replace("#",""),o=parseInt(r.substring(0,2),16),t=parseInt(r.substring(2,4),16),a=parseInt(r.substring(4,6),16);return`rgba(${o}, ${t}, ${a}, ${n})`}function Gt(e,n,r){let o=e.replace("#",""),t=n.replace("#",""),a=parseInt(o.substring(0,2),16),s=parseInt(o.substring(2,4),16),i=parseInt(o.substring(4,6),16),l=parseInt(t.substring(0,2),16),u=parseInt(t.substring(2,4),16),m=parseInt(t.substring(4,6),16),d=Math.round(a+(l-a)*r),b=Math.round(s+(u-s)*r),h=Math.round(i+(m-i)*r);return`#${d.toString(16).padStart(2,"0")}${b.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}`}var un={};W(un,{applyDepthLayers:()=>va,applyFrostedGlassEffect:()=>Ma,drawAtmosphericFog:()=>ya,drawSunRays:()=>er,gardenWindowBackground:()=>Qn,overgrownBackground:()=>xn,softGardenBackground:()=>Un,terrariumBackground:()=>Zn});function Un(e,n,r){let o=e.createLinearGradient(0,0,0,r);o.addColorStop(0,ne.background.light),o.addColorStop(.5,ne.background.mid),o.addColorStop(1,ne.background.dark),e.fillStyle=o,e.fillRect(0,0,n,r)}function Zn(e,n,r){let o=e.createLinearGradient(0,0,0,r);o.addColorStop(0,q.background.deep),o.addColorStop(1,q.background.shadow),e.fillStyle=o,e.fillRect(0,0,n,r);let t=e.createLinearGradient(0,r*.2,0,r);t.addColorStop(0,q.background.mid),t.addColorStop(1,q.background.deep),e.fillStyle=t,e.globalAlpha=.6,e.fillRect(0,r*.3,n,r*.7),e.globalAlpha=1;let a=e.createLinearGradient(0,0,0,r*.4);a.addColorStop(0,q.background.surface),a.addColorStop(1,q.background.mid),e.fillStyle=a,e.globalAlpha=.5,e.fillRect(0,0,n,r*.4),e.globalAlpha=1}function Qn(e,n,r){let o=e.createLinearGradient(0,0,0,r);o.addColorStop(0,U.garden.soft),o.addColorStop(.5,U.garden.muted),o.addColorStop(1,U.garden.distant),e.fillStyle=o,e.fillRect(0,0,n,r),e.fillStyle=U.glass.tint,e.fillRect(0,0,n,r)}function xn(e,n,r){let o=e.createLinearGradient(0,0,0,r);o.addColorStop(0,V.background.vibrant),o.addColorStop(.4,V.background.dense),o.addColorStop(.7,V.background.dense),o.addColorStop(1,V.growth.shadow),e.fillStyle=o,e.fillRect(0,0,n,r);let t=e.createRadialGradient(n/2,r/2,Math.min(n,r)*.3,n/2,r/2,Math.max(n,r)*.8);t.addColorStop(0,"transparent"),t.addColorStop(.7,"rgba(0, 0, 0, 0.1)"),t.addColorStop(1,"rgba(0, 0, 0, 0.2)"),e.fillStyle=t,e.fillRect(0,0,n,r)}function va(e,n,r,o,t=3){for(let a=0;a<t;a++){let s=1/t*(a+1)*.2,i=o/t*a,l=o/t;e.fillStyle=n.includes("rgba")?n.replace(/[\d.]+\)$/,`${s})`):`rgba(0, 0, 0, ${s})`,e.fillRect(0,i,r,l)}}function er(e,n,r,o=4){e.save();for(let t=0;t<o;t++){let a=Math.PI/o*(t+.5)-Math.PI/4,s=n*.5,i=r*-.2,l=s+Math.cos(a)*n,u=i+Math.sin(a)*r*1.5,m=e.createLinearGradient(s,i,l,u);m.addColorStop(0,"rgba(255, 248, 235, 0.3)"),m.addColorStop(.5,"rgba(255, 240, 220, 0.1)"),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.moveTo(s,i),e.lineTo(s+Math.cos(a)*n*1.5,i+Math.sin(a)*r*2),e.lineTo(s-Math.sin(a)*(n*.15),i+Math.cos(a)*(r*.15)),e.closePath(),e.fill()}e.restore()}function Ma(e,n,r,o=.1){let t=document.createElement("canvas");t.width=100,t.height=100;let a=t.getContext("2d");if(!a)return;for(let i=0;i<100;i+=5)for(let l=0;l<100;l+=5){let u=Math.random()*o;a.fillStyle=`rgba(255, 255, 255, ${u})`,a.fillRect(i,l,5,5)}let s=e.createPattern(t,"repeat");s&&(e.fillStyle=s,e.fillRect(0,0,n,r))}function ya(e,n,r,o=.3){let t=e.createLinearGradient(0,0,0,r);t.addColorStop(0,`rgba(255, 255, 255, ${o*.5})`),t.addColorStop(.5,`rgba(255, 255, 255, ${o})`),t.addColorStop(1,`rgba(255, 255, 255, ${o*.3})`),e.fillStyle=t,e.fillRect(0,0,n,r)}var bn={};W(bn,{createDustMotes:()=>or,createFloatingLeaves:()=>tr,createOvergrownParticles:()=>ir,createPollen:()=>mn,updateDustMotes:()=>sr,updateFloatingLeaves:()=>ar,updateOvergrownParticles:()=>lr,updatePollen:()=>rr});var nr={glacial:8e-4,verySlow:.001,slow:.002};function mn(e=35){let n=[];for(let r=0;r<e;r++)n.push({x:Math.random()*100,y:Math.random()*100,size:.8+Math.random()*2.2,speed:.001+Math.random()*.004,alpha:.15+Math.random()*.25,driftPhase:Math.random()*Math.PI*2});return n}function rr(e,n,r,o,t){e.forEach(a=>{a.y+=a.speed*t,a.y>110&&(a.y=-10),a.y<-5&&(a.y=105);let s=Math.sin(t*nr.glacial+a.driftPhase)*.3,i=(a.x+s)*(r/100),l=a.y*(o/100);n.save(),n.fillStyle=`rgba(245, 229, 184, ${a.alpha})`,n.beginPath(),n.arc(i,l,a.size,0,Math.PI*2),n.fill(),n.strokeStyle=`rgba(255, 240, 220, ${a.alpha*.5})`,n.lineWidth=.5,n.stroke(),n.restore()})}function tr(e=18){let n=["oval","pointed","round"],r=[];for(let o=0;o<e;o++)r.push({x:Math.random()*100,y:Math.random()*100,size:3+Math.random()*5,speed:8e-4+Math.random()*.0022,alpha:.2+Math.random()*.3,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*nr.verySlow,shape:n[Math.floor(Math.random()*n.length)]});return r}function ar(e,n,r,o,t){e.forEach(a=>{a.y+=a.speed*t*.5,a.x+=Math.sin(t*nr.glacial+a.y*.01)*a.speed*.3,a.rotation+=a.rotationSpeed*t,a.y>110&&(a.y=-10),a.x<-10&&(a.x=110),a.x>110&&(a.x=-10);let s=a.x*(r/100),i=a.y*(o/100);switch(n.save(),n.translate(s,i),n.rotate(a.rotation),n.fillStyle=`rgba(107, 143, 103, ${a.alpha})`,a.shape){case"oval":n.ellipse(0,0,a.size*1.5,a.size,0,0,Math.PI*2);break;case"pointed":n.beginPath(),n.moveTo(0,-a.size),n.quadraticCurveTo(a.size*.7,0,0,a.size),n.quadraticCurveTo(-a.size*.7,0,0,-a.size);break;case"round":n.arc(0,0,a.size,0,Math.PI*2);break}n.fill(),n.restore()})}function or(e=55){let n=[];for(let r=0;r<e;r++)n.push({x:Math.random()*100,y:Math.random()*100,z:Math.random(),size:.5+Math.random()*1,speed:5e-4+Math.random()*.0015,alpha:.08+Math.random()*.17,phase:Math.random()*Math.PI*2});return n}function sr(e,n,r,o,t){e.forEach(a=>{a.x+=Math.sin(t*a.speed+a.phase)*a.speed*.5,a.y+=Math.cos(t*a.speed+a.phase*1.3)*a.speed*.5,a.x=(a.x+100)%100,a.y=(a.y+100)%100;let s=a.x*(r/100),i=a.y*(o/100);n.save();let l=a.alpha*(.5+a.z*.5);n.fillStyle=`rgba(220, 230, 240, ${l})`,n.beginPath(),n.arc(s,i,a.size,0,Math.PI*2),n.fill(),n.restore()})}function ir(e=75){let n=[];for(let r=0;r<e;r++){let o=Math.random()>.6;n.push({x:Math.random()*100,y:Math.random()*100,size:o?1.5+Math.random()*3:.8+Math.random()*2,speed:8e-4+Math.random()*.003,alpha:.2+Math.random()*.35,rotation:Math.random()*Math.PI*2,type:o?"fragment":"pollen"})}return n}function lr(e,n,r,o,t){e.forEach(a=>{a.y+=a.speed*t*1.2,a.x+=Math.sin(t*a.speed+a.y)*a.speed*.8,a.type==="fragment"&&(a.rotation+=a.speed*t*.3),a.y>110&&(a.y=-10),a.x<-10&&(a.x=110),a.x>110&&(a.x=-10);let s=a.x*(r/100),i=a.y*(o/100);n.save(),n.translate(s,i),a.type==="fragment"?(n.rotate(a.rotation),n.fillStyle=`rgba(95, 154, 92, ${a.alpha})`,n.fillRect(-a.size*.3,-a.size*.6,a.size*.6,a.size)):(n.fillStyle=`rgba(127, 166, 125, ${a.alpha})`,n.beginPath(),n.arc(0,0,a.size,0,Math.PI*2),n.fill()),n.restore()})}var vn={};W(vn,{drawBlurredPlant:()=>fn,drawFlower:()=>Lt,drawFlowerCluster:()=>Ca,drawLeafCluster:()=>gn,drawOrganicVine:()=>ie,drawPetal:()=>cn,drawPlantSilhouette:()=>pn,drawPointedLeaf:()=>hn,drawSimpleLeaf:()=>he,drawVineSegment:()=>At});function he(e,n,r,o,t,a=0){e.save(),e.translate(n,r),e.rotate(a),e.fillStyle=t,e.beginPath(),e.moveTo(0,-o),e.quadraticCurveTo(o*.6,-o*.3,o*.5,0),e.quadraticCurveTo(o*.6,o*.3,0,o),e.quadraticCurveTo(-o*.6,o*.3,-o*.5,0),e.quadraticCurveTo(-o*.6,-o*.3,0,-o),e.closePath(),e.fill(),e.strokeStyle="rgba(0, 0, 0, 0.15)",e.lineWidth=.5,e.beginPath(),e.moveTo(0,-o),e.quadraticCurveTo(o*.1,0,0,o),e.stroke(),e.restore()}function hn(e,n,r,o,t,a=0){e.save(),e.translate(n,r),e.rotate(a),e.fillStyle=t,e.beginPath(),e.moveTo(0,-o*1.2),e.quadraticCurveTo(o*.5,-o*.4,o*.6,o*.3),e.quadraticCurveTo(o*.3,o*.8,0,o),e.quadraticCurveTo(-o*.3,o*.8,-o*.6,o*.3),e.quadraticCurveTo(-o*.5,-o*.4,0,-o*1.2),e.closePath(),e.fill(),e.restore()}function gn(e,n,r,o=5,t=8,a="#6b8f67",s=1){e.save();for(let i=0;i<o;i++){let l=(Math.random()-.5)*t*s,u=(Math.random()-.5)*t*s,m=i/o*Math.PI*2,d=.6+Math.random()*.4;e.globalAlpha=d,i%2===0?he(e,n+l,r+u,t*.7,a,m):hn(e,n+l,r+u,t*.6,a,m)}e.globalAlpha=1,e.restore()}function cn(e,n,r,o,t,a,s=0){e.save(),e.translate(n,r),e.rotate(s),e.fillStyle=a,e.beginPath(),e.ellipse(0,0,o*.5,t,0,0,Math.PI*2),e.fill(),e.restore()}function At(e,n,r,o,t,a,s,i=.1){e.save();let l=(n+o)/2+(Math.random()-.5)*i*20,u=(r+t)/2+(Math.random()-.5)*i*20;e.strokeStyle=s,e.lineWidth=a,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(n,r),e.quadraticCurveTo(l,u,o,t),e.stroke(),e.restore()}function ie(e,n,r,o,t,a,s,i=0,l=3){if(i>l||a<.5)return;let u=n+Math.cos(t)*o,m=r+Math.sin(t)*o;if(At(e,n,r,u,m,a,s,.08),i<l){let d=o*.7,b=a*.75,h=t-.4+(Math.random()-.5)*.2;ie(e,u,m,d,h,b,s,i+1,l);let c=t+.4+(Math.random()-.5)*.2;ie(e,u,m,d,c,b,s,i+1,l)}}function Lt(e,n,r,o=5,t=6,a="#a8c69f",s="#f5e5b8"){e.save();for(let i=0;i<o;i++){let l=i/o*Math.PI*2,u=n+Math.cos(l)*t*.8,m=r+Math.sin(l)*t*.8;cn(e,u,m,t*.6,t,a,l)}e.fillStyle=s,e.beginPath(),e.arc(n,r,t*.4,0,Math.PI*2),e.fill(),e.restore()}function Ca(e,n,r,o=3,t=30){for(let a=0;a<o;a++){let s=(Math.random()-.5)*t,i=(Math.random()-.5)*t,l=4+Math.floor(Math.random()*3);Lt(e,n+s,r+i,l,4+Math.random()*2)}}function fn(e,n,r,o,t,a=4){e.save(),e.filter=`blur(${a}px)`,e.globalAlpha=.4,gn(e,n,r,8,o,t,1.5),e.filter="none",e.globalAlpha=1,e.restore()}function pn(e,n,r,o,t,a=6){e.save(),e.fillStyle=t,e.fillRect(n-1,r,2,o);for(let s=0;s<a;s++){let i=r+o/a*s,l=4+(a-s)*.5;s%2===0?he(e,n-l*.8,i,l,t,-.3):he(e,n+l*.8,i,l,t,.3)}e.restore()}var Mn={};W(Mn,{drawAnimatedShimmer:()=>$a,drawDepthFog:()=>wa,drawEdgeVignette:()=>Ra,drawFrostedGlassOverlay:()=>dr,drawGlassSmudges:()=>ur,drawLensDamage:()=>hr,drawLensReflection:()=>Sa,drawLightRays:()=>Pa,drawOrganicNoise:()=>br,drawVignette:()=>mr});function dr(e,n,r,o=.15){e.save(),e.fillStyle=`rgba(245, 248, 250, ${o*.3})`,e.fillRect(0,0,n,r);for(let t=0;t<n;t+=8)for(let a=0;a<r;a+=8){let s=Math.random()*o*.5;e.fillStyle=`rgba(255, 255, 255, ${s})`,e.fillRect(t,a,Math.random()*4+2,Math.random()*4+2)}e.restore()}function ur(e,n,r,o=8){e.save();for(let t=0;t<o;t++){let a=Math.random()*n,s=Math.random()*r,i=20+Math.random()*40,l=3+Math.random()*8,u=e.createLinearGradient(a,s,a,s+l*2);u.addColorStop(0,`rgba(220, 230, 235, ${Math.random()*.08})`),u.addColorStop(.5,`rgba(200, 210, 220, ${Math.random()*.1})`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.fillRect(a,s,i,l)}e.restore()}function wa(e,n,r,o="rgba(255, 255, 255, 0.3)",t=3){e.save();for(let a=0;a<t;a++){let s=r/t*a,i=r/t,l=1/t*(a+1)*.15,u=e.createLinearGradient(0,s,0,s+i);u.addColorStop(0,`rgba(255, 255, 255, ${l*.5})`),u.addColorStop(.5,`rgba(255, 255, 255, ${l})`),u.addColorStop(1,`rgba(255, 255, 255, ${l*.5})`),e.fillStyle=u,e.fillRect(0,s,n,i)}e.restore()}function mr(e,n,r,o=.3){e.save();let t=e.createRadialGradient(n/2,r/2,Math.min(n,r)*.2,n/2,r/2,Math.max(n,r)*.8);t.addColorStop(0,"transparent"),t.addColorStop(.6,`rgba(0, 0, 0, ${o*.3})`),t.addColorStop(1,`rgba(0, 0, 0, ${o})`),e.fillStyle=t,e.fillRect(0,0,n,r),e.restore()}function br(e,n,r,o=.2,t=20){e.save();for(let a=0;a<n;a+=t)for(let s=0;s<r;s+=t){let i=Math.random()*o;e.fillStyle=`rgba(0, 0, 0, ${i})`,e.fillRect(a,s,t,t)}e.restore()}function Sa(e,n,r,o=40,t=.3){e.save();let a=e.createRadialGradient(n,r,0,n,r,o);a.addColorStop(0,`rgba(255, 255, 255, ${t})`),a.addColorStop(.5,`rgba(255, 255, 255, ${t*.3})`),a.addColorStop(1,"transparent"),e.fillStyle=a,e.beginPath(),e.arc(n,r,o,0,Math.PI*2),e.fill(),e.restore()}function hr(e,n,r,o=3){e.save(),e.strokeStyle="rgba(100, 100, 100, 0.3)",e.lineWidth=1,e.lineCap="round";for(let t=0;t<o;t++){let a=Math.random()*n,s=Math.random()*r,i=a+(Math.random()-.5)*200,l=s+(Math.random()-.5)*200;e.beginPath(),e.moveTo(a,s);for(let u=0;u<10;u++){let m=a+(i-a)*u/10+(Math.random()-.5)*10,d=s+(l-s)*u/10+(Math.random()-.5)*10;e.lineTo(m,d)}e.lineTo(i,l),e.stroke()}e.restore()}function Pa(e,n,r,o=4,t=.2){e.save();for(let a=0;a<o;a++){let s=Math.PI/o*a-Math.PI/8,i=n/2,l=-r*.2,u=i+Math.cos(s)*n*1.5,m=l+Math.sin(s)*r*2,d=e.createLinearGradient(i,l,u,m);d.addColorStop(0,`rgba(255, 248, 235, ${t})`),d.addColorStop(.5,`rgba(255, 240, 220, ${t*.5})`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.beginPath(),e.moveTo(i,l),e.lineTo(u,m),e.lineTo(i-Math.sin(s)*n*.3,l+Math.cos(s)*r*.3),e.closePath(),e.fill()}e.restore()}function Ra(e,n,r,o="rgba(0, 0, 0, 0.3)",t=40){e.save(),e.fillStyle=o,e.fillRect(0,0,n,t),e.fillRect(0,r-t,n,t),e.fillRect(0,0,t,r),e.fillRect(n-t,0,t,r),e.restore()}function $a(e,n,r,o,t,a,s=.15){e.save();let i=Math.sin(a*.002)*s;e.fillStyle=`rgba(255, 255, 255, ${i})`,e.fillRect(n,r,o,t),e.restore()}var gr={};W(gr,{drawGardenThroughGlass:()=>zt,drawOvergrownCamera:()=>Xt,drawSoftGardenWindow:()=>Bt,drawTerrariumView:()=>Et});var ge={glacial:8e-4,verySlow:.001,slow:.002},Ta={pollenParticles:mn(35)};function Bt(e,n,r,o,t,a={}){let{time:s=0,intensity:i=1}=a;e.save(),e.translate(n,r),Un(e,o,t),e.globalAlpha=.3*i,er(e,o,t,4),e.globalAlpha=1,rr(Ta.pollenParticles,e,o,t,s),e.globalAlpha=.25*i;for(let l=0;l<6;l++){let u=(Math.sin(s*ge.glacial+l)*.5+.5)*o,m=(Math.cos(s*ge.glacial+l*.7)*.5+.5)*t;cn(e,u,m,3,5,ne.accents.pollen,0)}e.globalAlpha=1,e.restore()}var ka={leafParticles:tr(18)};function Et(e,n,r,o,t,a={}){let{time:s=0,growthLevel:i=0,intensity:l=1}=a;e.save(),e.translate(n,r),Zn(e,o,t),e.globalAlpha=.35*l;for(let u=0;u<6;u++){let m=o/6*u+Math.sin(s*ge.verySlow+u)*20,d=t*.3+(Math.random()*30-15);fn(e,m,d,12+Math.random()*8,q.foliage.shadow)}e.globalAlpha=1,e.globalAlpha=.6*l;for(let u=0;u<5;u++){let m=(Math.random()*.8+.1)*o,d=(Math.random()*.4+.2)*t;gn(e,m,d,6,8,q.foliage.mature,1.2)}e.globalAlpha=1,ar(ka.leafParticles,e,o,t,s),e.globalAlpha=.8*l,pn(e,o*.15,t*.4,t*.5,q.background.shadow,7),pn(e,o*.85,t*.35,t*.55,q.background.shadow,8),e.globalAlpha=1,e.strokeStyle=`rgba(200, 220, 230, ${.1*l})`,e.lineWidth=2,e.strokeRect(10,10,o-20,t-20),e.restore()}var Oa={dustMotes:or(55),pollenParticles:mn(15)};function zt(e,n,r,o,t,a={}){let{time:s=0,intensity:i=1}=a;e.save(),e.translate(n,r),Qn(e,o,t),e.globalAlpha=.25*i;for(let l=0;l<10;l++){let u=(Math.random()*.8+.1)*o,m=(Math.random()*.6+.1)*t;fn(e,u,m,15+Math.random()*10,U.garden.soft,8)}e.globalAlpha=1,sr(Oa.dustMotes,e,o,t,s),e.globalAlpha=.2*i,dr(e,o,t,.12),e.globalAlpha=1,e.globalAlpha=.15*i,ur(e,o,t,6),e.globalAlpha=1,e.globalAlpha=.3*i,mr(e,o,t,.25),e.globalAlpha=1,e.restore()}var Ia={particles:ir(75)};function Xt(e,n,r,o,t,a={}){let{time:s=0,growthLevel:i=0,intensity:l=1}=a;e.save(),e.translate(n,r),xn(e,o,t),e.globalAlpha=.7*l;for(let u=0;u<3;u++){let m=t/3*u+Math.sin(s*ge.verySlow+u)*20;ie(e,-10,m,60+u*20,.2+Math.random()*.3,2+u*.5,V.growth.vine,0,2)}for(let u=0;u<3;u++){let m=t/3*u+Math.cos(s*ge.verySlow+u*1.5)*20;ie(e,o+10,m,60+u*20,Math.PI-(.2+Math.random()*.3),2+u*.5,V.growth.vine,0,2)}for(let u=0;u<2;u++){let m=o/2.5*u+Math.sin(s*ge.verySlow+u*2)*20;ie(e,m,-10,50+u*15,Math.PI/2+(Math.random()-.5)*.4,1.5+u*.5,V.growth.vine,0,2)}e.globalAlpha=1,e.globalAlpha=.65*l;for(let u=0;u<40;u++){let m=Math.random()*o,d=Math.random()*t,b=3+Math.random()*6,h=Math.random()*Math.PI*2;Math.random()>.5?he(e,m,d,b,V.growth.leaf,h):hn(e,m,d,b,V.growth.wild,h)}e.globalAlpha=1,lr(Ia.particles,e,o,t,s),e.globalAlpha=.2*l,br(e,o,t,.15,30),e.globalAlpha=1,i>50&&(e.globalAlpha=.15*l,hr(e,o,t,2),e.globalAlpha=1),e.restore()}x("garden",{colors:dn,gradients:un,particles:bn,plants:vn,textures:Mn,recipes:gr});return Vt(Da);})();
