"use strict";var VisualToolkit=(()=>{var Pn=Object.defineProperty;var qt=Object.getOwnPropertyDescriptor;var Vt=Object.getOwnPropertyNames;var Ft=Object.prototype.hasOwnProperty;var X=(e,r)=>{for(var n in r)Pn(e,n,{get:r[n],enumerable:!0})},Nt=(e,r,n,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of Vt(r))!Ft.call(e,t)&&t!==n&&Pn(e,t,{get:()=>r[t],enumerable:!(o=qt(r,t))||o.enumerable});return e};var _t=e=>Nt(Pn({},"__esModule",{value:!0}),e);var Ba={};X(Ba,{amplitude:()=>ae,applyShadow:()=>Ir,bioGlow:()=>Ee,bioluminescence:()=>ie,bob:()=>vr,calculateDirectionalIllumination:()=>qr,calculateIllumination:()=>fe,clearShadow:()=>Or,createBioParticles:()=>Qe,createDeepParticles:()=>Ue,createEye:()=>In,createEyes:()=>_r,createMarineSnow:()=>je,createSeeker:()=>yr,createSeekerSwarm:()=>Cr,cssBioGlow:()=>Ve,cssBreathingGlow:()=>zr,cssCreatureBody:()=>Fe,cssDeepWater:()=>qe,cssDistantCreature:()=>_e,cssEyeGlow:()=>Ar,cssFishGlow:()=>Lr,cssGlow:()=>Dr,cssHudGlow:()=>Br,cssJellyfishBell:()=>Ne,cssJellyfishGlow:()=>Gr,cssTimings:()=>Pr,darkness:()=>Be,deepSea:()=>V,deepWaterBackground:()=>We,depthPresets:()=>Tn,drawBarnacles:()=>on,drawBioParticles:()=>xe,drawBiolumGlow:()=>$n,drawCaustics:()=>Nr,drawEye:()=>Dn,drawEyes:()=>Jr,drawGrille:()=>pe,drawJellyfish:()=>rn,drawLens:()=>Le,drawLight:()=>Ae,drawLightCone:()=>nn,drawMarineSnow:()=>Ke,drawOffsetShadow:()=>Tr,drawOrganicSurface:()=>an,drawOrganicTexture:()=>Fr,drawPanelLines:()=>De,drawPlayerLight:()=>Vr,drawROV:()=>en,drawScarring:()=>sn,drawSeeker:()=>kn,drawSeekerSwarm:()=>wr,drawSpecimen:()=>tn,drawTentacle:()=>Hr,drawTether:()=>Ge,drawTrackingEye:()=>Yr,drawWithDepth:()=>Er,drift:()=>fr,eyeGlow:()=>He,getTheme:()=>Qr,getThemeNames:()=>xr,hexToRgb:()=>Kr,lightBeam:()=>Ye,material3D:()=>Oe,materials:()=>H,organicRadii:()=>Xr,organicRadius:()=>Wr,playerLight:()=>Xe,pulse:()=>ce,radialGlow:()=>$r,randomBioHue:()=>ze,registerTheme:()=>ee,scenes:()=>Zr,staggerDelay:()=>Rr,surfacePalettes:()=>ne,themes:()=>et,timing:()=>x,updateDeepParticles:()=>Ze,updateEye:()=>On,updateEyes:()=>jr,updateMarineSnow:()=>Je,updateSeeker:()=>Ie,updateSeekerSwarm:()=>Sr,updateSeekerWithDrift:()=>Rn,vignette:()=>kr,waver:()=>Mr});var x={glacial:8e-4,verySlow:.001,slow:.002,medium:.003,fast:.005,rapid:.01},ae={micro:.02,small:.03,medium:.1,large:.3};function fr(e,r=x.verySlow,n=x.slow){return{x:Math.sin(e*r)*ae.micro+Math.sin(e*n)*ae.micro*.5,y:Math.cos(e*r*1.1)*ae.micro+Math.cos(e*n*.9)*ae.micro*.3,rotation:Math.sin(e*x.glacial)*ae.small}}function vr(e,r=x.slow,n=.02){return Math.sin(e*r)*n}function ce(e,r=x.medium,n=.8,o=1.2){let t=(Math.sin(e*r)+1)/2;return n+t*(o-n)}function Mr(e,r,n=x.slow){return{x:Math.sin(e*n+r*.5)*.5,y:Math.cos(e*n+r*.3)*.5}}function yr(e,r){return{x:Math.random()*e,y:Math.random()*r,vx:0,vy:0,size:2+Math.random()*6,maxSpeed:1+Math.random()*3,awareness:150+Math.random()*250,timidity:.3+Math.random()*.7,glow:0,hue:180+Math.random()*40}}function Ie(e,r,n,o,t,a){let i=r-e.x,s=n-e.y,l=Math.sqrt(i*i+s*s);l<e.awareness?o>15*e.timidity?(e.vx-=i/l*.5,e.vy-=s/l*.5,e.glow=Math.max(0,e.glow-.1)):l>40?(e.vx+=i/l*.08,e.vy+=s/l*.08,e.glow=Math.min(1,e.glow+.02)):(e.vx+=s/l*.1,e.vy-=i/l*.1,e.glow=1):(e.vx+=(Math.random()-.5)*.1,e.vy+=(Math.random()-.5)*.1,e.glow=Math.max(0,e.glow-.01));let d=Math.sqrt(e.vx*e.vx+e.vy*e.vy);d>e.maxSpeed&&(e.vx=e.vx/d*e.maxSpeed,e.vy=e.vy/d*e.maxSpeed),e.vx*=.98,e.vy*=.98,e.x+=e.vx,e.y+=e.vy,e.x<-50&&(e.x=t+50),e.x>t+50&&(e.x=-50),e.y<-50&&(e.y=a+50),e.y>a+50&&(e.y=-50)}function Cr(e,r,n,o={}){let{spawnBias:t="uniform",sizeRange:a=[2,8],speedRange:i=[1,4],hueRange:s=[180,220]}=o,l=[];for(let d=0;d<e;d++){let m,u;switch(t){case"center":{let b=Math.random()*Math.PI*2,h=Math.random()*Math.random()*Math.min(r,n)*.4;m=r/2+Math.cos(b)*h,u=n/2+Math.sin(b)*h;break}case"edges":{let b=Math.floor(Math.random()*4),h=Math.random();switch(b){case 0:m=h*r,u=Math.random()*50;break;case 1:m=r-Math.random()*50,u=h*n;break;case 2:m=h*r,u=n-Math.random()*50;break;default:m=Math.random()*50,u=h*n}break}default:m=Math.random()*r,u=Math.random()*n}l.push({x:m,y:u,vx:0,vy:0,size:a[0]+Math.random()*(a[1]-a[0]),maxSpeed:i[0]+Math.random()*(i[1]-i[0]),awareness:150+Math.random()*250,timidity:.3+Math.random()*.7,glow:0,hue:s[0]+Math.random()*(s[1]-s[0])})}return l}function Rn(e,r,n,o,t,a,i=0){if(Ie(e,r,n,o,t,a),i>0){let s=r-e.x,l=n-e.y;if(Math.sqrt(s*s+l*l)>e.awareness){let m=t/2,u=a/2,b=m-e.x,h=u-e.y,g=Math.sqrt(b*b+h*h);g>0&&(e.vx+=b/g*i,e.vy+=h/g*i)}}}function Sr(e,r,n,o,t,a,i=0){for(let s of e)i>0?Rn(s,r,n,o,t,a,i):Ie(s,r,n,o,t,a)}function $n(e,r,n,o,t,a,i){let s=i!==void 0?(Math.sin(i*.003)+1)/2:1,l=a*(.7+s*.3),d=o*(.9+s*.2),m=e.createRadialGradient(r,n,0,r,n,d*3);m.addColorStop(0,`hsla(${t}, 70%, 60%, ${l*.6})`),m.addColorStop(.5,`hsla(${t}, 60%, 40%, ${l*.2})`),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.arc(r,n,d*3,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${t}, 50%, 70%, ${l*.8})`,e.beginPath(),e.arc(r,n,d*.6,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${t}, 30%, 90%, ${l*.9})`,e.beginPath(),e.arc(r,n,d*.2,0,Math.PI*2),e.fill()}function kn(e,r,n=150,o,t,a){let i=r.glow;if(o!==void 0&&t!==void 0){let s=Math.sqrt((r.x-o)**2+(r.y-t)**2);s<n&&(i=Math.max(i,(1-s/n)*.8))}i<.05||$n(e,r.x,r.y,r.size,r.hue,i,a)}function wr(e,r,n={}){let{lightX:o,lightY:t,lightRadius:a=150,time:i}=n,s=[...r].sort((l,d)=>{let m=l.glow,u=d.glow;if(o!==void 0&&t!==void 0){let b=Math.sqrt((l.x-o)**2+(l.y-t)**2),h=Math.sqrt((d.x-o)**2+(d.y-t)**2);b<a&&(m=Math.max(m,(1-b/a)*.8)),h<a&&(u=Math.max(u,(1-h/a)*.8))}return m-u});for(let l of s)kn(e,l,a,o,t,i)}var Pr={pulse:"4s",drift:"8s",creature:"12s",ambient:"20s",glacial:"30s"};function Rr(e,r=.3){return`${e*r}s`}function Oe(e,r,n,o,t,a){let i=e.createLinearGradient(r,n,r,n+t);return i.addColorStop(0,a.highlight),i.addColorStop(.5,a.mid),i.addColorStop(1,a.shadow),i}function $r(e,r,n,o,t,a){let i=e.createRadialGradient(r,n,o,r,n,t);return i.addColorStop(0,a.core),i.addColorStop(.4,a.mid),i.addColorStop(.7,a.outer),i.addColorStop(1,"transparent"),i}function kr(e,r,n,o,t,a=.5){let i=e.createRadialGradient(r,n,o,r,n,t);return i.addColorStop(0,"transparent"),i.addColorStop(1,`rgba(0, 0, 0, ${a})`),i}function Tr(e,r,n=4,o=4,t="rgba(0, 0, 0, 0.4)"){e.save(),e.translate(n,o),e.fillStyle=t,r(),e.restore()}function Ir(e,r,n,o=0,t=0){e.shadowColor=n,e.shadowBlur=r,e.shadowOffsetX=o,e.shadowOffsetY=t}function Or(e){e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}function Dr(e,r="medium"){let n={subtle:[.3,.15],medium:[.6,.3],strong:[.9,.5]},[o,t]=n[r],a=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(!a)return"none";let[,i,s,l]=a;return`
    0 0 20px rgba(${i}, ${s}, ${l}, ${o}),
    0 0 40px rgba(${i}, ${s}, ${l}, ${t})
  `.trim()}function Gr(){return`
    0 0 20px rgba(150, 200, 255, 0.3),
    inset 0 -10px 20px rgba(100, 180, 255, 0.2)
  `.trim()}function Lr(){return`
    0 0 10px rgba(100, 200, 255, 0.5),
    0 0 20px rgba(80, 180, 255, 0.3)
  `.trim()}function Ar(){return`
    0 0 15px rgba(255, 100, 80, 0.6),
    0 0 30px rgba(255, 80, 60, 0.3)
  `.trim()}function Br(){return"0 0 10px rgba(77, 208, 225, 0.3)"}function zr(){return{dim:"0 0 10px rgba(77, 208, 225, 0.2)",bright:"0 0 25px rgba(77, 208, 225, 0.5)"}}var Tn={equipment:{shadowOffset:{x:4,y:4},shadowColor:"rgba(0, 0, 0, 0.4)",outlineWidth:2,outlineColor:"#8a5a15"},light:{shadowOffset:{x:2,y:2},shadowColor:"rgba(0, 0, 0, 0.3)",outlineWidth:1,outlineColor:"#cc4420"},creature:{shadowOffset:{x:0,y:0},shadowColor:"transparent",outlineWidth:0,outlineColor:"transparent"}};function Er(e,r,n,o){let t=Tn[r];(t.shadowOffset.x!==0||t.shadowOffset.y!==0)&&(e.save(),e.translate(t.shadowOffset.x,t.shadowOffset.y),e.fillStyle=t.shadowColor,n(),e.restore()),e.fillStyle=o,n(),t.outlineWidth>0&&(e.strokeStyle=t.outlineColor,e.lineWidth=t.outlineWidth,n(),e.stroke())}function Wr(){let e=[40+Math.random()*30,40+Math.random()*30,40+Math.random()*30,40+Math.random()*30];return`${e[0]}% ${e[1]}% ${e[2]}% ${e[3]}%`}var Xr={blob:"60% 50% 45% 55%",fish:"60% 40% 40% 60%",bell:"50% 50% 40% 40%",head:"55% 45% 50% 50%",tail:"30% 70% 60% 40%"};function De(e,r,n,o,t,a=[.25,.75],i="rgba(100, 60, 20, 0.5)"){e.strokeStyle=i,e.lineWidth=1;for(let s of a){let l=r+o*s;e.beginPath(),e.moveTo(l,n),e.lineTo(l,n+t),e.stroke()}}function pe(e,r,n,o,t,a=4,i="#555"){e.strokeStyle=i,e.lineWidth=2;let s=t/(a+1);for(let l=1;l<=a;l++){let d=n+s*l;e.beginPath(),e.moveTo(r,d),e.lineTo(r+o,d),e.stroke()}}function Ge(e,r,n,o,t,a,i=10,s="rgba(80, 80, 80, 0.6)"){e.strokeStyle=s,e.lineWidth=3,e.setLineDash([8,4]);let l=r+Math.sin(a*.002)*i;e.beginPath(),e.moveTo(r,n),e.lineTo(l,t),e.stroke(),e.setLineDash([])}function Le(e,r,n,o,t,a="#222",i="#1a1a2e",s="rgba(100, 150, 200, 0.5)"){e.fillStyle=a,e.beginPath(),e.arc(r,n,o,0,Math.PI*2),e.fill(),e.fillStyle=i,e.beginPath(),e.arc(r,n,t,0,Math.PI*2),e.fill(),e.fillStyle=s,e.beginPath(),e.arc(r-2,n-2,t*.4,0,Math.PI*2),e.fill()}function Ae(e,r,n,o,t,a){if(e.fillStyle="#444",e.beginPath(),e.arc(r,n,o,0,Math.PI*2),e.fill(),t){let i=.8+Math.sin(a*.005)*.1,s=e.createRadialGradient(r,n,0,r,n,o*8);s.addColorStop(0,`rgba(255, 250, 230, ${i})`),s.addColorStop(.2,`rgba(255, 240, 200, ${i*.5})`),s.addColorStop(1,"rgba(255, 240, 200, 0)"),e.fillStyle=s,e.beginPath(),e.arc(r,n,o*8,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(255, 255, 240, ${i})`,e.beginPath(),e.arc(r,n,o*.6,0,Math.PI*2),e.fill()}}function Yr(e,r,n,o,t,a,i=0){let s=30+i*30,l=e.createRadialGradient(r,n,0,r,n,s);l.addColorStop(0,`rgba(${180+i*75}, ${60+i*40}, ${60+i*20}, 0.8)`),l.addColorStop(.5,`rgba(${120+i*60}, 40, 40, 0.3)`),l.addColorStop(1,"transparent"),e.fillStyle=l,e.beginPath(),e.arc(r,n,s,0,Math.PI*2),e.fill();let d=o*(1+i*.5);e.fillStyle=`rgba(${200+i*55}, ${80+i*80}, ${60+i*40}, 1)`,e.beginPath(),e.arc(r,n,d,0,Math.PI*2),e.fill();let m=t-r,u=a-n,b=Math.sqrt(m*m+u*u),h=b>0?m/b*3:0,g=b>0?u/b*3:0;e.fillStyle="rgba(10, 0, 0, 1)",e.beginPath(),i>.4?e.ellipse(r+h,n+g,2,d*.7,0,0,Math.PI*2):e.arc(r+h,n+g,4-i*2,0,Math.PI*2),e.fill()}function Hr(e,r,n,o="rgba(10, 10, 15, 0.9)"){if(!(r.length<2)){e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let t=1;t<r.length;t++)e.lineTo(r[t].x,r[t].y);e.strokeStyle=o,e.lineWidth=n,e.lineCap="round",e.stroke()}}function fe(e,r,n,o,t=200){let a=e-n,i=r-o,s=Math.sqrt(a*a+i*i);if(s>=t)return 0;let l=1-s/t;return l*l}function qr(e,r,n,o,t,a=200){let i=fe(e,r,n,o,a);if(i===0)return 0;let s=e-n,l=r-o,d=Math.atan2(l,s),m=Math.abs(d-t),b=1-Math.min(m,Math.PI*2-m)/Math.PI;return i*(.3+b*.7)}function Vr(e,r,n,o=120,t={}){let{intensity:a=1,pulseTime:i,coreColor:s={r:255,g:255,b:255},ambientColor:l={r:180,g:220,b:255}}=t,d=i!==void 0?Math.sin(i*.003)*20:0,m=o+d;for(let b=5;b>=1;b--){let h=m*(b/2),g=.15/b*a,c=e.createRadialGradient(r,n,0,r,n,h);c.addColorStop(0,`rgba(${l.r}, ${l.g}, ${l.b}, ${g})`),c.addColorStop(.5,`rgba(${Math.round(l.r*.55)}, ${l.g}, ${Math.round(l.b*.85)}, ${g*.5})`),c.addColorStop(1,"transparent"),e.fillStyle=c,e.beginPath(),e.arc(r,n,h,0,Math.PI*2),e.fill()}let u=e.createRadialGradient(r,n,0,r,n,15);u.addColorStop(0,`rgba(${s.r}, ${s.g}, ${s.b}, ${.9*a})`),u.addColorStop(.5,`rgba(${Math.round(s.r*.8)}, ${Math.round(s.g*.94)}, ${s.b}, ${.5*a})`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.beginPath(),e.arc(r,n,15,0,Math.PI*2),e.fill()}function Fr(e,r,n,o={}){let{density:t=20,color:a={r:20,g:30,b:40},intensity:i=.15,time:s=0,seed:l=12345}=o,d=m=>{let u=Math.sin(l+m*127.1)*43758.5453;return u-Math.floor(u)};for(let m=0;m<t;m++){let u=d(m)*r,b=d(m+1e3)*n,h=s>0?Math.sin(s*8e-4+m*.5)*3:0,g=s>0?Math.cos(s*6e-4+m*.3)*2:0,c=u+h,v=b+g,f=30+d(m+2e3)*80,p=i*(.5+d(m+3e3)*.5),R=e.createRadialGradient(c,v,0,c,v,f);R.addColorStop(0,`rgba(${a.r}, ${a.g}, ${a.b}, ${p})`),R.addColorStop(.6,`rgba(${a.r}, ${a.g}, ${a.b}, ${p*.3})`),R.addColorStop(1,"transparent"),e.fillStyle=R,e.beginPath(),e.arc(c,v,f,0,Math.PI*2),e.fill()}}function Nr(e,r,n,o,t={}){let{count:a=5,heightRatio:i=.4,intensity:s=.03}=t;for(let l=0;l<a;l++){let d=(Math.sin(o*.001+l)*.3+.5)*r,m=n*.1,u=e.createRadialGradient(d,m,0,d,m,150);u.addColorStop(0,`rgba(100, 150, 200, ${s})`),u.addColorStop(1,"rgba(100, 150, 200, 0)"),e.fillStyle=u,e.fillRect(0,0,r,n*i)}}function In(e){return{x:e.x,y:e.y,size:e.size??8,openness:1,awarenessRadius:e.awarenessRadius??200,blinkTimer:2e3+Math.random()*3e3,isBlinking:!1,blinkProgress:0,dilation:.5,hue:e.hue??0,illumination:0,pupilOffset:{x:0,y:0}}}function On(e,r,n,o=16){e.illumination=fe(r,n,e.x,e.y,e.awarenessRadius);let t=r-e.x,a=n-e.y,i=Math.sqrt(t*t+a*a);if(i>0){let l=e.size*.3,d=t/i*l,m=a/i*l;e.pupilOffset.x+=(d-e.pupilOffset.x)*.1,e.pupilOffset.y+=(m-e.pupilOffset.y)*.1}let s=1-e.illumination*.8;e.dilation+=(s-e.dilation)*.05,e.isBlinking?(e.blinkProgress+=o/150,e.blinkProgress<.5?e.openness=1-e.blinkProgress*2:e.openness=(e.blinkProgress-.5)*2,e.blinkProgress>=1&&(e.isBlinking=!1,e.blinkProgress=0,e.openness=1,e.blinkTimer=2e3+Math.random()*4e3)):(e.blinkTimer-=o,e.blinkTimer<=0&&(e.isBlinking=!0,e.blinkProgress=0))}function Dn(e,r,n={}){let{showGlow:o=!0,glowSize:t=2.5}=n,a=r.size*r.openness;if(a<.5)return;let i=r.hue===0||r.hue<60?200:100,s=r.hue>30&&r.hue<90?150:50,l=r.hue>150?200:50,d=r.illumination*55,m=Math.min(255,i+d),u=Math.min(255,s+r.illumination*40),b=Math.min(255,l+r.illumination*20);if(o){let c=a*t+r.illumination*a,v=e.createRadialGradient(r.x,r.y,0,r.x,r.y,c);v.addColorStop(0,`rgba(${m}, ${u}, ${b}, ${.6+r.illumination*.2})`),v.addColorStop(.5,`rgba(${m*.6}, ${u*.6}, ${b*.6}, ${.2+r.illumination*.2})`),v.addColorStop(1,"transparent"),e.fillStyle=v,e.beginPath(),e.arc(r.x,r.y,c,0,Math.PI*2),e.fill()}e.fillStyle=`rgba(${m}, ${u}, ${b}, ${.8+r.illumination*.2})`,e.beginPath(),e.arc(r.x,r.y,a,0,Math.PI*2),e.fill();let h=r.x+r.pupilOffset.x,g=r.y+r.pupilOffset.y;if(e.fillStyle="rgba(10, 0, 0, 0.9)",e.beginPath(),r.illumination>.4){let c=2*r.dilation,v=a*.7;e.ellipse(h,g,c,v,0,0,Math.PI*2)}else{let c=2+r.dilation*2;e.arc(h,g,c,0,Math.PI*2)}e.fill(),r.openness>.5&&(e.fillStyle=`rgba(255, 255, 255, ${.3*r.openness})`,e.beginPath(),e.arc(r.x-a*.3,r.y-a*.3,a*.2,0,Math.PI*2),e.fill())}function _r(e){return e.map(In)}function jr(e,r,n,o=16){for(let t of e)On(t,r,n,o)}function Jr(e,r,n){for(let o of r)Dn(e,o,n)}function Kr(e){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:{r:0,g:0,b:0}}var ve=class{constructor(r){this.onFrame=r;this.animationId=null;this.frameCount=0;this.lastFrameTime=0;this.isRunning=!1;this.render=()=>{if(!this.isRunning)return;let r=performance.now(),n=r-this.lastFrameTime;this.lastFrameTime=r,this.onFrame(this.frameCount,n),this.frameCount++,this.animationId=requestAnimationFrame(this.render)}}start(){this.isRunning||(this.isRunning=!0,this.lastFrameTime=performance.now(),this.frameCount=0,this.render())}stop(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.isRunning=!1}reset(){this.frameCount=0,this.lastFrameTime=performance.now()}getFrameNum(){return this.frameCount}isRunning_(){return this.isRunning}};var Me=class{constructor(r){this.resizeObserver=null;this.canvas=r}startResizing(){if(this.resizeObserver)return;let r=this.handleResize.bind(this);this.resizeObserver=new ResizeObserver(r),this.handleResize(),this.resizeObserver.observe(this.canvas.parentElement)}stopResizing(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}registerResizeCallback(r){this.resizeCallback=r}getSize(){return{width:this.canvas.width,height:this.canvas.height}}getCenter(){return{x:this.canvas.width/2,y:this.canvas.height/2}}getBounds(){return this.canvas.getBoundingClientRect()}handleResize(){let r=this.canvas.getBoundingClientRect(),n=window.devicePixelRatio||1;this.canvas.width=r.width*n,this.canvas.height=r.height*n;let o=this.canvas.getContext("2d");o&&o.scale(n,n),this.resizeCallback&&this.resizeCallback()}};var ye=class{constructor(r){this.pos={x:-1e3,y:-1e3,angle:0,distance:0,isOver:!1};this.centerX=0;this.centerY=0;this.onMouseMove=this.handleMouseMove.bind(this);this.onMouseLeave=this.handleMouseLeave.bind(this);this.onMouseEnter=this.handleMouseEnter.bind(this);this.canvas=r,this.updateCenter()}startTracking(){this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseleave",this.onMouseLeave),this.canvas.addEventListener("mouseenter",this.onMouseEnter)}stopTracking(){this.canvas.removeEventListener("mousemove",this.onMouseMove),this.canvas.removeEventListener("mouseleave",this.onMouseLeave),this.canvas.removeEventListener("mouseenter",this.onMouseEnter)}getPosition(){return{...this.pos}}isOver(){return this.pos.isOver}updateCenter(){this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2}handleMouseMove(r){let n=this.canvas.getBoundingClientRect(),o=(r.clientX-n.left)*(this.canvas.width/n.width),t=(r.clientY-n.top)*(this.canvas.height/n.height);this.pos.x=o,this.pos.y=t;let a=o-this.centerX,i=t-this.centerY;this.pos.distance=Math.sqrt(a*a+i*i),this.pos.angle=Math.atan2(i,a)*(180/Math.PI),this.pos.angle<0&&(this.pos.angle+=360),this.pos.isOver=!0}handleMouseLeave(){this.pos.x=-1e3,this.pos.y=-1e3,this.pos.isOver=!1}handleMouseEnter(){this.pos.isOver=!0}};var _=class{constructor(){this.frameNum=0;this.deltaTime=0}async init(r,n){this.canvas=r,this.ctx=r.getContext("2d"),this.config={...this.defaultConfig,...n},this.responsiveCanvas=new Me(r),this.responsiveCanvas.registerResizeCallback(()=>this.onCanvasResize()),this.responsiveCanvas.startResizing(),this.animationLoop=new ve((o,t)=>{this.frameNum=o,this.deltaTime=t,this.render(this.ctx,t),this.config.onFrame&&this.config.onFrame(o,t)}),await this.onInit(),this.animationLoop.start()}cleanup(){this.animationLoop?.stop(),this.responsiveCanvas?.stopResizing(),this.cursorManager?.stopTracking(),this.onCleanup()}async onInit(){}onCanvasResize(){}onCleanup(){}startCursorTracking(){if(this.cursorManager||(this.cursorManager=new ye(this.canvas)),this.cursorManager.startTracking(),this.responsiveCanvas){let r=this.onCanvasResize.bind(this),n=()=>{this.cursorManager?.updateCenter(),r()};this.onCanvasResize=n}}getCursorPos(){return this.cursorManager?.getPosition()??{x:-1e3,y:-1e3,angle:0,distance:0,isOver:!1}}getCanvasSize(){return this.responsiveCanvas?.getSize()??{width:this.canvas.width,height:this.canvas.height}}getCanvasCenter(){return this.responsiveCanvas?.getCenter()??{x:this.canvas.width/2,y:this.canvas.height/2}}};var Ce=class extends _{constructor(){super(...arguments);this.name="Shadows";this.description="Jellyfish-like creatures drifting in the deep";this.defaultConfig={intensity:.5,scale:1,duration:1/0};this.shadows=[];this.particles=[];this.time=0;this.lastW=0;this.lastH=0}async onInit(){this.startCursorTracking(),this.initializeParticles(),this.resizeShadows()}onCanvasResize(){let{width:n,height:o}=this.getCanvasSize();(this.shadows.length===0||Math.abs(n-this.lastW)>20||Math.abs(o-this.lastH)>20)&&this.resizeShadows()}onCleanup(){this.shadows=[],this.particles=[]}render(n,o){let{width:t,height:a}=this.getCanvasSize(),i=n.createLinearGradient(0,0,0,a);i.addColorStop(0,"#020911"),i.addColorStop(.5,"#010508"),i.addColorStop(1,"#000305"),n.fillStyle=i,n.fillRect(0,0,t,a),this.updateAndDrawShadows(n,t,a),this.drawLightSource(n,t,a),this.drawMarineSnow(n,t,a),this.drawVignette(n,t,a),this.time+=16}initializeParticles(){this.particles=[];for(let n=0;n<10;n++)this.particles.push({x:Math.random(),y:Math.random(),size:.5+Math.random()*1.5,speed:5e-4+Math.random()*.001,alpha:.1+Math.random()*.2})}resizeShadows(){let{width:n,height:o}=this.getCanvasSize();this.shadows=[];let t=4+Math.floor(Math.random()*4);for(let a=0;a<t;a++)this.shadows.push({x:Math.random()*n,y:Math.random()*o,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*1.5-.5,size:60+Math.random()*80,bellSize:40+Math.random()*50,tentacleCount:5+Math.floor(Math.random()*4),angle:Math.random()*Math.PI*2,angleSpeed:(Math.random()-.5)*.03,pulsePhase:Math.random()*Math.PI*2,pulseSpeed:.5+Math.random()*.5,timeOffset:Math.random()*1e3});this.lastW=n,this.lastH=o}updateAndDrawShadows(n,o,t){let a=this.getCursorPos();for(let i of this.shadows){i.x+=i.vx,i.y+=i.vy,i.angle+=i.angleSpeed,i.pulsePhase+=i.pulseSpeed*.01,Math.random()<.01&&(i.vx+=(Math.random()-.5)*.5,i.vy+=(Math.random()-.5)*.3),i.x<-i.size*2&&(i.x=o+i.size),i.x>o+i.size*2&&(i.x=-i.size),i.y<-i.size*2&&(i.y=t+i.size),i.y>t+i.size*2&&(i.y=-i.size);let s=Math.sqrt(i.vx**2+i.vy**2);s>3&&(i.vx=i.vx/s*3,i.vy=i.vy/s*3),i.vx*=.995,i.vy*=.995}for(let i of this.shadows){n.save();let s=this.time*.001+i.timeOffset,l=Math.sin(i.pulsePhase)*.15+1,d=i.bellSize*l;n.translate(i.x,i.y),n.rotate(i.angle),n.beginPath();let m=12;for(let c=0;c<=m;c++){let v=c/m*Math.PI*2,f=d*(.7+Math.sin(v*3+s)*.1),p=Math.cos(v)*f,R=Math.sin(v)*f-d*.3;c===0?n.moveTo(p,R):n.lineTo(p,R)}n.closePath();let u=this.calculateIllumination(i.x,i.y,a),h=.8+u*.08;n.fillStyle=`rgba(5, 3, 8, ${h})`,n.shadowBlur=12,n.shadowColor="rgba(0, 0, 0, 0.4)",n.fill();let g=i.size*1.5;for(let c=0;c<i.tentacleCount;c++){let v=c/i.tentacleCount*Math.PI*2,f=Math.cos(v)*d*.6,p=Math.sin(v)*d*.3,R=8;n.beginPath(),n.moveTo(f,p);for(let $=1;$<=R;$++){let P=$/R,D=f+Math.sin(s*1.5+c+P*2)*d*.15,S=p+P*g+Math.sin(s*2+c*2+P*3)*d*.1;n.lineTo(D,S)}let M=.8+u*.08;n.strokeStyle=`rgba(5, 3, 8, ${M})`,n.lineWidth=d*.1,n.lineCap="round",n.lineJoin="round",n.shadowBlur=6,n.shadowColor="rgba(0, 0, 0, 0.3)",n.stroke()}n.restore()}}calculateIllumination(n,o,t){if(!t.isOver)return 0;let a=n-t.x,i=o-t.y,s=a*a+i*i,l=200,d=l*l;return s<d?Math.pow(1-Math.sqrt(s)/l,2.5):0}drawLightSource(n,o,t){let a=this.getCursorPos();if(!a.isOver)return;let i=n.createRadialGradient(a.x,a.y,0,a.x,a.y,200);i.addColorStop(0,"rgba(200, 240, 255, 0.15)"),i.addColorStop(.5,"rgba(150, 200, 255, 0.08)"),i.addColorStop(1,"transparent"),n.fillStyle=i,n.beginPath(),n.arc(a.x,a.y,200,0,Math.PI*2),n.fill();let s=n.createRadialGradient(a.x,a.y,0,a.x,a.y,16);s.addColorStop(0,"rgba(255, 255, 255, 0.9)"),s.addColorStop(.6,"rgba(220, 240, 255, 0.5)"),s.addColorStop(1,"transparent"),n.fillStyle=s,n.beginPath(),n.arc(a.x,a.y,16,0,Math.PI*2),n.fill()}drawMarineSnow(n,o,t){for(let a of this.particles)a.y+=a.speed,a.x+=Math.sin(this.time*.001+a.y*5)*3e-4,a.y>1.05&&(a.y=-.05,a.x=Math.random()),n.fillStyle=`rgba(150, 180, 200, ${a.alpha})`,n.beginPath(),n.arc(a.x*o,a.y*t,a.size,0,Math.PI*2),n.fill()}drawVignette(n,o,t){let a=n.createRadialGradient(o/2,t/2,t*.25,o/2,t/2,t*.85);a.addColorStop(0,"transparent"),a.addColorStop(1,"rgba(0, 0, 0, 0.4)"),n.fillStyle=a,n.fillRect(0,0,o,t)}},to=new Ce;var Se=class extends _{constructor(){super(...arguments);this.name="Seekers";this.description="Bioluminescent swarm responding to light";this.defaultConfig={intensity:.7,scale:1,duration:1/0};this.seekers=[];this.particles=[];this.time=0}async onInit(){this.startCursorTracking(),this.initializeParticles(),this.resizeSeekersSwarm()}onCanvasResize(){let{width:n,height:o}=this.getCanvasSize();this.seekers.length===0&&this.resizeSeekersSwarm()}onCleanup(){this.seekers=[],this.particles=[]}initializeParticles(){this.particles=[];for(let n=0;n<30;n++)this.particles.push({x:Math.random(),y:Math.random(),size:.5+Math.random()*1.5,speed:5e-4+Math.random()*.001,alpha:.1+Math.random()*.2})}resizeSeekersSwarm(){let{width:n,height:o}=this.getCanvasSize();this.seekers=[];for(let t=0;t<50;t++){let a=Math.random()*Math.PI*2,i=Math.random()*Math.random()*100,s=n/2+Math.cos(a)*i,l=o/2+Math.sin(a)*i;s=Math.max(0,Math.min(n,s)),l=Math.max(0,Math.min(o,l)),this.seekers.push({x:s,y:l,vx:(Math.random()-.5)*2,vy:(Math.random()-.5)*2,size:3+Math.random()*5,brightness:.4+Math.random()*.4,bodyHue:190+Math.random()*20})}}render(n,o){let{width:t,height:a}=this.getCanvasSize(),i=this.getCursorPos(),s=n.createLinearGradient(0,0,0,a);s.addColorStop(0,"#020810"),s.addColorStop(.5,"#010508"),s.addColorStop(1,"#000305"),n.fillStyle=s,n.fillRect(0,0,t,a);let l=Math.sqrt((i.x-(i.x-o*.1))**2+(i.y-(i.y-o*.1))**2);for(let u of this.seekers){let b=i.x-u.x,h=i.y-u.y,g=Math.sqrt(b*b+h*h);if(i.isOver&&g<300){let p=Math.atan2(h,b),R=Math.max(0,1-g/300)*.15;u.vx+=Math.cos(p)*R,u.vy+=Math.sin(p)*R}else u.vx+=(Math.random()-.5)*.05,u.vy+=(Math.random()-.5)*.05;let c=t/2-u.x,v=a/2-u.y,f=Math.sqrt(c*c+v*v);if(f>200){let p=Math.atan2(v,c),R=Math.max(0,(f-200)/200)*.02;u.vx+=Math.cos(p)*R,u.vy+=Math.sin(p)*R}u.x+=u.vx,u.y+=u.vy,u.vx*=.98,u.vy*=.98,u.x<-10&&(u.x=t+10),u.x>t+10&&(u.x=-10),u.y<-10&&(u.y=a+10),u.y>a+10&&(u.y=-10)}let d=[...this.seekers].sort((u,b)=>u.y-b.y);for(let u of d){let b=i.x-u.x,h=i.y-u.y,g=Math.sqrt(b*b+h*h),c=u.brightness;i.isOver&&g<300&&(c=.6+Math.max(0,1-g/300)*.4);let v=u.size*3,f=n.createRadialGradient(u.x,u.y,0,u.x,u.y,v);f.addColorStop(0,`hsla(${u.bodyHue}, 100%, 60%, ${c*.6})`),f.addColorStop(.5,`hsla(${u.bodyHue}, 100%, 50%, ${c*.2})`),f.addColorStop(1,"transparent"),n.fillStyle=f,n.beginPath(),n.arc(u.x,u.y,v,0,Math.PI*2),n.fill(),n.fillStyle=`hsla(${u.bodyHue}, 100%, 50%, ${c})`,n.beginPath(),n.arc(u.x,u.y,u.size,0,Math.PI*2),n.fill(),n.fillStyle=`hsla(${u.bodyHue}, 100%, 70%, ${c*.8})`,n.beginPath(),n.arc(u.x,u.y,u.size*.5,0,Math.PI*2),n.fill()}for(let u of this.particles)u.y+=u.speed,u.x+=Math.sin(this.time*.001+u.y*5)*3e-4,u.y>1.05&&(u.y=-.05,u.x=Math.random()),n.fillStyle=`rgba(150, 180, 200, ${u.alpha})`,n.beginPath(),n.arc(u.x*t,u.y*a,u.size,0,Math.PI*2),n.fill();if(i.isOver&&i.x>0&&i.x<t){for(let b=3;b>=1;b--){let h=100*(b/2),g=.08/b,c=n.createRadialGradient(i.x,i.y,0,i.x,i.y,h);c.addColorStop(0,`rgba(180, 220, 255, ${g})`),c.addColorStop(.5,`rgba(100, 180, 220, ${g*.5})`),c.addColorStop(1,"transparent"),n.fillStyle=c,n.beginPath(),n.arc(i.x,i.y,h,0,Math.PI*2),n.fill()}let u=n.createRadialGradient(i.x,i.y,0,i.x,i.y,10);u.addColorStop(0,"rgba(255, 255, 255, 0.7)"),u.addColorStop(.5,"rgba(200, 240, 255, 0.3)"),u.addColorStop(1,"transparent"),n.fillStyle=u,n.beginPath(),n.arc(i.x,i.y,10,0,Math.PI*2),n.fill()}let m=n.createRadialGradient(t/2,a/2,a*.3,t/2,a/2,a*.85);m.addColorStop(0,"transparent"),m.addColorStop(1,"rgba(0, 0, 0, 0.5)"),n.fillStyle=m,n.fillRect(0,0,t,a),this.time+=16}},io=new Se;var we=class extends _{constructor(){super(...arguments);this.name="Giant Squid";this.description="Encounter with massive cephalopod";this.defaultConfig={intensity:.8,scale:1,duration:1/0};this.particles=[];this.tentacle={progress:0,yCenter:.5,thickness:120,phase:0};this.time=0}async onInit(){this.startCursorTracking(),this.initializeParticles()}onCanvasResize(){}onCleanup(){this.particles=[]}initializeParticles(){this.particles=[];for(let n=0;n<40;n++)this.particles.push({x:Math.random(),y:Math.random(),size:Math.random()*2+.5,speed:Math.random()*3e-4+1e-4,drift:Math.random()*2e-4-1e-4,alpha:Math.random()*.3+.1})}drawMassiveTentacle(n,o,t){let a=-o*.3+this.tentacle.progress*o*1.6,i=this.time*8e-4,s=50,l=[];for(let d=0;d<=s;d++){let m=d/s,u=a-m*o*.8,b=t*this.tentacle.yCenter,h=Math.sin(i+m*3)*t*.15,g=Math.sin(i*.3+m*1.5)*t*.08,c=b+h+g,v=this.tentacle.thickness*(1-m*.6);l.push({x:u,y:c,thickness:v})}n.lineCap="round",n.lineJoin="round";for(let d=1;d<l.length;d++){let m=l[d-1],u=l[d];if(m.x<-100&&u.x<-100||m.x>o+100&&u.x>o+100)continue;let b=d/l.length,h=70+b*30,g=20+b*15,c=35+b*15;n.strokeStyle=`rgb(${h}, ${g}, ${c})`,n.lineWidth=(m.thickness+u.thickness)/2,n.beginPath(),n.moveTo(m.x,m.y),n.lineTo(u.x,u.y),n.stroke()}for(let d=2;d<l.length-2;d+=3){let m=l[d];if(m.x<-50||m.x>o+50)continue;let u=m.thickness*.25,b=l[d+1].x-l[d-1].x,h=l[d+1].y-l[d-1].y,g=Math.atan2(h,b)+Math.PI/2,c=m.x+Math.cos(g)*m.thickness*.35,v=m.y+Math.sin(g)*m.thickness*.35;n.beginPath(),n.arc(c,v,u,0,Math.PI*2),n.fillStyle="rgba(50, 15, 25, 0.9)",n.fill(),n.beginPath(),n.arc(c,v,u*.5,0,Math.PI*2),n.fillStyle="rgba(20, 5, 10, 0.95)",n.fill(),n.beginPath(),n.arc(c,v,u*.8,0,Math.PI*2),n.strokeStyle="rgba(100, 40, 50, 0.4)",n.lineWidth=2,n.stroke()}for(let d=5;d<l.length-5;d+=8){let m=l[d];if(m.x<0||m.x>o)continue;let u=this.time*.002+d*.3,b=Math.sin(u)*.5+.5,h=4+b*3,g=.3+b*.4;n.beginPath(),n.arc(m.x,m.y,h,0,Math.PI*2),n.fillStyle=`rgba(80, 180, 220, ${g})`,n.fill();let c=n.createRadialGradient(m.x,m.y,0,m.x,m.y,h*4);c.addColorStop(0,`rgba(80, 180, 220, ${g*.4})`),c.addColorStop(1,"rgba(80, 180, 220, 0)"),n.fillStyle=c,n.beginPath(),n.arc(m.x,m.y,h*4,0,Math.PI*2),n.fill()}n.strokeStyle="rgba(40, 10, 20, 0.3)",n.lineWidth=1;for(let d=4;d<l.length-4;d+=6){let m=l[d];if(m.x<0||m.x>o)continue;let u=l[d+1].x-l[d-1].x,b=l[d+1].y-l[d-1].y,h=Math.atan2(b,u)+Math.PI/2;n.beginPath(),n.moveTo(m.x+Math.cos(h)*m.thickness*.4,m.y+Math.sin(h)*m.thickness*.4),n.lineTo(m.x-Math.cos(h)*m.thickness*.4,m.y-Math.sin(h)*m.thickness*.4),n.stroke()}}render(n,o){let{width:t,height:a}=this.getCanvasSize(),i=this.getCursorPos();n.fillStyle="#020306",n.fillRect(0,0,t,a);let s=n.createLinearGradient(0,0,0,a);s.addColorStop(0,"rgba(5, 15, 30, 0.4)"),s.addColorStop(1,"rgba(0, 5, 15, 0.2)"),n.fillStyle=s,n.fillRect(0,0,t,a);for(let d of this.particles)d.y-=d.speed,d.x+=d.drift,d.y<-.05&&(d.y=1.05,d.x=Math.random()),n.beginPath(),n.arc(d.x*t,d.y*a,d.size,0,Math.PI*2),n.fillStyle=`rgba(150, 180, 200, ${d.alpha})`,n.fill();if(i.isOver&&i.x>0&&i.x<t){let d=n.createRadialGradient(i.x,i.y,0,i.x,i.y,180);d.addColorStop(0,"rgba(200, 220, 255, 0.12)"),d.addColorStop(.5,"rgba(150, 180, 220, 0.04)"),d.addColorStop(1,"rgba(100, 150, 200, 0)"),n.fillStyle=d,n.beginPath(),n.arc(i.x,i.y,180,0,Math.PI*2),n.fill()}this.time>1e3&&(this.tentacle.progress=Math.min((this.time-1e3)/12e3,1.2)),this.drawMassiveTentacle(n,t,a);let l=n.createRadialGradient(t/2,a/2,a*.2,t/2,a/2,a*.9);l.addColorStop(0,"rgba(0, 0, 0, 0)"),l.addColorStop(1,"rgba(0, 0, 0, 0.7)"),n.fillStyle=l,n.fillRect(0,0,t,a),this.time+=16}},uo=new we;var Pe=class extends _{constructor(){super(...arguments);this.name="ROV Exterior";this.description="External camera - ROV Nereid descent";this.defaultConfig={intensity:.7,duration:1/0};this.time=0;this.particles=[];this.timing={glacial:8e-4,verySlow:.001,slow:.002};this.deepSea={surface:"#020810",mid:"#051018",deep:"#020a12",abyss:"#010508"};this.materials={rovYellow:{highlight:"#e8a832",mid:"#d4942a",shadow:"#b87820",outline:"#8a5a15"},flotation:{fill:"#ff6b35",outline:"#cc4420"},metal:{light:"#666",mid:"#444",dark:"#333",darkest:"#222"},lens:{body:"#1a1a2e",glint:"rgba(100, 150, 200, 0.5)"},panel:{line:"rgba(100, 60, 20, 0.5)"}};this.rov={x:.5,y:.45}}async onInit(){this.particles=[];for(let n=0;n<80;n++)this.particles.push({x:Math.random(),y:Math.random(),size:Math.random()*2+.5,speed:Math.random()*.008+.003,alpha:Math.random()*.5+.2})}onCanvasResize(){}render(n,o){let t=this.canvas.width/window.devicePixelRatio,a=this.canvas.height/window.devicePixelRatio,i=n.createLinearGradient(0,0,0,a);i.addColorStop(0,this.deepSea.surface),i.addColorStop(.3,this.deepSea.mid),i.addColorStop(.6,this.deepSea.deep),i.addColorStop(1,this.deepSea.abyss),n.fillStyle=i,n.fillRect(0,0,t,a);for(let b=0;b<3;b++){let h=(Math.sin(this.time*this.timing.glacial+b)*.3+.5)*t,g=n.createRadialGradient(h,a*.1,0,h,a*.1,150);g.addColorStop(0,"rgba(100, 150, 200, 0.03)"),g.addColorStop(1,"transparent"),n.fillStyle=g,n.fillRect(0,0,t,a*.4)}for(let b of this.particles)b.y-=b.speed,b.y<-.05&&(b.y=1.05,b.x=Math.random()),n.beginPath(),n.arc(b.x*t,b.y*a,b.size,0,Math.PI*2),n.fillStyle=`rgba(180, 200, 220, ${b.alpha})`,n.fill();let s=this.drift(this.time),l=(this.rov.x+s.x)*t,d=(this.rov.y+s.y)*a;this.drawROV(n,l,d,1.2),n.save(),n.translate(l,d),n.rotate(s.rotation);let m=n.createLinearGradient(0,50,0,a*.6);m.addColorStop(0,"rgba(255, 250, 230, 0.15)"),m.addColorStop(.5,"rgba(200, 220, 255, 0.05)"),m.addColorStop(1,"transparent"),n.fillStyle=m,n.beginPath(),n.moveTo(-35,50),n.lineTo(-80,a*.5),n.lineTo(80,a*.5),n.lineTo(35,50),n.closePath(),n.fill(),n.restore();let u=n.createRadialGradient(t/2,a/2,a*.3,t/2,a/2,a*.8);u.addColorStop(0,"transparent"),u.addColorStop(1,"rgba(0, 0, 0, 0.5)"),n.fillStyle=u,n.fillRect(0,0,t,a),this.time+=16}onCleanup(){}drift(n){return{x:Math.sin(n*this.timing.verySlow)*.02+Math.sin(n*this.timing.slow)*.01,y:Math.cos(n*this.timing.verySlow*1.1)*.02+Math.cos(n*this.timing.slow*.9)*.006,rotation:Math.sin(n*this.timing.glacial)*.03}}material3D(n,o,t,a,i,s){let l=n.createLinearGradient(o,t,o,t+i);return l.addColorStop(0,s.highlight),l.addColorStop(.5,s.mid),l.addColorStop(1,s.shadow),l}drawPanelLines(n,o,t,a,i,s){n.strokeStyle=this.materials.panel.line,n.lineWidth=1;for(let l of s){let d=o+a*l;n.beginPath(),n.moveTo(d,t),n.lineTo(d,t+i),n.stroke()}}drawGrille(n,o,t,a,i,s){n.strokeStyle=this.materials.metal.light,n.lineWidth=2;let l=i/(s+1);for(let d=1;d<=s;d++){let m=t+l*d;n.beginPath(),n.moveTo(o,m),n.lineTo(o+a,m),n.stroke()}}drawLens(n,o,t,a,i){n.fillStyle=this.materials.metal.darkest,n.beginPath(),n.arc(o,t,a,0,Math.PI*2),n.fill(),n.fillStyle=this.materials.lens.body,n.beginPath(),n.arc(o,t,i,0,Math.PI*2),n.fill(),n.fillStyle=this.materials.lens.glint,n.beginPath(),n.arc(o-2,t-2,i*.4,0,Math.PI*2),n.fill()}drawLight(n,o,t,a,i){if(n.fillStyle=this.materials.metal.mid,n.beginPath(),n.arc(o,t,a,0,Math.PI*2),n.fill(),i){let s=.8+Math.sin(this.time*this.timing.slow)*.1,l=n.createRadialGradient(o,t,0,o,t,a*8);l.addColorStop(0,`rgba(255, 250, 230, ${s})`),l.addColorStop(.2,`rgba(255, 240, 200, ${s*.5})`),l.addColorStop(1,"rgba(255, 240, 200, 0)"),n.fillStyle=l,n.beginPath(),n.arc(o,t,a*8,0,Math.PI*2),n.fill(),n.fillStyle=`rgba(255, 255, 240, ${s})`,n.beginPath(),n.arc(o,t,a*.6,0,Math.PI*2),n.fill()}}drawTether(n,o,t,a,i){n.strokeStyle="rgba(80, 80, 80, 0.6)",n.lineWidth=3,n.setLineDash([8,4]);let s=o+Math.sin(this.time*this.timing.slow)*i;n.beginPath(),n.moveTo(o,t),n.lineTo(s,a),n.stroke(),n.setLineDash([])}drawROV(n,o,t,a){n.save(),n.translate(o,t);let i=this.drift(this.time);n.rotate(i.rotation),n.scale(a,a);let s=80,l=50;n.fillStyle="rgba(0, 0, 0, 0.4)",n.fillRect(-s/2+4,-l/2+4,s,l),n.fillStyle=this.material3D(n,-s/2,-l/2,s,l,this.materials.rovYellow),n.fillRect(-s/2,-l/2,s,l),n.strokeStyle=this.materials.rovYellow.outline,n.lineWidth=2,n.strokeRect(-s/2,-l/2,s,l),this.drawPanelLines(n,-s/2,-l/2,s,l,[.25,.75]),n.fillStyle=this.materials.flotation.fill,n.fillRect(-s/2+5,-l/2-15,s-10,15),n.strokeStyle=this.materials.flotation.outline,n.strokeRect(-s/2+5,-l/2-15,s-10,15),n.fillStyle=this.materials.metal.dark,n.fillRect(-s/2-15,-10,15,20),n.fillRect(s/2,-10,15,20),this.drawGrille(n,-s/2-15,-10,15,20,4),this.drawGrille(n,s/2,-10,15,20,4),this.drawLens(n,0,l/2+10,12,8),this.drawLight(n,-25,l/2+5,8,!0),this.drawLight(n,25,l/2+5,8,!0),n.strokeStyle=this.materials.metal.light,n.lineWidth=4,n.lineCap="round",n.beginPath(),n.moveTo(-s/2+10,l/2),n.lineTo(-s/2+5,l/2+20),n.lineTo(-s/2+15,l/2+25),n.stroke(),this.drawTether(n,0,-l/2-15,-l/2-100,10),n.restore()}},ho=new Pe;var jt=new Ce,Jt=new Se,Kt=new we,Ut=new Pe,Ur={shadows:jt,seekers:Jt,giantSquid:Kt,rovExterior:Ut};var Zr={deepSea:Ur};var oe={};function ee(e,r){oe[e]&&console.warn(`Theme "${e}" is already registered. Overwriting.`),oe[e]=r}function Qr(e){return oe[e]}function xr(){return Object.keys(oe)}var et=new Proxy({},{get(e,r){if(typeof r=="string")return oe[r]},ownKeys(){return Object.keys(oe)},has(e,r){return r in oe}});var Gn={};X(Gn,{bioGlow:()=>Ee,bioluminescence:()=>ie,darkness:()=>Be,deepSea:()=>V,materials:()=>H,randomBioHue:()=>ze});var V={background:{surface:"#020810",mid:"#051018",deep:"#020a12",abyss:"#010508",void:"#000000"},water:{ambient:"rgba(100, 150, 200, 0.03)",light:"rgba(180, 200, 220, 0.4)",particleDim:"rgba(180, 200, 230, 0.3)"},hud:{text:"rgba(77, 208, 225, 0.5)",recording:"rgba(255, 150, 100, 0.7)"}},ie={cyan:{core:"rgba(100, 200, 255, 0.9)",mid:"rgba(80, 180, 255, 0.5)",outer:"rgba(60, 150, 255, 0.2)",halo:"rgba(77, 208, 225, 0.5)"},warm:{core:"rgba(255, 100, 80, 0.8)",mid:"rgba(255, 80, 60, 0.4)",outer:"rgba(200, 50, 50, 0.3)"},playerLight:{core:"rgba(255, 255, 255, 0.9)",inner:"rgba(200, 240, 255, 0.5)",mid:"rgba(180, 220, 255, 0.15)",ambient:"rgba(100, 180, 220, 0.1)"},hueRange:{min:180,max:220}},H={rovYellow:{highlight:"#e8a832",mid:"#d4942a",shadow:"#b87820",outline:"#8a5a15"},flotation:{fill:"#ff6b35",outline:"#cc4420"},metal:{light:"#666666",mid:"#444444",dark:"#333333",darkest:"#222222"},lens:{body:"#1a1a2e",glint:"rgba(100, 150, 200, 0.5)"},panel:{line:"rgba(100, 60, 20, 0.5)",shadow:"rgba(0, 0, 0, 0.4)"},creatureFlesh:e=>({r:15+e*25,g:12+e*18,b:20+e*25})},Be={true:"#000000",soft:"#010508",tendril:"rgba(10, 10, 15, 0.9)",vignette:"rgba(0, 0, 0, 0.4)",shadow:"rgba(0, 0, 0, 0.4)"};function ze(){let{min:e,max:r}=ie.hueRange;return e+Math.random()*(r-e)}function Ee(e,r=70,n=60,o=.6){return`hsla(${e}, ${r}%, ${n}%, ${o})`}var Ln={};X(Ln,{cssBioGlow:()=>Ve,cssCreatureBody:()=>Fe,cssDeepWater:()=>qe,cssDistantCreature:()=>_e,cssJellyfishBell:()=>Ne,deepWaterBackground:()=>We,eyeGlow:()=>He,lightBeam:()=>Ye,playerLight:()=>Xe});function We(e,r){let n=e.createLinearGradient(0,0,0,r);return n.addColorStop(0,V.background.surface),n.addColorStop(.3,V.background.mid),n.addColorStop(.6,V.background.deep),n.addColorStop(1,V.background.abyss),n}function Xe(e,r,n,o,t=1){let a=[];for(let s=5;s>=1;s--){let l=o*(s/2),d=.15/s*t,m=e.createRadialGradient(r,n,0,r,n,l);m.addColorStop(0,`rgba(180, 220, 255, ${d})`),m.addColorStop(.5,`rgba(100, 180, 220, ${d*.5})`),m.addColorStop(1,"transparent"),a.push(m)}let i=e.createRadialGradient(r,n,0,r,n,15);return i.addColorStop(0,`rgba(255, 255, 255, ${.9*t})`),i.addColorStop(.5,`rgba(200, 240, 255, ${.5*t})`),i.addColorStop(1,"transparent"),a.push(i),a}function Ye(e,r,n){let o=e.createLinearGradient(0,r,0,n);return o.addColorStop(0,"rgba(255, 250, 230, 0.15)"),o.addColorStop(.5,"rgba(200, 220, 255, 0.05)"),o.addColorStop(1,"rgba(200, 220, 255, 0)"),o}function He(e,r,n,o,t=0){let a=e.createRadialGradient(r,n,0,r,n,o),i=180+t*75,s=60+t*40,l=60+t*20;return a.addColorStop(0,`rgba(${i}, ${s}, ${l}, 0.8)`),a.addColorStop(.5,`rgba(${120+t*60}, 40, 40, 0.3)`),a.addColorStop(1,"transparent"),a}function qe(){return`linear-gradient(
    180deg,
    ${V.background.surface} 0%,
    ${V.background.mid} 30%,
    ${V.background.deep} 60%,
    ${V.background.abyss} 100%
  )`}function Ve(e="cyan"){let r=ie[e];return`radial-gradient(
    circle,
    ${r.core} 0%,
    ${r.mid} 30%,
    ${r.outer} 60%,
    transparent 70%
  )`}function Fe(e=.8){return`radial-gradient(
    ellipse at 40% 40%,
    rgba(20, 30, 40, ${e}) 0%,
    rgba(15, 25, 35, ${e*.8}) 50%,
    rgba(10, 20, 30, ${e*.5}) 80%,
    transparent 100%
  )`}function Ne(){return`radial-gradient(
    ellipse at 50% 30%,
    rgba(180, 220, 255, 0.4) 0%,
    rgba(150, 200, 255, 0.2) 40%,
    rgba(120, 180, 255, 0.1) 70%,
    transparent 100%
  )`}function _e(){return`radial-gradient(
    ellipse at center,
    rgba(10, 20, 35, 0.8) 0%,
    transparent 70%
  )`}var An={};X(An,{createBioParticles:()=>Qe,createDeepParticles:()=>Ue,createMarineSnow:()=>je,cssMarineSnowParticle:()=>Zt,cssMarineSnowStyles:()=>xt,drawBioParticles:()=>xe,drawMarineSnow:()=>Ke,htmlMarineSnow:()=>Qt,updateDeepParticles:()=>Ze,updateMarineSnow:()=>Je});function je(e=80){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*2+.5,speed:Math.random()*.008+.003,alpha:Math.random()*.5+.2}))}function Je(e,r="down"){let n=r==="up"?-1:1;for(let o of e)o.y+=o.speed*n,r==="up"&&o.y<-.05?(o.y=1.05,o.x=Math.random()):r==="down"&&o.y>1.05&&(o.y=-.05,o.x=Math.random())}function Ke(e,r,n,o){for(let t of r)e.beginPath(),e.arc(t.x*n,t.y*o,t.size,0,Math.PI*2),e.fillStyle=`rgba(180, 200, 220, ${t.alpha})`,e.fill()}function Ue(e=12){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*1.5+.5,speed:Math.random()*.002+.001,alpha:Math.random()*.3+.1,phase:Math.random()*Math.PI*2}))}function Ze(e,r){for(let n of e)n.y+=n.speed,n.x+=Math.sin(r*.001+(n.phase??0))*5e-4,n.y>1.05&&(n.y=-.05,n.x=Math.random())}function Zt(e){let r=Math.random()*100,n=Math.random()*100,o=Math.random()*5,t=Math.random()>.5?3:2,a=Math.random()>.5?.3:.4;return{style:`
      position: absolute;
      left: ${r}%;
      top: ${n}%;
      width: ${t}px;
      height: ${t}px;
      background: rgba(200, 220, 255, ${a});
      border-radius: 50%;
      animation: snow-drift 8s linear infinite;
      animation-delay: ${o}s;
    `.trim(),animation:`
      @keyframes snow-drift {
        0% { transform: translateY(-20px) translateX(0); opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { transform: translateY(300px) translateX(20px); opacity: 0; }
      }
    `.trim()}}function Qt(e=20){return`<div class="marine-snow">${Array.from({length:e},(n,o)=>{let t=Math.random()*100,a=Math.random()*100,i=Math.random()*5;return`<div class="snow-particle" style="left: ${t}%; top: ${a}%; animation-delay: ${i}s;"></div>`}).join(`
`)}</div>`}var xt=`
  .marine-snow {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
  }
  
  .snow-particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: rgba(200, 220, 255, 0.4);
    border-radius: 50%;
    animation: snow-drift 8s linear infinite;
  }
  
  .snow-particle:nth-child(odd) {
    width: 3px;
    height: 3px;
    background: rgba(180, 200, 230, 0.3);
  }
  
  @keyframes snow-drift {
    0% { transform: translateY(-20px) translateX(0); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 1; }
    100% { transform: translateY(300px) translateX(20px); opacity: 0; }
  }
`;function Qe(e=15){return Array.from({length:e},()=>({x:Math.random(),y:Math.random(),size:Math.random()*4+2,speed:Math.random()*.002+.001,alpha:Math.random()*.6+.3,hue:180+Math.random()*40,pulseSpeed:Math.random()*.003+.002,phase:Math.random()*Math.PI*2}))}function xe(e,r,n,o,t){for(let a of r){let i=(Math.sin(t*a.pulseSpeed+(a.phase??0))+1)/2,s=a.alpha*(.5+i*.5),l=a.size*(.8+i*.4),d=a.x*n,m=a.y*o,u=e.createRadialGradient(d,m,0,d,m,l*3);u.addColorStop(0,`hsla(${a.hue}, 70%, 60%, ${s})`),u.addColorStop(.5,`hsla(${a.hue}, 60%, 40%, ${s*.3})`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.beginPath(),e.arc(d,m,l*3,0,Math.PI*2),e.fill(),e.fillStyle=`hsla(${a.hue}, 50%, 80%, ${s})`,e.beginPath(),e.arc(d,m,l*.5,0,Math.PI*2),e.fill()}}var Bn={};X(Bn,{drawJellyfish:()=>rn,drawLightCone:()=>nn,drawROV:()=>en,drawSpecimen:()=>tn});var Re={glacial:8e-4,verySlow:.001,slow:.002,medium:.003};function en(e,r,n,o=1,t={}){let{lightsOn:a=!0,showTether:i=!0,showArm:s=!0,time:l=0,rotation:d=0}=t;e.save(),e.translate(r,n),e.rotate(d),e.scale(o,o);let m=80,u=50;e.fillStyle="rgba(0, 0, 0, 0.4)",e.fillRect(-m/2+4,-u/2+4,m,u),e.fillStyle=Oe(e,-m/2,-u/2,m,u,H.rovYellow),e.fillRect(-m/2,-u/2,m,u),e.strokeStyle=H.rovYellow.outline,e.lineWidth=2,e.strokeRect(-m/2,-u/2,m,u),De(e,-m/2,-u/2,m,u,[.25,.75]),e.fillStyle=H.flotation.fill,e.fillRect(-m/2+5,-u/2-15,m-10,15),e.strokeStyle=H.flotation.outline,e.lineWidth=1,e.strokeRect(-m/2+5,-u/2-15,m-10,15),e.fillStyle=H.metal.dark,e.fillRect(-m/2-15,-10,15,20),e.fillRect(m/2,-10,15,20),pe(e,-m/2-15,-10,15,20,4,H.metal.mid),pe(e,m/2,-10,15,20,4,H.metal.mid),Le(e,0,u/2+10,12,8),a?[-25,25].forEach(b=>{Ae(e,b,u/2+5,8,!0,l)}):[-25,25].forEach(b=>{e.fillStyle=H.metal.mid,e.beginPath(),e.arc(b,u/2+5,8,0,Math.PI*2),e.fill()}),s&&(e.strokeStyle=H.metal.mid,e.lineWidth=4,e.lineCap="round",e.beginPath(),e.moveTo(-m/2+10,u/2),e.lineTo(-m/2+5,u/2+20),e.lineTo(-m/2+15,u/2+25),e.stroke()),i&&Ge(e,0,-u/2-15,0,-u/2-100,l),e.restore()}function nn(e,r,n,o,t,a={}){let{spread:i=.5,startOpacity:s=.15,color:l={r:255,g:250,b:230}}=a;e.save(),e.translate(r,n),e.rotate(o-Math.PI/2);let d=i/2,m=Math.tan(d)*t,u=e.createLinearGradient(0,0,0,t);u.addColorStop(0,`rgba(${l.r}, ${l.g}, ${l.b}, ${s})`),u.addColorStop(.5,`rgba(${l.r}, ${l.g}, ${l.b}, ${s*.3})`),u.addColorStop(1,`rgba(${l.r}, ${l.g}, ${l.b}, 0)`),e.fillStyle=u,e.beginPath(),e.moveTo(-10,0),e.lineTo(-m,t),e.lineTo(m,t),e.lineTo(10,0),e.closePath(),e.fill(),e.restore()}function rn(e,r,n,o={}){let{bellWidth:t=50,tentacleCount:a=4,time:i=0,glowIntensity:s=.4}=o,l=t*.7,d=ce(i,Re.slow,.95,1.05);e.save(),e.translate(r,n);let m=e.createRadialGradient(0,0,0,0,0,t*1.5);m.addColorStop(0,`rgba(150, 200, 255, ${s*.3})`),m.addColorStop(.5,`rgba(150, 200, 255, ${s*.1})`),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.arc(0,0,t*1.5,0,Math.PI*2),e.fill(),e.scale(d,1/d);let u=e.createRadialGradient(0,-l*.3,0,0,0,t);u.addColorStop(0,`rgba(180, 220, 255, ${s})`),u.addColorStop(.4,`rgba(150, 200, 255, ${s*.5})`),u.addColorStop(.7,`rgba(120, 180, 255, ${s*.25})`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.beginPath(),e.ellipse(0,0,t/2,l/2,0,0,Math.PI,!0),e.fill(),e.fillStyle=`rgba(200, 230, 255, ${s*.3})`,e.beginPath(),e.ellipse(0,-l*.15,t*.25,l*.2,0,0,Math.PI*2),e.fill();let b=t/(a+1),h=l*.3;for(let g=0;g<a;g++){let c=-t/2+b*(g+1),v=40+g%2*15,f=Math.sin(i*Re.slow+g*.8)*5,p=e.createLinearGradient(c,h,c+f,h+v);p.addColorStop(0,`rgba(150, 200, 255, ${s*.5})`),p.addColorStop(.5,`rgba(150, 200, 255, ${s*.2})`),p.addColorStop(1,"transparent"),e.strokeStyle=p,e.lineWidth=2,e.lineCap="round",e.beginPath(),e.moveTo(c,h),e.quadraticCurveTo(c+f*.5,h+v*.5,c+f,h+v),e.stroke()}e.restore()}function tn(e,r,n,o={}){let{width:t=70,time:a=0,illumination:i=0,lookAt:s}=o,l=t*.65,d=Math.sin(a*Re.verySlow)*3,m=Math.sin(a*Re.glacial)*.02;e.save(),e.translate(r,n+d),e.rotate(m);let u=.6+i*.3,b=e.createRadialGradient(-t*.1,-l*.1,0,0,0,t*.7);b.addColorStop(0,`rgba(${20+i*15}, ${30+i*10}, ${40+i*10}, ${u})`),b.addColorStop(.5,`rgba(15, 25, 35, ${u*.8})`),b.addColorStop(.8,`rgba(10, 20, 30, ${u*.5})`),b.addColorStop(1,"transparent"),e.fillStyle=b,e.beginPath(),e.ellipse(0,0,t/2,l/2,0,0,Math.PI*2),e.fill();let h=ce(a,Re.medium,.6,1),g=-t*.1,c=-l*.05,v=8*h,f=e.createRadialGradient(g,c,0,g,c,v*2);f.addColorStop(0,`rgba(255, 100, 80, ${.8*h})`),f.addColorStop(.4,`rgba(255, 80, 60, ${.4*h})`),f.addColorStop(1,"transparent"),e.fillStyle=f,e.beginPath(),e.arc(g,c,v*2,0,Math.PI*2),e.fill();let p=t*.15,R=-l*.1,y=4+i*2,M=15+i*10,$=e.createRadialGradient(p,R,0,p,R,M);$.addColorStop(0,`rgba(200, 50, 50, ${.6+i*.3})`),$.addColorStop(.5,`rgba(150, 30, 30, ${.2+i*.2})`),$.addColorStop(1,"transparent"),e.fillStyle=$,e.beginPath(),e.arc(p,R,M,0,Math.PI*2),e.fill(),e.fillStyle=`rgba(200, 50, 50, ${.8+i*.2})`,e.beginPath(),e.arc(p,R,y,0,Math.PI*2),e.fill();let P=0,D=0;if(s){let S=s.x-(r+p),w=s.y-(n+R),C=Math.sqrt(S*S+w*w);C>0&&(P=S/C*2,D=w/C*2)}if(e.fillStyle="rgba(10, 0, 0, 0.9)",e.beginPath(),i>.4?e.ellipse(p+P,R+D,1.5,y*.6,0,0,Math.PI*2):e.arc(p+P,R+D,2,0,Math.PI*2),e.fill(),i>.3){let S=(i-.3)*1.4,w=t*.05,C=l*.15;e.fillStyle=`rgba(180, 40, 40, ${S*.5})`,e.beginPath(),e.arc(w,C,3,0,Math.PI*2),e.fill()}e.restore()}var En={};X(En,{drawBarnacles:()=>on,drawOrganicSurface:()=>an,drawScarring:()=>sn,surfacePalettes:()=>ne});var ea=.5*(Math.sqrt(3)-1),$e=(3-Math.sqrt(3))/6,me=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];function rt(e){let r=Array.from({length:256},(o,t)=>t),n=e;for(let o=255;o>0;o--){n=n*1103515245+12345&2147483647;let t=n%(o+1);[r[o],r[t]]=[r[t],r[o]]}return[...r,...r]}function I(e,r,n){let o=(e+r)*ea,t=Math.floor(e+o),a=Math.floor(r+o),i=(t+a)*$e,s=t-i,l=a-i,d=e-s,m=r-l,u=d>m?1:0,b=d>m?0:1,h=d-u+$e,g=m-b+$e,c=d-1+2*$e,v=m-1+2*$e,f=t&255,p=a&255,R=n[f+n[p]]%8,y=n[f+u+n[p+b]]%8,M=n[f+1+n[p+1]]%8,$=0,P=0,D=0,S=.5-d*d-m*m;S>=0&&(S*=S,$=S*S*(me[R][0]*d+me[R][1]*m));let w=.5-h*h-g*g;w>=0&&(w*=w,P=w*w*(me[y][0]*h+me[y][1]*g));let C=.5-c*c-v*v;return C>=0&&(C*=C,D=C*C*(me[M][0]*c+me[M][1]*v)),70*($+P+D)}function nt(e,r,n,o=4){let t=0,a=.5,i=1,s=0;for(let l=0;l<o;l++)t+=a*I(e*i,r*i,n),s+=a,a*=.5,i*=2;return t/s}var ne={fleshy:{base:{r:28,g:22,b:26},mid:{r:38,g:30,b:35},highlight:{r:58,g:48,b:52},shadow:{r:18,g:14,b:18},vein:{r:50,g:28,b:35},veinHighlight:{r:85,g:50,b:55}},abyssal:{base:{r:20,g:25,b:32},mid:{r:30,g:38,b:48},highlight:{r:50,g:62,b:75},shadow:{r:12,g:15,b:22},vein:{r:35,g:45,b:60},veinHighlight:{r:60,g:80,b:100}},rocky:{base:{r:25,g:28,b:25},mid:{r:38,g:42,b:38},highlight:{r:55,g:62,b:55},shadow:{r:15,g:18,b:16},vein:{r:35,g:32,b:30},veinHighlight:{r:55,g:50,b:45}},membranous:{base:{r:25,g:20,b:30},mid:{r:38,g:30,b:45},highlight:{r:60,g:48,b:68},shadow:{r:15,g:12,b:20},vein:{r:70,g:40,b:55},veinHighlight:{r:100,g:60,b:75}}},na={visible:{noiseScale:.003,showVeins:!0,veinCount:6},subtle:{noiseScale:.005,showVeins:!0,veinCount:3},dramatic:{noiseScale:.002,showVeins:!0,veinCount:10}};function an(e,r,n,o={}){let t=o.preset?na[o.preset]:{},{type:a="fleshy",noiseScale:i=t.noiseScale??.003,showVeins:s=t.showVeins??!0,veinCount:l=t.veinCount??6,seed:d=42,time:m=0,lightX:u,lightY:b,lightRadius:h=250}={...t,...o},g=ne[a]||ne.fleshy,c=rt(d);zn(e,r,n,g,c,i,m),ra(e,r,n,g,c,i),s&&ta(e,r,n,g,c,l,m),aa(e,r,n,g,c,i*3),u!==void 0&&b!==void 0&&oa(e,r,n,u,b,h,g,c)}function zn(e,r,n,o,t,a,i){let m=Math.min(r,1920),u=Math.min(n,1080),b=m*u;if((r>1920||n>1080)&&console.warn(`drawOrganicSurface: Dimensions ${r}x${n} exceed safe limit (1920x1080). Using reduced size ${m}x${u} to prevent memory allocation failure.`),b>2073600){let v=Math.sqrt(2073600/b),f=Math.floor(m*v),p=Math.floor(u*v);return console.warn(`drawOrganicSurface: Pixel count ${b} exceeds limit 2073600. Scaling to ${f}x${p}.`),zn(e,f,p,o,t,a,i)}let h;try{h=e.createImageData(m,u)}catch(v){if(v instanceof RangeError||v instanceof DOMException){let f=Math.floor(m*.5),p=Math.floor(u*.5);return console.error(`drawOrganicSurface: Failed to allocate ${m}x${u} buffer. Falling back to ${f}x${p}.`,v),zn(e,f,p,o,t,a,i)}throw v}let g=h.data,c=i*5e-5;for(let v=0;v<u;v++)for(let f=0;f<m;f++){let p=nt(f*a+c,v*a,t,4),R=nt(f*a*2+100,v*a*2+100,t,3),y=(p+1)/2,M=(R+1)/2,$,P,D;if(y<.4){let w=y/.4;$=o.shadow.r+(o.base.r-o.shadow.r)*w,P=o.shadow.g+(o.base.g-o.shadow.g)*w,D=o.shadow.b+(o.base.b-o.shadow.b)*w}else if(y<.7){let w=(y-.4)/.3;$=o.base.r+(o.mid.r-o.base.r)*w,P=o.base.g+(o.mid.g-o.base.g)*w,D=o.base.b+(o.mid.b-o.base.b)*w}else{let w=(y-.7)/.3;$=o.mid.r+(o.highlight.r-o.mid.r)*w*.3,P=o.mid.g+(o.highlight.g-o.mid.g)*w*.3,D=o.mid.b+(o.highlight.b-o.mid.b)*w*.3}$+=(M-.5)*8,P+=(M-.5)*6,D+=(M-.5)*8;let S=(v*r+f)*4;g[S]=Math.max(0,Math.min(255,$)),g[S+1]=Math.max(0,Math.min(255,P)),g[S+2]=Math.max(0,Math.min(255,D)),g[S+3]=255}if(m===r&&u===n)e.putImageData(h,0,0);else{let v=document.createElement("canvas");v.width=m,v.height=u,v.getContext("2d").putImageData(h,0,0),e.drawImage(v,0,0,r,n)}}function ra(e,r,n,o,t,a){let i=a*.5;e.globalCompositeOperation="overlay";for(let s=0;s<8;s++){let l=I(s*50,0,t)*.5+.5,d=I(0,s*50,t)*.5+.5,m=l*r,u=d*n,b=100+Math.abs(I(s*30,s*30,t))*200;if(I(s*20,s*20+500,t)>0){let g=I(s*10,0,t)*Math.PI;e.save(),e.translate(m,u),e.rotate(g);let c=e.createLinearGradient(0,-b*.3,0,b*.3);c.addColorStop(0,`rgba(${o.highlight.r}, ${o.highlight.g}, ${o.highlight.b}, 0.15)`),c.addColorStop(.5,"rgba(128, 128, 128, 0)"),c.addColorStop(1,`rgba(${o.shadow.r}, ${o.shadow.g}, ${o.shadow.b}, 0.1)`),e.fillStyle=c,e.beginPath(),e.ellipse(0,0,b,b*.4,0,0,Math.PI*2),e.fill(),e.restore()}}e.globalCompositeOperation="source-over"}function ta(e,r,n,o,t,a,i){for(let s=0;s<a;s++){let l=Math.floor((I(s*100,0,t)+1)*2)%4,d,m,u,b=(I(s*50,s*50,t)+1)/2;switch(l){case 0:d=b*r,m=-20,u=Math.PI/2+I(s*30,0,t)*.4;break;case 1:d=r+20,m=b*n,u=Math.PI+I(s*30,100,t)*.4;break;case 2:d=b*r,m=n+20,u=-Math.PI/2+I(s*30,200,t)*.4;break;default:d=-20,m=b*n,u=I(s*30,300,t)*.4}tt(e,d,m,u,5+Math.abs(I(s*20,s*20,t))*4,0,t,o,i,r,n,s*1e3)}}function tt(e,r,n,o,t,a,i,s,l,d,m,u){if(t<1||a>4)return;let b=[{x:r,y:n,thickness:t}],h=r,g=n,c=o,v=t,f=8+Math.floor(Math.abs(I(u,0,i))*6);for(let p=0;p<f;p++){let R=I(u+p*10,a*100,i)*.6;c+=R;let y=30+I(u+p*20,0,i)*20,M=l>0?Math.sin(l*.002+p*.5+u*.01)*2:0;h+=Math.cos(c)*y,g+=Math.sin(c)*y+M;let $=I(u+p*15,a*50+500,i);if(v*=.92+$*.1,$>.6&&(v*=1.15),b.push({x:h,y:g,thickness:Math.max(.5,v)}),h<-50||h>d+50||g<-50||g>m+50)break;if(p>2&&I(u+p*25,a*200,i)>.7&&a<3){let P=c+(I(u+p*30,0,i)>0?1:-1)*(.5+Math.abs(I(u+p*35,0,i))*.5);tt(e,h,g,P,v*.6,a+1,i,s,l,d,m,u+p*1e3+a*1e4)}}if(!(b.length<2)){e.lineCap="round",e.lineJoin="round";for(let p=0;p<b.length-1;p++){let R=b[Math.max(0,p-1)],y=b[p],M=b[p+1],$=b[Math.min(b.length-1,p+2)],P=y.x+(M.x-R.x)/6,D=y.y+(M.y-R.y)/6,S=M.x-($.x-y.x)/6,w=M.y-($.y-y.y)/6,C=(y.thickness+M.thickness)/2;e.strokeStyle=`rgba(${s.shadow.r}, ${s.shadow.g}, ${s.shadow.b}, 0.4)`,e.lineWidth=C+2,e.beginPath(),e.moveTo(y.x+1,y.y+1),e.bezierCurveTo(P+1,D+1,S+1,w+1,M.x+1,M.y+1),e.stroke(),e.strokeStyle=`rgba(${s.vein.r}, ${s.vein.g}, ${s.vein.b}, 0.7)`,e.lineWidth=C,e.beginPath(),e.moveTo(y.x,y.y),e.bezierCurveTo(P,D,S,w,M.x,M.y),e.stroke(),e.strokeStyle=`rgba(${s.veinHighlight.r}, ${s.veinHighlight.g}, ${s.veinHighlight.b}, 0.25)`,e.lineWidth=C*.4,e.beginPath(),e.moveTo(y.x,y.y-C*.25),e.bezierCurveTo(P,D-C*.25,S,w-C*.25,M.x,M.y-C*.25),e.stroke()}}}function aa(e,r,n,o,t,a){e.globalCompositeOperation="soft-light";for(let i=0;i<15;i++){let s=(I(i*70,0,t)+1)/2*r,l=(I(0,i*70,t)+1)/2*n,d=40+Math.abs(I(i*40,i*40,t))*100,m=I(i*25,500,t)*Math.PI;e.save(),e.translate(s,l),e.rotate(m);let u=.3+Math.abs(I(i*35,0,t))*.4,b=e.createRadialGradient(0,0,0,0,0,d),h=I(i*45,250,t)>0?1.2:.8;b.addColorStop(0,`rgba(${o.mid.r*h}, ${o.mid.g*h}, ${o.mid.b*h}, 0.15)`),b.addColorStop(.7,`rgba(${o.base.r}, ${o.base.g}, ${o.base.b}, 0.05)`),b.addColorStop(1,"transparent"),e.fillStyle=b,e.beginPath(),e.ellipse(0,0,d,d*u,0,0,Math.PI*2),e.fill(),e.restore()}e.globalCompositeOperation="source-over"}function oa(e,r,n,o,t,a,i,s){let l=e.createRadialGradient(o,t,0,o,t,a*1.5);l.addColorStop(0,`rgba(${i.veinHighlight.r+20}, ${i.veinHighlight.g}, ${i.veinHighlight.b-10}, 0.12)`),l.addColorStop(.3,`rgba(${i.vein.r+15}, ${i.vein.g}, ${i.vein.b}, 0.08)`),l.addColorStop(.6,`rgba(${i.mid.r+10}, ${i.mid.g+5}, ${i.mid.b+5}, 0.04)`),l.addColorStop(1,"transparent"),e.fillStyle=l,e.fillRect(0,0,r,n);let d=e.createRadialGradient(o,t,0,o,t,a*.5);d.addColorStop(0,`rgba(${i.highlight.r+40}, ${i.highlight.g+35}, ${i.highlight.b+30}, 0.2)`),d.addColorStop(.5,`rgba(${i.highlight.r+20}, ${i.highlight.g+15}, ${i.highlight.b+10}, 0.08)`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.fillRect(0,0,r,n),e.globalCompositeOperation="overlay";let m=a*1.2;for(let u=0;u<5;u++){let b=(I(o*.01+u*20,t*.01,s)+1)*Math.PI,h=20+Math.abs(I(u*30,0,s))*60,g=o+Math.cos(b)*h,c=t+Math.sin(b)*h,v=Math.max(0,1-Math.sqrt((g-o)**2+(c-t)**2)/m)*.3;if(v>.05){e.strokeStyle=`rgba(${i.vein.r+20}, ${i.vein.g}, ${i.vein.b}, ${v})`,e.lineWidth=1+Math.abs(I(u*25,0,s))*2,e.lineCap="round",e.beginPath(),e.moveTo(g,c);let f=b+I(u*15,500,s)*.8,p=20+Math.abs(I(u*35,0,s))*40,R=p*.5,y=b+I(u*20,250,s)*.5;e.quadraticCurveTo(g+Math.cos(y)*R,c+Math.sin(y)*R,g+Math.cos(f)*p,c+Math.sin(f)*p),e.stroke()}}e.globalCompositeOperation="source-over"}function on(e,r,n,o,t={}){let{count:a=8,seed:i=123,palette:s=ne.rocky}=t,l=rt(i);for(let d=0;d<a;d++){let m=(I(d*50,0,l)+1)*Math.PI,u=Math.abs(I(d*30,d*30,l))*o,b=r+Math.cos(m)*u,h=n+Math.sin(m)*u,g=3+Math.abs(I(d*40,0,l))*8;e.strokeStyle=`rgba(${s.highlight.r}, ${s.highlight.g}, ${s.highlight.b}, 0.5)`,e.lineWidth=2,e.beginPath(),e.arc(b,h,g,Math.PI*.7,Math.PI*1.9),e.stroke(),e.strokeStyle=`rgba(${s.shadow.r}, ${s.shadow.g}, ${s.shadow.b}, 0.6)`,e.beginPath(),e.arc(b,h,g,Math.PI*1.9,Math.PI*.7),e.stroke(),e.fillStyle=`rgba(${s.mid.r}, ${s.mid.g}, ${s.mid.b}, 0.7)`,e.beginPath(),e.arc(b,h,g*.5,0,Math.PI*2),e.fill()}}function sn(e,r,n,o,t={}){let{angle:a=0,width:i=3,palette:s=ne.fleshy}=t,l=r+Math.cos(a)*o*.5,d=n+Math.sin(a)*o*.5,m=r+Math.cos(a)*o,u=n+Math.sin(a)*o,b=(Math.random()-.5)*15,h=l+Math.cos(a+Math.PI/2)*b,g=d+Math.sin(a+Math.PI/2)*b;e.strokeStyle=`rgba(${s.shadow.r}, ${s.shadow.g}, ${s.shadow.b}, 0.7)`,e.lineWidth=i,e.lineCap="round",e.beginPath(),e.moveTo(r,n),e.quadraticCurveTo(h,g,m,u),e.stroke(),e.strokeStyle=`rgba(${s.veinHighlight.r}, ${s.veinHighlight.g}, ${s.veinHighlight.b}, 0.35)`,e.lineWidth=i*.4,e.beginPath(),e.moveTo(r,n-i*.4),e.quadraticCurveTo(h,g-i*.4,m,u-i*.4),e.stroke()}ee("deepSea",{colors:Gn,gradients:Ln,particles:An,recipes:Bn,surfaces:En});var Wn={};X(Wn,{addAlphaToColor:()=>ln,getGrowthColor:()=>it,livingOs:()=>G,rgbToHex:()=>at,rgbToRgba:()=>ot});var G={bark:{dark:{r:29,g:20,b:23},mid:{r:61,g:40,b:23},light:{r:92,g:61,b:42}},foliage:{dark:{r:29,g:58,b:45},mid:{r:45,g:90,b:61},light:{r:61,g:106,b:77},vibrant:{r:77,g:122,b:93}},growth:{new:{r:90,g:122,b:77},young:{r:106,g:138,b:93}},decay:{old:{r:29,g:58,b:45},withered:{r:23,g:45,b:35}},unsettling:{hungry:{r:100,g:80,b:60},satisfied:{r:60,g:80,b:60},starving:{r:40,g:50,b:40}}};function at(e){let r=Math.round(e.r).toString(16).padStart(2,"0"),n=Math.round(e.g).toString(16).padStart(2,"0"),o=Math.round(e.b).toString(16).padStart(2,"0");return`#${r}${n}${o}`}function ot(e,r=1){return`rgba(${Math.round(e.r)}, ${Math.round(e.g)}, ${Math.round(e.b)}, ${r})`}function it(e){let r=Math.max(0,Math.min(100,e));if(r<20)return G.foliage.mid;if(r<50){let n=(r-20)/30;return{r:Math.round(G.foliage.mid.r+(G.growth.new.r-G.foliage.mid.r)*n),g:Math.round(G.foliage.mid.g+(G.growth.new.g-G.foliage.mid.g)*n),b:Math.round(G.foliage.mid.b+(G.growth.new.b-G.foliage.mid.b)*n)}}else if(r<80){let n=(r-50)/30;return{r:Math.round(G.growth.new.r+(G.unsettling.hungry.r-G.growth.new.r)*n),g:Math.round(G.growth.new.g+(G.unsettling.hungry.g-G.growth.new.g)*n),b:Math.round(G.growth.new.b+(G.unsettling.hungry.b-G.growth.new.b)*n)}}else{let n=(r-80)/20;return{r:Math.round(G.unsettling.hungry.r+(G.unsettling.starving.r-G.unsettling.hungry.r)*n),g:Math.round(G.unsettling.hungry.g+(G.unsettling.starving.g-G.unsettling.hungry.g)*n),b:Math.round(G.unsettling.hungry.b+(G.unsettling.starving.b-G.unsettling.hungry.b)*n)}}}function ln(e,r){let n=Math.max(0,Math.min(1,r)),o=e.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*[\d.]+)?\s*\)/i);if(o)return`rgba(${o[1]}, ${o[2]}, ${o[3]}, ${n})`;let t=e.match(/#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})/);if(t){let a=t[1],i,s,l;return a.length===3?(i=parseInt(a[0]+a[0],16),s=parseInt(a[1]+a[1],16),l=parseInt(a[2]+a[2],16)):(i=parseInt(a.slice(0,2),16),s=parseInt(a.slice(2,4),16),l=parseInt(a.slice(4,6),16)),`rgba(${i}, ${s}, ${l}, ${n})`}return console.warn(`Could not parse color format: "${e}". Returning as-is.`),e}var Fn={};X(Fn,{drawGrowingRoots:()=>qn,drawGrowthIndicator:()=>ct,drawOrganicRoots:()=>ft,drawOrganicVine:()=>pt,drawVines:()=>Vn});var Hn={};X(Hn,{clearPermutationCache:()=>lt,clearTextureCache:()=>dt,createPermutation:()=>Xn,drawBarkTexture:()=>K,drawBarkTextureCached:()=>mt,drawOrganicSurface:()=>bt,fbm:()=>N,getOrCreatePermutation:()=>U,getTextureCacheSize:()=>ut,precomputePermutations:()=>st,simplex2D:()=>k,woodPalettes:()=>Yn});var ia=.5*(Math.sqrt(3)-1),ke=(3-Math.sqrt(3))/6,be=[[1,1],[-1,1],[1,-1],[-1,-1],[1,0],[-1,0],[0,1],[0,-1]];function Xn(e){let r=Array.from({length:256},(o,t)=>t),n=e;for(let o=255;o>0;o--){n=n*1103515245+12345&2147483647;let t=n%(o+1);[r[o],r[t]]=[r[t],r[o]]}return[...r,...r]}var dn=new Map;function U(e){if(dn.has(e))return dn.get(e);let r=Xn(e);return dn.set(e,r),r}function st(e){for(let r of e)U(r)}function lt(){dn.clear()}function k(e,r,n){let o=(e+r)*ia,t=Math.floor(e+o),a=Math.floor(r+o),i=(t+a)*ke,s=t-i,l=a-i,d=e-s,m=r-l,u=d>m?1:0,b=d>m?0:1,h=d-u+ke,g=m-b+ke,c=d-1+2*ke,v=m-1+2*ke,f=t&255,p=a&255,R=n[f+n[p]]%8,y=n[f+u+n[p+b]]%8,M=n[f+1+n[p+1]]%8,$=0,P=0,D=0,S=.5-d*d-m*m;S>=0&&(S*=S,$=S*S*(be[R][0]*d+be[R][1]*m));let w=.5-h*h-g*g;w>=0&&(w*=w,P=w*w*(be[y][0]*h+be[y][1]*g));let C=.5-c*c-v*v;return C>=0&&(C*=C,D=C*C*(be[M][0]*c+be[M][1]*v)),70*($+P+D)}function N(e,r,n,o=4){let t=0,a=.5,i=1,s=0;for(let l=0;l<o;l++)t+=a*k(e*i,r*i,n),s+=a,a*=.5,i*=2;return t/s}var Yn={oak:{darkBrown:{r:35,g:22,b:12},baseBrown:{r:61,g:40,b:23},midBrown:{r:85,g:58,b:35},lightBrown:{r:110,g:78,b:50},grain:{r:45,g:28,b:15},moss:{r:55,g:75,b:40}},darkWood:{darkBrown:{r:20,g:12,b:8},baseBrown:{r:38,g:25,b:15},midBrown:{r:55,g:38,b:25},lightBrown:{r:75,g:52,b:35},grain:{r:28,g:18,b:10},moss:{r:45,g:65,b:35}},weathered:{darkBrown:{r:40,g:35,b:28},baseBrown:{r:65,g:55,b:42},midBrown:{r:88,g:75,b:58},lightBrown:{r:115,g:100,b:80},grain:{r:50,g:42,b:32},moss:{r:60,g:80,b:45}}},se=new Map,sa=.1,la=10;function dt(){se.clear()}function ut(){return se.size}function K(e,r){let{width:n,height:o,grainFlow:t="vertical",age:a=.5,growthLevel:i=0,knotDensity:s=.3,mossPatches:l=!1,roughness:d=.5,color:m,woodType:u="oak",seed:b=0,time:h=0}=r,g=1920,c=1080,v=g*c,f=Math.min(n,g),p=Math.min(o,c),R=f*p;if((n>g||o>c)&&console.warn(`drawBarkTexture: Dimensions ${n}x${o} exceed safe limit. Using ${f}x${p}.`),R>v){let S=Math.sqrt(v/R);return K(e,{...r,width:Math.floor(f*S),height:Math.floor(p*S)})}let y=Xn(b),M=m?da(m):Yn[u],$;try{$=e.createImageData(f,p)}catch(S){if(S instanceof RangeError||S instanceof DOMException){let w=Math.floor(f*.5),C=Math.floor(p*.5);return console.error(`drawBarkTexture: Allocation failed. Falling back to ${w}x${C}.`),K(e,{...r,width:w,height:C})}throw S}let P=$.data,D=h*5e-5;for(let S=0;S<p;S++)for(let w=0;w<f;w++){let C=(S*f+w)*4,T=N(w*.008+D,S*.008,y,4),z=N(w*.016+100,S*.016+100,y,3),L=(T+1)/2,A=(z+1)/2,E,B,W;if(L<.3){let O=L/.3;E=M.darkBrown.r+(M.baseBrown.r-M.darkBrown.r)*O,B=M.darkBrown.g+(M.baseBrown.g-M.darkBrown.g)*O,W=M.darkBrown.b+(M.baseBrown.b-M.darkBrown.b)*O}else if(L<.6){let O=(L-.3)/.3;E=M.baseBrown.r+(M.midBrown.r-M.baseBrown.r)*O,B=M.baseBrown.g+(M.midBrown.g-M.baseBrown.g)*O,W=M.baseBrown.b+(M.midBrown.b-M.baseBrown.b)*O}else{let O=(L-.6)/.4;E=M.midBrown.r+(M.lightBrown.r-M.midBrown.r)*O*.4,B=M.midBrown.g+(M.lightBrown.g-M.midBrown.g)*O*.4,W=M.midBrown.b+(M.lightBrown.b-M.midBrown.b)*O*.4}E+=(A-.5)*8,B+=(A-.5)*6,W+=(A-.5)*5;let Y;if(t==="vertical")Y=N(w*.08,S*.008+b*.1,y,3);else if(t==="horizontal")Y=N(w*.008+b*.1,S*.08,y,3);else if(t==="radial"){let O=f/2,j=p/2,Q=w-O,J=S-j,de=Math.atan2(J,Q),ue=Math.sqrt(Q*Q+J*J);Y=N(de*2+ue*.01,ue*.02,y,3)}else{let O=N(w*.01,S*.01,y,2)*30,j=N(w*.01+50,S*.01+50,y,2)*30;Y=N((w+O)*.03,(S+j)*.03,y,3)}if(Y>.3&&Y<.5){let O=1-Math.abs(Y-.4)*10;E=E*(1-O*.3)+M.grain.r*O*.3,B=B*(1-O*.3)+M.grain.g*O*.3,W=W*(1-O*.3)+M.grain.b*O*.3}P[C]=Math.max(0,Math.min(255,E)),P[C+1]=Math.max(0,Math.min(255,B)),P[C+2]=Math.max(0,Math.min(255,W)),P[C+3]=255}if(s>0){let S=Math.floor(s*5*(f*p)/16e4),w=[];for(let C=0;C<S;C++){let T=k(C*100+b,0,y)*.5+.5,z=k(C*100+b,100,y)*.5+.5;w.push({x:T*f,y:z*p,radius:15+k(C*50,b,y)*20})}for(let C=0;C<p;C++)for(let T=0;T<f;T++){let z=(C*f+T)*4;for(let L of w){let A=T-L.x,E=C-L.y,B=Math.sqrt(A*A+E*E);if(B<L.radius*1.5){let W=B/L.radius;if(W<1){let Y=Math.sin(B*.5)*.5+.5,O=(1-W)*.4*(1+Y*.3);P[z]=Math.max(0,P[z]-O*40),P[z+1]=Math.max(0,P[z+1]-O*35),P[z+2]=Math.max(0,P[z+2]-O*30)}}}}}if(i>.1){let S=Math.min(1,(i-.1)*2)*a,w=Math.floor(S*8);for(let C=0;C<w;C++){let T=k(C*200+b,0,y)*.5+.5,z=k(C*200+b,200,y)*.5+.5,L=50+k(C*100,b,y)*100,A=k(C*150,b+50,y)*Math.PI;for(let E=0;E<p;E++)for(let B=0;B<f;B++){let W=(E*f+B)*4,Y=T*f,O=z*p,j=B-Y,Q=E-O,J=j*Math.cos(A)+Q*Math.sin(A),de=Math.abs(-j*Math.sin(A)+Q*Math.cos(A));if(J>0&&J<L&&de<3){let ue=1-de/3,Sn=1-J/L,te=ue*Sn*S*.5;P[W]=Math.max(0,P[W]-te*50),P[W+1]=Math.max(0,P[W+1]-te*45),P[W+2]=Math.max(0,P[W+2]-te*40)}}}}if(i>.3){let S=Math.min(1,(i-.3)*2.5)*d;for(let w=0;w<p;w++)for(let C=0;C<f;C++){let T=(w*f+C)*4,L=N(C*.1,w*.1,y,5)*S*12;P[T]=Math.max(0,Math.min(255,P[T]+L)),P[T+1]=Math.max(0,Math.min(255,P[T+1]+L*.8)),P[T+2]=Math.max(0,Math.min(255,P[T+2]+L*.6))}}if(l&&i>.5){let S=(i-.5)*2;for(let w=0;w<p;w++)for(let C=0;C<f;C++){let T=(w*f+C)*4,z=N(C*.015+b*.5,w*.015,y,3);if(z>.3){let L=(z-.3)*1.4*S,A=Math.min(.6,L);P[T]=P[T]*(1-A)+M.moss.r*A,P[T+1]=P[T+1]*(1-A)+M.moss.g*A,P[T+2]=P[T+2]*(1-A)+M.moss.b*A}}}if(f===n&&p===o)e.putImageData($,0,0);else{let S=document.createElement("canvas");S.width=f,S.height=p,S.getContext("2d").putImageData($,0,0),e.drawImage(S,0,0,n,o)}}function mt(e,r){let{cacheKey:n,cacheTolerance:o=sa,growthLevel:t=0,...a}=r;if(!n){K(e,r);return}let i=se.get(n);if(i&&Math.abs(i.growthLevel-t)<o){e.drawImage(i.canvas,0,0);return}let s=typeof OffscreenCanvas<"u"?new OffscreenCanvas(r.width,r.height):document.createElement("canvas");s instanceof OffscreenCanvas,s.width=r.width,s.height=r.height;let l=s.getContext("2d");if(K(l,r),e.drawImage(s,0,0),se.size>=la){let d=se.keys().next().value;se.delete(d)}se.set(n,{canvas:s,growthLevel:t,timestamp:Date.now()})}function bt(e,r){let{type:n="organic",...o}=r;n==="bark"?K(e,{...o,grainFlow:"vertical",roughness:.7}):n==="wood"?K(e,{...o,grainFlow:"vertical",roughness:.4}):K(e,{...o,grainFlow:"chaotic",roughness:(o.roughness||.5)*.6})}function da(e){let r=ua(e);return{darkBrown:{r:r.r*.5,g:r.g*.5,b:r.b*.5},baseBrown:r,midBrown:{r:r.r*1.3,g:r.g*1.3,b:r.b*1.3},lightBrown:{r:r.r*1.6,g:r.g*1.6,b:r.b*1.6},grain:{r:r.r*.7,g:r.g*.7,b:r.b*.7},moss:{r:55,g:75,b:40}}}function ua(e){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:{r:61,g:40,b:23}}function qn(e,r){let{origin:n,direction:o="down",length:t,branches:a=2,thickness:i=3,color:s="#3d2817",time:l=0,seed:d=0}=r;e.save(),e.strokeStyle=s,e.lineCap="round",e.lineJoin="round";let m={down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0},up:{x:0,y:-1}}[o],u=t*150,b=30+d%20,h=n.x+m.x*u,g=n.y+m.y*u,c=n.x+m.x*(u*.3)+(d%15-7),v=n.y+m.y*(u*.3)+(d%15-7),f=n.x+m.x*(u*.7)+(d%10-5),p=n.y+m.y*(u*.7)+(d%10-5);e.beginPath(),e.moveTo(n.x,n.y),e.bezierCurveTo(c,v,f,p,h,g);let R=e.createLinearGradient(n.x,n.y,h,g);R.addColorStop(0,s);let y=ln(s,0);R.addColorStop(1,y),e.strokeStyle=R,e.lineWidth=i*(1-t*.3),e.stroke();for(let M=0;M<a;M++){let $=(M+1)/(a+1),P=ht(n.x,c,f,h,$),D=ht(n.y,v,p,g,$),S=-m.y,w=m.x,T=((d+M*100)%60-30)*Math.PI/180,z=S*Math.cos(T)-w*Math.sin(T),L=S*Math.sin(T)+w*Math.cos(T),A=t*40*(.5+d%50/100),E=P+z*A,B=D+L*A;e.beginPath(),e.moveTo(P,D),e.lineTo(E,B),e.lineWidth=i*.5*(1-$),e.strokeStyle=s,e.stroke()}e.restore()}function Vn(e,r){let{origin:n,length:o,thickness:t=2,color:a="#2d5a3d",path:i}=r;if(e.save(),e.strokeStyle=a,e.lineCap="round",e.lineJoin="round",e.lineWidth=t,i&&i.length>1){let s=i.filter(l=>l!=null&&typeof l=="object"&&typeof l.x=="number"&&typeof l.y=="number"&&!isNaN(l.x)&&!isNaN(l.y));if(s.length<2)console.warn(`drawVines: Path array has insufficient valid points (${s.length} valid out of ${i.length} total). Falling back to generated path.`);else{e.beginPath(),e.moveTo(s[0].x,s[0].y);for(let l=1;l<s.length;l++){let d=s[l-1],m=s[l];if(l<s.length-1){let u=s[l+1],b=d.x+(m.x-d.x)*.5,h=d.y+(m.y-d.y)*.5,g=m.x+(u.x-m.x)*.3,c=m.y+(u.y-m.y)*.3;e.bezierCurveTo(b,h,g,c,m.x,m.y)}else e.lineTo(m.x,m.y)}e.stroke(),e.restore();return}}{let s=Math.floor(o*20);e.beginPath(),e.moveTo(n.x,n.y);let l=n.x,d=n.y;for(let m=1;m<=s;m++){let u=m/s,b=Math.sin(u*Math.PI*3)*.3,h=Math.cos(b)*10,g=Math.sin(b)*10+5;l+=h,d+=g,e.lineTo(l,d)}e.stroke()}e.restore()}function ct(e,r){let{x:n,y:o,width:t,height:a,growthLevel:i,style:s="vines",color:l="#5a7a4d"}=r;e.save();let d=Math.max(0,Math.min(1,i)),m=a*d;switch(s){case"vines":let u=Math.floor(t/15);for(let g=0;g<u;g++){let c=n+g*t/u+5;Vn(e,{origin:{x:c,y:o+a},length:d,thickness:2,color:l,direction:"up"})}break;case"roots":let b=Math.floor(t/20);for(let g=0;g<b;g++){let c=n+g*t/b+10;qn(e,{origin:{x:c,y:o},length:d,thickness:2,color:l,direction:"down",branches:1,seed:g*100})}break;case"leaves":let h=Math.floor(d*10);for(let g=0;g<h;g++){let c=n+Math.random()*t,v=o+a-Math.random()*m;e.fillStyle=l,e.beginPath(),e.arc(c,v,4,0,Math.PI*2),e.fill()}break;case"bark":e.fillStyle=l,e.fillRect(n,o+a-m,t,m);break}e.restore()}function ht(e,r,n,o,t){let a=1-t;return a*a*a*e+3*a*a*t*r+3*a*t*t*n+t*t*t*o}function pt(e,r){let{origin:n,target:o,length:t,branchingDepth:a=2,organicVariation:i=.5,hasLeaves:s=!1,hasTendrils:l=!1,growthLevel:d=1,thickness:m=4,color:u="#2d5a3d",leafColor:b,time:h=0,seed:g=0}=r,c=Mt(u),v=U(g),f=b||ha(c,.15);e.save(),e.lineCap="round",e.lineJoin="round",e.strokeStyle=c,e.fillStyle=f;let p;o?p=Math.atan2(o.y-n.y,o.x-n.x):p=k(g,0,v)*Math.PI*2;let R=[],y=[];gt(e,n.x,n.y,p,m,t*d,0,a,i,v,g,h,c,o,R,y,s,l);for(let M of R)M.thickness>=1.5&&gt(e,M.x,M.y,M.angle,M.thickness,t*d*(1-M.progress)*.6,1,a,i,v,g+M.progress*1e3,h,c,void 0,[],y,s,l);if(s&&y.length>0)for(let M of y)ba(e,M.x,M.y,M.angle,M.size,f);e.restore()}function gt(e,r,n,o,t,a,i,s,l,d,m,u,b,h,g,c,v,f){if(a<5||t<.5)return;let p=Math.max(4,Math.floor(a/15)),R=a/p,y=r,M=n,$=o,P=t,D=Math.sin(u*.0015+m)*.03*l;for(let S=0;S<p;S++){let w=S/p,C=m+S*100+i*1e4,T=k(C,i*50,d)*.4*l,z=h?Math.atan2(h.y-M,h.x-y)*.1:0;$+=T+z+D;let A=.94+(k(C+500,m,d)>.6?.08:0);P*=A,P=Math.max(.5,P);let E=y+Math.cos($)*R,B=M+Math.sin($)*R,W=R*.3*(1+k(C+200,0,d)*l*.5),Y=R*.3*(1+k(C+300,0,d)*l*.5),O=$+k(C+400,0,d)*.2*l,j=$-k(C+450,0,d)*.2*l,Q=y+Math.cos(O)*W,J=M+Math.sin(O)*W,de=E-Math.cos(j)*Y,ue=B-Math.sin(j)*Y;e.beginPath(),e.moveTo(y,M),e.bezierCurveTo(Q,J,de,ue,E,B);let Sn=1-w*.2;if(e.strokeStyle=Te(b,Sn),e.lineWidth=P,e.stroke(),i<s&&S>1&&S<p-1&&k(C+600,i,d)>.6-i*.1){let te=k(C+700,0,d)>0?1:-1,wn=$+te*(.4+k(C+800,0,d)*.4);g.push({x:y,y:M,angle:wn,thickness:P*.55,progress:w})}if(v&&S>0&&S%3===0&&P>1){let te=k(C+900,0,d)>0?1:-1,wn=$+te*Math.PI*.4,Ht=6+k(C+950,0,d)*4;c.push({x:y,y:M,angle:wn,size:Ht*(1-w*.3)})}y=E,M=B}f&&P<t*.5&&ma(e,y,M,$,P,d,m,b)}function ma(e,r,n,o,t,a,i,s){let l=2+k(i,100,a)*1.5,d=l*Math.PI*2,m=15+k(i+200,0,a)*10,u=k(i+300,0,a)>0?1:-1;e.beginPath(),e.moveTo(r,n);let b=r,h=n,g=m/(l*Math.PI*2),c=30;for(let v=1;v<=c;v++){let f=v/c,p=o+u*f*d,R=g*(1-f*.7);b=r+Math.cos(p)*R*f*m*.5,h=n+Math.sin(p)*R*f*m*.5,e.lineTo(b,h)}e.strokeStyle=Te(s,.85),e.lineWidth=Math.max(.5,t*.4),e.stroke()}function ba(e,r,n,o,t,a){e.save(),e.translate(r,n),e.rotate(o),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(t*.5,-t*.4,t,0),e.quadraticCurveTo(t*.5,t*.4,0,0),e.fillStyle=a,e.fill(),e.beginPath(),e.moveTo(0,0),e.lineTo(t*.8,0),e.strokeStyle=Te(a,.7),e.lineWidth=.5,e.stroke(),e.restore()}function ft(e,r){let{origin:n,mainRootCount:o=4,maxDepth:t=3,length:a,growthLevel:i=1,thickness:s=5,color:l="#3d2817",surfaceY:d,time:m=0,seed:u=0}=r,b=U(u);e.save(),e.lineCap="round",e.lineJoin="round";let h=Math.max(2,Math.min(6,o));for(let g=0;g<h;g++){let c=u+g*1e4,v=Math.PI*.5,f=Math.PI*.6,p=(g/(h-1)-.5)*f,R=k(c,0,b)*.2,y=v+p+R,M=a*(.7+k(c+100,0,b)*.5)*i,$=s*(.8+k(c+200,0,b)*.4);vt(e,n.x,n.y,y,$,M,0,t,b,c,m,l,d)}e.restore()}function vt(e,r,n,o,t,a,i,s,l,d,m,u,b){if(a<8||t<1||i>s)return;let h=Math.max(3,Math.floor(a/20)),g=a/h,c=r,v=n,f=o,p=t,R=.6;for(let y=0;y<h;y++){let M=y/h,$=d+y*100+i*5e3,P=k($,i*30,l)*.6*R,D=(i===0?.02:.01)*(f<Math.PI?1:-1);f+=P+D;let S=k($+500,d,l)>.65?1.12:.92;p*=S,p=Math.max(1,Math.min(t*1.2,p));let w=c+Math.cos(f)*g,C=v+Math.sin(f)*g,T=g*.35,z=f+k($+200,0,l)*.3,L=f-k($+250,0,l)*.3,A=c+Math.cos(z)*T,E=v+Math.sin(z)*T,B=w-Math.cos(L)*T,W=C-Math.sin(L)*T;if(e.beginPath(),e.moveTo(c,v),e.bezierCurveTo(A,E,B,W,w,C),e.strokeStyle=Te(u,.85-i*.05),e.lineWidth=p,e.stroke(),i<s&&y>0&&k($+600,i,l)>.5-i*.1){let Y=k($+700,0,l)>0?1:-1,O=f+Y*(.5+k($+800,0,l)*.5);vt(e,c,v,O,p*.5,a*(1-M)*.5,i+1,s,l,$+1e3,m,u,b)}b!==void 0&&v<b&&n>=b&&(e.fillStyle=Te(u,.6),e.beginPath(),e.ellipse(c,b,p*1.5,p*.8,0,0,Math.PI*2),e.fill()),c=w,v=C}}function Te(e,r){let n=yt(e);return Ct(Math.round(n.r*r),Math.round(n.g*r),Math.round(n.b*r))}function ha(e,r){let n=yt(e);return Ct(Math.round(n.r+(255-n.r)*r),Math.round(n.g+(255-n.g)*r),Math.round(n.b+(255-n.b)*r))}function Mt(e){return e?/^#([a-f\d]{3}){1,2}$/i.test(e)||e.startsWith("rgb")?e:(console.warn(`Invalid color format: ${e}, using default green`),"#2d5a3d"):"#2d5a3d"}function yt(e){let r=Mt(e),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return n?{r:parseInt(n[1],16),g:parseInt(n[2],16),b:parseInt(n[3],16)}:{r:45,g:90,b:61}}function Ct(e,r,n){return"#"+[e,r,n].map(o=>{let t=Math.max(0,Math.min(255,o)).toString(16);return t.length===1?"0"+t:t}).join("")}var jn={};X(jn,{drawFlower:()=>Pt,drawLeaf:()=>Nn,drawLeaves:()=>St});function Nn(e,r){let{x:n,y:o,size:t=20,rotation:a=0,type:i="simple",color:s="#3d6a4d",opacity:l=1,growthLevel:d=1,seed:m=0}=r;switch(e.save(),e.translate(n,o),e.rotate(a),e.globalAlpha=l,i){case"simple":wt(e,t,s);break;case"veined":ga(e,t,s);break;case"organic":ca(e,t,s);break;case"detailed":pa(e,t,s,d,m);break}e.restore()}function St(e,r){r.forEach(n=>{let o=n.x+(n.driftX||0),t=n.y+(n.driftY||0);Nn(e,{...n,x:o,y:t})})}function wt(e,r,n){e.fillStyle=n,e.beginPath(),e.moveTo(0,-r*.5),e.bezierCurveTo(r*.3,-r*.2,r*.4,r*.3,0,r*.5),e.bezierCurveTo(-r*.4,r*.3,-r*.3,-r*.2,0,-r*.5),e.closePath(),e.fill()}function ga(e,r,n){wt(e,r,n),e.strokeStyle=n,e.lineWidth=1,e.globalAlpha=.4,e.beginPath(),e.moveTo(0,-r*.5),e.lineTo(0,r*.5),e.stroke();let o=3;for(let t=0;t<o;t++){let a=(t+1)/(o+1),i=-r*.5+r*a;e.beginPath(),e.moveTo(0,i),e.lineTo(-r*.3,i+r*.1),e.stroke(),e.beginPath(),e.moveTo(0,i),e.lineTo(r*.3,i+r*.1),e.stroke()}e.globalAlpha=1}function ca(e,r,n){e.fillStyle=n,e.beginPath();let o=8,t=Math.PI*2/o;e.moveTo(0,-r*.5);for(let a=0;a<=o;a++){let i=t*a-Math.PI/2,s=r*.5*(1+Math.sin(a*.7)*.2),l=Math.cos(i)*s,d=Math.sin(i)*s;if(a===0)e.moveTo(l,d);else{let m=t*(a-1)-Math.PI/2,u=r*.5*(1+Math.sin((a-1)*.7)*.2),b=Math.cos(m)*u,h=Math.sin(m)*u,g=(b+l)/2+Math.sin(a)*r*.1,c=(h+d)/2+Math.cos(a)*r*.1;e.quadraticCurveTo(g,c,l,d)}}e.closePath(),e.fill(),e.strokeStyle=n,e.lineWidth=.5,e.globalAlpha=.3,e.beginPath(),e.moveTo(0,-r*.5),e.lineTo(0,r*.5),e.stroke(),e.globalAlpha=1}function pa(e,r,n,o,t){let a=U(t),i=un(n);e.beginPath();let l=24/2,d=[],m=[];for(let u=0;u<=l;u++){let b=u/l,g=Math.sin(b*Math.PI)*.4*r,c=-r*.5+b*r,v=k(t+u*10,0,a)*r*.08,f=k(t+u*10,100,a)*r*.03;d.push({x:-g+v,y:c+f}),m.push({x:g-v,y:c+f})}e.moveTo(0,-r*.5);for(let u=0;u<m.length-1;u++){let b=m[u],h=m[u+1],g=(b.x+h.x)/2+k(t+u*20,200,a)*r*.05,c=(b.y+h.y)/2;e.quadraticCurveTo(b.x,b.y,g,c)}e.lineTo(0,r*.5);for(let u=d.length-1;u>0;u--){let b=d[u],h=d[u-1],g=(b.x+h.x)/2-k(t+u*20,300,a)*r*.05,c=(b.y+h.y)/2;e.quadraticCurveTo(b.x,b.y,g,c)}e.closePath(),e.fillStyle=n,e.fill(),o>.3&&fa(e,r,i,a,t,o),o>.2&&va(e,r,n,a,t,o)}function fa(e,r,n,o,t,a){let i=(a-.3)*1.4,s=Math.floor(i*8);e.save();for(let l=0;l<s;l++){let d=k(t+l*50,0,o)*r*.35,m=k(t+l*50,50,o)*r*.4,u=3+k(t+l*50,100,o)*4,b=k(t+l*50,150,o)*20,h=`rgba(${Math.max(0,n.r+b)}, ${Math.max(0,n.g+b)}, ${Math.max(0,n.b+b)}, 0.3)`;e.fillStyle=h,e.beginPath(),e.ellipse(d,m,u,u*.7,k(t+l,0,o),0,Math.PI*2),e.fill()}e.restore()}function va(e,r,n,o,t,a){let i=Rt(n,.7),s=Math.min(1,a*1.2);e.save(),e.strokeStyle=i,e.lineCap="round",e.lineWidth=1.5,e.globalAlpha=.5*s,e.beginPath(),e.moveTo(0,-r*.45),e.bezierCurveTo(k(t,0,o)*2,0,k(t+100,0,o)*2,r*.3,0,r*.45),e.stroke();let l=Math.floor(4+s*2);for(let d=0;d<l;d++){let m=(d+1)/(l+1),u=-r*.45+m*r*.9,b=Math.sin(m*Math.PI)*r*.35;for(let h of[-1,1]){let g=h*b*.85,c=u+r*.05;if(e.lineWidth=1,e.globalAlpha=.4*s,e.beginPath(),e.moveTo(0,u),e.quadraticCurveTo(h*b*.3+k(t+d*20,h*100,o)*3,u+r*.02,g,c),e.stroke(),a>.5){let v=2+Math.floor((a-.5)*4);for(let f=0;f<v;f++){let p=(f+1)/(v+1),R=h*b*.3*p,y=u+r*.02*p,M=R+h*b*.2,$=y+r*.03;e.lineWidth=.5,e.globalAlpha=.3*s,e.beginPath(),e.moveTo(R,y),e.lineTo(M,$),e.stroke()}}}}e.restore()}function Pt(e,r){let{x:n,y:o,petalCount:t=5,petalLength:a=15,color:i="#e8a0b0",centerColor:s="#f5d76e",growthStage:l=1,rotation:d=0,seed:m=0}=r,u=U(m);e.save(),e.translate(n,o),e.rotate(d);let b=l*Math.PI*.4,h=Math.max(4,Math.min(8,t)),g=Math.PI*2/h;for(let c=0;c<h;c++){let v=g*c-Math.PI/2,f=m+c*100,p=1+k(f,0,u)*.15,R=1+k(f,50,u)*.1,y=k(f,100,u)*15,M=(1-l)*a*.3;e.save(),e.rotate(v);let $=un(i),P=_n(Math.min(255,Math.max(0,$.r+y)),Math.min(255,Math.max(0,$.g+y)),Math.min(255,Math.max(0,$.b+y)));Ma(e,M,a*p*l,a*.35*R,b,P,u,f),e.restore()}if(l>.3){let c=a*.25*Math.min(1,(l-.3)*1.5);ya(e,c,s,u,m)}e.restore()}function Ma(e,r,n,o,t,a,i,s){e.save(),e.translate(0,-r),e.rotate(-t*.3),e.fillStyle=a,e.beginPath(),e.moveTo(0,0),e.bezierCurveTo(o*.8+k(s,0,i)*o*.2,-n*.3,o*.6+k(s,50,i)*o*.2,-n*.7,k(s,100,i)*o*.1,-n),e.bezierCurveTo(-o*.6-k(s,150,i)*o*.2,-n*.7,-o*.8-k(s,200,i)*o*.2,-n*.3,0,0),e.closePath(),e.fill(),e.strokeStyle=Rt(a,.85),e.lineWidth=.5,e.globalAlpha=.4,e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(k(s+300,0,i)*o*.2,-n*.5,0,-n*.85),e.stroke(),e.restore()}function ya(e,r,n,o,t){let a=un(n);e.fillStyle=n,e.beginPath(),e.arc(0,0,r,0,Math.PI*2),e.fill();let i=Math.floor(r*2);for(let s=0;s<i;s++){let l=s/i*Math.PI*2,d=k(t+s*10,0,o),m=r*(.3+d*.5),u=Math.cos(l)*m,b=Math.sin(l)*m,h=1+k(t+s*10,100,o)*1,g=k(t+s*10,200,o)*30;e.fillStyle=_n(Math.max(0,Math.min(255,a.r-g)),Math.max(0,Math.min(255,a.g-g)),Math.max(0,Math.min(255,a.b-g))),e.beginPath(),e.arc(u,b,h,0,Math.PI*2),e.fill()}}function un(e){let r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:{r:61,g:106,b:77}}function _n(e,r,n){return"#"+[e,r,n].map(o=>{let t=Math.max(0,Math.min(255,Math.round(o))).toString(16);return t.length===1?"0"+t:t}).join("")}function Rt(e,r){let n=un(e);return _n(Math.round(n.r*r),Math.round(n.g*r),Math.round(n.b*r))}var Zn={};X(Zn,{GROWTH_TIMING:()=>Un,applyDrift:()=>kt,applyGrowthTiming:()=>Gt,applySway:()=>$t,calculateDrift:()=>Kn,calculateGrowthProgress:()=>Tt,calculatePulse:()=>Ot,calculateScalePulse:()=>Dt,calculateSway:()=>Jn,calculateTipGrowthMultiplier:()=>It});function Jn(e){let{intensity:r=.5,speed:n=1,time:o,baseRotation:t=0}=e,a=Math.sin(o*n*.5)*r*.05;return t+a}function Kn(e){let{intensity:r=.5,speed:n=1,time:o,baseX:t=0,baseY:a=0}=e,i=Math.sin(o*n*.3)*r*5,s=Math.cos(o*n*.2)*r*3;return{x:t+i,y:a+s}}function $t(e,r,n,o){let t=Jn(o);e.save(),e.translate(r,n),e.rotate(t),e.translate(-r,-n)}function kt(e,r){let{x:n,y:o}=Kn(r);e.translate(n,o)}function Tt(e){let{baseGrowth:r,time:n,seed:o=0,style:t="linear"}=e,a=Math.max(0,Math.min(1,r));switch(t){case"linear":return a;case"pulse":{let s=1+(Math.sin(n*.0015+o)*.5+.5)*.3;return Math.min(1,a*s)}case"surge":{let i=a*a,s=Math.sin(n*.001+o*.1)*.05;return Math.max(0,Math.min(1,i+s))}case"glacial":{let l=(Math.sin(n*2e-4+o)*.5+.5-.5)*.04;return Math.max(0,Math.min(1,a+l))}default:return a}}function It(e,r,n=0){let o=e*.3,t=Math.sin(r*.002+n+e*10)*.1;return 1+o+t*e}function Ot(e){let{time:r,intensity:n=.15,speed:o=1,minOpacity:t=.8}=e,a=Math.sin(r*.002*o)*.5+.5,i=1-t;return t+Ca(a,i,n)}function Ca(e,r,n){return e*r*n+r*(1-n)}function Dt(e,r=.02,n=1){return 1+Math.sin(e*.001*n)*r}var Un={glacial:{baseSpeed:2e-4,pulseSpeed:.001,tipMultiplier:1.2},slow:{baseSpeed:5e-4,pulseSpeed:.0015,tipMultiplier:1.3},normal:{baseSpeed:.001,pulseSpeed:.002,tipMultiplier:1.4},fast:{baseSpeed:.003,pulseSpeed:.004,tipMultiplier:1.5}};function Gt(e,r,n="slow",o=0){let t=Un[n],a=r*t.baseSpeed,i=Math.sin(r*t.pulseSpeed+o)*.1,s=e+i*e;return Math.max(0,Math.min(1,s))}ee("livingOs",{colors:Wn,growth:Fn,plants:jn,textures:Hn,motion:Zn});var mn={};X(mn,{gardenWindow:()=>Z,interpolateColor:()=>At,overgrown:()=>F,softGarden:()=>re,terrarium:()=>q,withAlpha:()=>Lt});var re={background:{light:"#faf6f1",mid:"#efe8dc",dark:"#dfd4c8"},accents:{pollen:"#f5e5b8",warmth:"#ffd9a3",sunRay:"#fff8eb"},particles:{pollen:{bright:"rgba(245, 229, 184, 0.6)",mid:"rgba(235, 215, 160, 0.4)",dim:"rgba(220, 200, 140, 0.2)"}}},q={background:{surface:"#c8d5b9",mid:"#7a9b76",deep:"#4a6b47",shadow:"#2d4a2c"},foliage:{new:"#a8c69f",mature:"#6b8f67",shadow:"#4a6247",accent:"#8fb581"},particles:{leaves:{light:"rgba(168, 198, 159, 0.5)",mid:"rgba(107, 143, 103, 0.35)",dark:"rgba(74, 98, 71, 0.2)"}}},Z={glass:{tint:"rgba(245, 248, 250, 0.3)",edge:"rgba(220, 230, 235, 0.5)",smudge:"rgba(200, 210, 220, 0.15)"},garden:{muted:"#b8c9b5",soft:"#9db09a",distant:"#8a998763"},particles:{dust:{bright:"rgba(220, 230, 240, 0.25)",dim:"rgba(180, 200, 220, 0.12)",veryDim:"rgba(150, 170, 190, 0.05)"}}},F={background:{dense:"#3d5a3c",vibrant:"#5a7f58",light:"#7fa67d"},growth:{vine:"#4f6b4e",leaf:"#6d8f6b",wild:"#5f9a5c",shadow:"#3a5538"},particles:{fragments:{bright:"rgba(127, 166, 125, 0.6)",mid:"rgba(95, 154, 92, 0.4)",dim:"rgba(62, 85, 60, 0.2)"}}};function Lt(e,r){let n=e.replace("#",""),o=parseInt(n.substring(0,2),16),t=parseInt(n.substring(2,4),16),a=parseInt(n.substring(4,6),16);return`rgba(${o}, ${t}, ${a}, ${r})`}function At(e,r,n){let o=e.replace("#",""),t=r.replace("#",""),a=parseInt(o.substring(0,2),16),i=parseInt(o.substring(2,4),16),s=parseInt(o.substring(4,6),16),l=parseInt(t.substring(0,2),16),d=parseInt(t.substring(2,4),16),m=parseInt(t.substring(4,6),16),u=Math.round(a+(l-a)*n),b=Math.round(i+(d-i)*n),h=Math.round(s+(m-s)*n);return`#${u.toString(16).padStart(2,"0")}${b.toString(16).padStart(2,"0")}${h.toString(16).padStart(2,"0")}`}var bn={};X(bn,{applyDepthLayers:()=>Sa,applyFrostedGlassEffect:()=>wa,drawAtmosphericFog:()=>Pa,drawSunRays:()=>rr,gardenWindowBackground:()=>er,overgrownBackground:()=>nr,softGardenBackground:()=>Qn,terrariumBackground:()=>xn});function Qn(e,r,n){let o=e.createLinearGradient(0,0,0,n);o.addColorStop(0,re.background.light),o.addColorStop(.5,re.background.mid),o.addColorStop(1,re.background.dark),e.fillStyle=o,e.fillRect(0,0,r,n)}function xn(e,r,n){let o=e.createLinearGradient(0,0,0,n);o.addColorStop(0,q.background.deep),o.addColorStop(1,q.background.shadow),e.fillStyle=o,e.fillRect(0,0,r,n);let t=e.createLinearGradient(0,n*.2,0,n);t.addColorStop(0,q.background.mid),t.addColorStop(1,q.background.deep),e.fillStyle=t,e.globalAlpha=.6,e.fillRect(0,n*.3,r,n*.7),e.globalAlpha=1;let a=e.createLinearGradient(0,0,0,n*.4);a.addColorStop(0,q.background.surface),a.addColorStop(1,q.background.mid),e.fillStyle=a,e.globalAlpha=.5,e.fillRect(0,0,r,n*.4),e.globalAlpha=1}function er(e,r,n){let o=e.createLinearGradient(0,0,0,n);o.addColorStop(0,Z.garden.soft),o.addColorStop(.5,Z.garden.muted),o.addColorStop(1,Z.garden.distant),e.fillStyle=o,e.fillRect(0,0,r,n),e.fillStyle=Z.glass.tint,e.fillRect(0,0,r,n)}function nr(e,r,n){let o=e.createLinearGradient(0,0,0,n);o.addColorStop(0,F.background.vibrant),o.addColorStop(.4,F.background.dense),o.addColorStop(.7,F.background.dense),o.addColorStop(1,F.growth.shadow),e.fillStyle=o,e.fillRect(0,0,r,n);let t=e.createRadialGradient(r/2,n/2,Math.min(r,n)*.3,r/2,n/2,Math.max(r,n)*.8);t.addColorStop(0,"transparent"),t.addColorStop(.7,"rgba(0, 0, 0, 0.1)"),t.addColorStop(1,"rgba(0, 0, 0, 0.2)"),e.fillStyle=t,e.fillRect(0,0,r,n)}function Sa(e,r,n,o,t=3){for(let a=0;a<t;a++){let i=1/t*(a+1)*.2,s=o/t*a,l=o/t;e.fillStyle=r.includes("rgba")?r.replace(/[\d.]+\)$/,`${i})`):`rgba(0, 0, 0, ${i})`,e.fillRect(0,s,n,l)}}function rr(e,r,n,o=4){e.save();for(let t=0;t<o;t++){let a=Math.PI/o*(t+.5)-Math.PI/4,i=r*.5,s=n*-.2,l=i+Math.cos(a)*r,d=s+Math.sin(a)*n*1.5,m=e.createLinearGradient(i,s,l,d);m.addColorStop(0,"rgba(255, 248, 235, 0.3)"),m.addColorStop(.5,"rgba(255, 240, 220, 0.1)"),m.addColorStop(1,"transparent"),e.fillStyle=m,e.beginPath(),e.moveTo(i,s),e.lineTo(i+Math.cos(a)*r*1.5,s+Math.sin(a)*n*2),e.lineTo(i-Math.sin(a)*(r*.15),s+Math.cos(a)*(n*.15)),e.closePath(),e.fill()}e.restore()}function wa(e,r,n,o=.1){let t=document.createElement("canvas");t.width=100,t.height=100;let a=t.getContext("2d");if(!a)return;for(let s=0;s<100;s+=5)for(let l=0;l<100;l+=5){let d=Math.random()*o;a.fillStyle=`rgba(255, 255, 255, ${d})`,a.fillRect(s,l,5,5)}let i=e.createPattern(t,"repeat");i&&(e.fillStyle=i,e.fillRect(0,0,r,n))}function Pa(e,r,n,o=.3){let t=e.createLinearGradient(0,0,0,n);t.addColorStop(0,`rgba(255, 255, 255, ${o*.5})`),t.addColorStop(.5,`rgba(255, 255, 255, ${o})`),t.addColorStop(1,`rgba(255, 255, 255, ${o*.3})`),e.fillStyle=t,e.fillRect(0,0,r,n)}var gn={};X(gn,{createDustMotes:()=>sr,createFloatingLeaves:()=>or,createOvergrownParticles:()=>dr,createPollen:()=>hn,updateDustMotes:()=>lr,updateFloatingLeaves:()=>ir,updateOvergrownParticles:()=>ur,updatePollen:()=>ar});var tr={glacial:8e-4,verySlow:.001,slow:.002};function hn(e=35){let r=[];for(let n=0;n<e;n++)r.push({x:Math.random()*100,y:Math.random()*100,size:.8+Math.random()*2.2,speed:.001+Math.random()*.004,alpha:.15+Math.random()*.25,driftPhase:Math.random()*Math.PI*2});return r}function ar(e,r,n,o,t){e.forEach(a=>{a.y+=a.speed*t,a.y>110&&(a.y=-10),a.y<-5&&(a.y=105);let i=Math.sin(t*tr.glacial+a.driftPhase)*.3,s=(a.x+i)*(n/100),l=a.y*(o/100);r.save(),r.fillStyle=`rgba(245, 229, 184, ${a.alpha})`,r.beginPath(),r.arc(s,l,a.size,0,Math.PI*2),r.fill(),r.strokeStyle=`rgba(255, 240, 220, ${a.alpha*.5})`,r.lineWidth=.5,r.stroke(),r.restore()})}function or(e=18){let r=["oval","pointed","round"],n=[];for(let o=0;o<e;o++)n.push({x:Math.random()*100,y:Math.random()*100,size:3+Math.random()*5,speed:8e-4+Math.random()*.0022,alpha:.2+Math.random()*.3,rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*tr.verySlow,shape:r[Math.floor(Math.random()*r.length)]});return n}function ir(e,r,n,o,t){e.forEach(a=>{a.y+=a.speed*t*.5,a.x+=Math.sin(t*tr.glacial+a.y*.01)*a.speed*.3,a.rotation+=a.rotationSpeed*t,a.y>110&&(a.y=-10),a.x<-10&&(a.x=110),a.x>110&&(a.x=-10);let i=a.x*(n/100),s=a.y*(o/100);switch(r.save(),r.translate(i,s),r.rotate(a.rotation),r.fillStyle=`rgba(107, 143, 103, ${a.alpha})`,a.shape){case"oval":r.ellipse(0,0,a.size*1.5,a.size,0,0,Math.PI*2);break;case"pointed":r.beginPath(),r.moveTo(0,-a.size),r.quadraticCurveTo(a.size*.7,0,0,a.size),r.quadraticCurveTo(-a.size*.7,0,0,-a.size);break;case"round":r.arc(0,0,a.size,0,Math.PI*2);break}r.fill(),r.restore()})}function sr(e=55){let r=[];for(let n=0;n<e;n++)r.push({x:Math.random()*100,y:Math.random()*100,z:Math.random(),size:.5+Math.random()*1,speed:5e-4+Math.random()*.0015,alpha:.08+Math.random()*.17,phase:Math.random()*Math.PI*2});return r}function lr(e,r,n,o,t){e.forEach(a=>{a.x+=Math.sin(t*a.speed+a.phase)*a.speed*.5,a.y+=Math.cos(t*a.speed+a.phase*1.3)*a.speed*.5,a.x=(a.x+100)%100,a.y=(a.y+100)%100;let i=a.x*(n/100),s=a.y*(o/100);r.save();let l=a.alpha*(.5+a.z*.5);r.fillStyle=`rgba(220, 230, 240, ${l})`,r.beginPath(),r.arc(i,s,a.size,0,Math.PI*2),r.fill(),r.restore()})}function dr(e=75){let r=[];for(let n=0;n<e;n++){let o=Math.random()>.6;r.push({x:Math.random()*100,y:Math.random()*100,size:o?1.5+Math.random()*3:.8+Math.random()*2,speed:8e-4+Math.random()*.003,alpha:.2+Math.random()*.35,rotation:Math.random()*Math.PI*2,type:o?"fragment":"pollen"})}return r}function ur(e,r,n,o,t){e.forEach(a=>{a.y+=a.speed*t*1.2,a.x+=Math.sin(t*a.speed+a.y)*a.speed*.8,a.type==="fragment"&&(a.rotation+=a.speed*t*.3),a.y>110&&(a.y=-10),a.x<-10&&(a.x=110),a.x>110&&(a.x=-10);let i=a.x*(n/100),s=a.y*(o/100);r.save(),r.translate(i,s),a.type==="fragment"?(r.rotate(a.rotation),r.fillStyle=`rgba(95, 154, 92, ${a.alpha})`,r.fillRect(-a.size*.3,-a.size*.6,a.size*.6,a.size)):(r.fillStyle=`rgba(127, 166, 125, ${a.alpha})`,r.beginPath(),r.arc(0,0,a.size,0,Math.PI*2),r.fill()),r.restore()})}var yn={};X(yn,{drawBlurredPlant:()=>vn,drawFlower:()=>zt,drawFlowerCluster:()=>Ra,drawLeafCluster:()=>pn,drawOrganicVine:()=>le,drawPetal:()=>fn,drawPlantSilhouette:()=>Mn,drawPointedLeaf:()=>cn,drawSimpleLeaf:()=>he,drawVineSegment:()=>Bt});function he(e,r,n,o,t,a=0){e.save(),e.translate(r,n),e.rotate(a),e.fillStyle=t,e.beginPath(),e.moveTo(0,-o),e.quadraticCurveTo(o*.6,-o*.3,o*.5,0),e.quadraticCurveTo(o*.6,o*.3,0,o),e.quadraticCurveTo(-o*.6,o*.3,-o*.5,0),e.quadraticCurveTo(-o*.6,-o*.3,0,-o),e.closePath(),e.fill(),e.strokeStyle="rgba(0, 0, 0, 0.15)",e.lineWidth=.5,e.beginPath(),e.moveTo(0,-o),e.quadraticCurveTo(o*.1,0,0,o),e.stroke(),e.restore()}function cn(e,r,n,o,t,a=0){e.save(),e.translate(r,n),e.rotate(a),e.fillStyle=t,e.beginPath(),e.moveTo(0,-o*1.2),e.quadraticCurveTo(o*.5,-o*.4,o*.6,o*.3),e.quadraticCurveTo(o*.3,o*.8,0,o),e.quadraticCurveTo(-o*.3,o*.8,-o*.6,o*.3),e.quadraticCurveTo(-o*.5,-o*.4,0,-o*1.2),e.closePath(),e.fill(),e.restore()}function pn(e,r,n,o=5,t=8,a="#6b8f67",i=1){e.save();for(let s=0;s<o;s++){let l=(Math.random()-.5)*t*i,d=(Math.random()-.5)*t*i,m=s/o*Math.PI*2,u=.6+Math.random()*.4;e.globalAlpha=u,s%2===0?he(e,r+l,n+d,t*.7,a,m):cn(e,r+l,n+d,t*.6,a,m)}e.globalAlpha=1,e.restore()}function fn(e,r,n,o,t,a,i=0){e.save(),e.translate(r,n),e.rotate(i),e.fillStyle=a,e.beginPath(),e.ellipse(0,0,o*.5,t,0,0,Math.PI*2),e.fill(),e.restore()}function Bt(e,r,n,o,t,a,i,s=.1){e.save();let l=(r+o)/2+(Math.random()-.5)*s*20,d=(n+t)/2+(Math.random()-.5)*s*20;e.strokeStyle=i,e.lineWidth=a,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(r,n),e.quadraticCurveTo(l,d,o,t),e.stroke(),e.restore()}function le(e,r,n,o,t,a,i,s=0,l=3){if(s>l||a<.5)return;let d=r+Math.cos(t)*o,m=n+Math.sin(t)*o;if(Bt(e,r,n,d,m,a,i,.08),s<l){let u=o*.7,b=a*.75,h=t-.4+(Math.random()-.5)*.2;le(e,d,m,u,h,b,i,s+1,l);let g=t+.4+(Math.random()-.5)*.2;le(e,d,m,u,g,b,i,s+1,l)}}function zt(e,r,n,o=5,t=6,a="#a8c69f",i="#f5e5b8"){e.save();for(let s=0;s<o;s++){let l=s/o*Math.PI*2,d=r+Math.cos(l)*t*.8,m=n+Math.sin(l)*t*.8;fn(e,d,m,t*.6,t,a,l)}e.fillStyle=i,e.beginPath(),e.arc(r,n,t*.4,0,Math.PI*2),e.fill(),e.restore()}function Ra(e,r,n,o=3,t=30){for(let a=0;a<o;a++){let i=(Math.random()-.5)*t,s=(Math.random()-.5)*t,l=4+Math.floor(Math.random()*3);zt(e,r+i,n+s,l,4+Math.random()*2)}}function vn(e,r,n,o,t,a=4){e.save(),e.filter=`blur(${a}px)`,e.globalAlpha=.4,pn(e,r,n,8,o,t,1.5),e.filter="none",e.globalAlpha=1,e.restore()}function Mn(e,r,n,o,t,a=6){e.save(),e.fillStyle=t,e.fillRect(r-1,n,2,o);for(let i=0;i<a;i++){let s=n+o/a*i,l=4+(a-i)*.5;i%2===0?he(e,r-l*.8,s,l,t,-.3):he(e,r+l*.8,s,l,t,.3)}e.restore()}var Cn={};X(Cn,{drawAnimatedShimmer:()=>Oa,drawDepthFog:()=>$a,drawEdgeVignette:()=>Ia,drawFrostedGlassOverlay:()=>mr,drawGlassSmudges:()=>br,drawLensDamage:()=>cr,drawLensReflection:()=>ka,drawLightRays:()=>Ta,drawOrganicNoise:()=>gr,drawVignette:()=>hr});function mr(e,r,n,o=.15){e.save(),e.fillStyle=`rgba(245, 248, 250, ${o*.3})`,e.fillRect(0,0,r,n);for(let t=0;t<r;t+=8)for(let a=0;a<n;a+=8){let i=Math.random()*o*.5;e.fillStyle=`rgba(255, 255, 255, ${i})`,e.fillRect(t,a,Math.random()*4+2,Math.random()*4+2)}e.restore()}function br(e,r,n,o=8){e.save();for(let t=0;t<o;t++){let a=Math.random()*r,i=Math.random()*n,s=20+Math.random()*40,l=3+Math.random()*8,d=e.createLinearGradient(a,i,a,i+l*2);d.addColorStop(0,`rgba(220, 230, 235, ${Math.random()*.08})`),d.addColorStop(.5,`rgba(200, 210, 220, ${Math.random()*.1})`),d.addColorStop(1,"transparent"),e.fillStyle=d,e.fillRect(a,i,s,l)}e.restore()}function $a(e,r,n,o="rgba(255, 255, 255, 0.3)",t=3){e.save();for(let a=0;a<t;a++){let i=n/t*a,s=n/t,l=1/t*(a+1)*.15,d=e.createLinearGradient(0,i,0,i+s);d.addColorStop(0,`rgba(255, 255, 255, ${l*.5})`),d.addColorStop(.5,`rgba(255, 255, 255, ${l})`),d.addColorStop(1,`rgba(255, 255, 255, ${l*.5})`),e.fillStyle=d,e.fillRect(0,i,r,s)}e.restore()}function hr(e,r,n,o=.3){e.save();let t=e.createRadialGradient(r/2,n/2,Math.min(r,n)*.2,r/2,n/2,Math.max(r,n)*.8);t.addColorStop(0,"transparent"),t.addColorStop(.6,`rgba(0, 0, 0, ${o*.3})`),t.addColorStop(1,`rgba(0, 0, 0, ${o})`),e.fillStyle=t,e.fillRect(0,0,r,n),e.restore()}function gr(e,r,n,o=.2,t=20){e.save();for(let a=0;a<r;a+=t)for(let i=0;i<n;i+=t){let s=Math.random()*o;e.fillStyle=`rgba(0, 0, 0, ${s})`,e.fillRect(a,i,t,t)}e.restore()}function ka(e,r,n,o=40,t=.3){e.save();let a=e.createRadialGradient(r,n,0,r,n,o);a.addColorStop(0,`rgba(255, 255, 255, ${t})`),a.addColorStop(.5,`rgba(255, 255, 255, ${t*.3})`),a.addColorStop(1,"transparent"),e.fillStyle=a,e.beginPath(),e.arc(r,n,o,0,Math.PI*2),e.fill(),e.restore()}function cr(e,r,n,o=3){e.save(),e.strokeStyle="rgba(100, 100, 100, 0.3)",e.lineWidth=1,e.lineCap="round";for(let t=0;t<o;t++){let a=Math.random()*r,i=Math.random()*n,s=a+(Math.random()-.5)*200,l=i+(Math.random()-.5)*200;e.beginPath(),e.moveTo(a,i);for(let d=0;d<10;d++){let m=a+(s-a)*d/10+(Math.random()-.5)*10,u=i+(l-i)*d/10+(Math.random()-.5)*10;e.lineTo(m,u)}e.lineTo(s,l),e.stroke()}e.restore()}function Ta(e,r,n,o=4,t=.2){e.save();for(let a=0;a<o;a++){let i=Math.PI/o*a-Math.PI/8,s=r/2,l=-n*.2,d=s+Math.cos(i)*r*1.5,m=l+Math.sin(i)*n*2,u=e.createLinearGradient(s,l,d,m);u.addColorStop(0,`rgba(255, 248, 235, ${t})`),u.addColorStop(.5,`rgba(255, 240, 220, ${t*.5})`),u.addColorStop(1,"transparent"),e.fillStyle=u,e.beginPath(),e.moveTo(s,l),e.lineTo(d,m),e.lineTo(s-Math.sin(i)*r*.3,l+Math.cos(i)*n*.3),e.closePath(),e.fill()}e.restore()}function Ia(e,r,n,o="rgba(0, 0, 0, 0.3)",t=40){e.save(),e.fillStyle=o,e.fillRect(0,0,r,t),e.fillRect(0,n-t,r,t),e.fillRect(0,0,t,n),e.fillRect(r-t,0,t,n),e.restore()}function Oa(e,r,n,o,t,a,i=.15){e.save();let s=Math.sin(a*.002)*i;e.fillStyle=`rgba(255, 255, 255, ${s})`,e.fillRect(r,n,o,t),e.restore()}var pr={};X(pr,{drawGardenThroughGlass:()=>Xt,drawOvergrownCamera:()=>Yt,drawSoftGardenWindow:()=>Et,drawTerrariumView:()=>Wt});var ge={glacial:8e-4,verySlow:.001,slow:.002},Da={pollenParticles:hn(35)};function Et(e,r,n,o,t,a={}){let{time:i=0,intensity:s=1}=a;e.save(),e.translate(r,n),Qn(e,o,t),e.globalAlpha=.3*s,rr(e,o,t,4),e.globalAlpha=1,ar(Da.pollenParticles,e,o,t,i),e.globalAlpha=.25*s;for(let l=0;l<6;l++){let d=(Math.sin(i*ge.glacial+l)*.5+.5)*o,m=(Math.cos(i*ge.glacial+l*.7)*.5+.5)*t;fn(e,d,m,3,5,re.accents.pollen,0)}e.globalAlpha=1,e.restore()}var Ga={leafParticles:or(18)};function Wt(e,r,n,o,t,a={}){let{time:i=0,growthLevel:s=0,intensity:l=1}=a;e.save(),e.translate(r,n),xn(e,o,t),e.globalAlpha=.35*l;for(let d=0;d<6;d++){let m=o/6*d+Math.sin(i*ge.verySlow+d)*20,u=t*.3+(Math.random()*30-15);vn(e,m,u,12+Math.random()*8,q.foliage.shadow)}e.globalAlpha=1,e.globalAlpha=.6*l;for(let d=0;d<5;d++){let m=(Math.random()*.8+.1)*o,u=(Math.random()*.4+.2)*t;pn(e,m,u,6,8,q.foliage.mature,1.2)}e.globalAlpha=1,ir(Ga.leafParticles,e,o,t,i),e.globalAlpha=.8*l,Mn(e,o*.15,t*.4,t*.5,q.background.shadow,7),Mn(e,o*.85,t*.35,t*.55,q.background.shadow,8),e.globalAlpha=1,e.strokeStyle=`rgba(200, 220, 230, ${.1*l})`,e.lineWidth=2,e.strokeRect(10,10,o-20,t-20),e.restore()}var La={dustMotes:sr(55),pollenParticles:hn(15)};function Xt(e,r,n,o,t,a={}){let{time:i=0,intensity:s=1}=a;e.save(),e.translate(r,n),er(e,o,t),e.globalAlpha=.25*s;for(let l=0;l<10;l++){let d=(Math.random()*.8+.1)*o,m=(Math.random()*.6+.1)*t;vn(e,d,m,15+Math.random()*10,Z.garden.soft,8)}e.globalAlpha=1,lr(La.dustMotes,e,o,t,i),e.globalAlpha=.2*s,mr(e,o,t,.12),e.globalAlpha=1,e.globalAlpha=.15*s,br(e,o,t,6),e.globalAlpha=1,e.globalAlpha=.3*s,hr(e,o,t,.25),e.globalAlpha=1,e.restore()}var Aa={particles:dr(75)};function Yt(e,r,n,o,t,a={}){let{time:i=0,growthLevel:s=0,intensity:l=1}=a;e.save(),e.translate(r,n),nr(e,o,t),e.globalAlpha=.7*l;for(let d=0;d<3;d++){let m=t/3*d+Math.sin(i*ge.verySlow+d)*20;le(e,-10,m,60+d*20,.2+Math.random()*.3,2+d*.5,F.growth.vine,0,2)}for(let d=0;d<3;d++){let m=t/3*d+Math.cos(i*ge.verySlow+d*1.5)*20;le(e,o+10,m,60+d*20,Math.PI-(.2+Math.random()*.3),2+d*.5,F.growth.vine,0,2)}for(let d=0;d<2;d++){let m=o/2.5*d+Math.sin(i*ge.verySlow+d*2)*20;le(e,m,-10,50+d*15,Math.PI/2+(Math.random()-.5)*.4,1.5+d*.5,F.growth.vine,0,2)}e.globalAlpha=1,e.globalAlpha=.65*l;for(let d=0;d<40;d++){let m=Math.random()*o,u=Math.random()*t,b=3+Math.random()*6,h=Math.random()*Math.PI*2;Math.random()>.5?he(e,m,u,b,F.growth.leaf,h):cn(e,m,u,b,F.growth.wild,h)}e.globalAlpha=1,ur(Aa.particles,e,o,t,i),e.globalAlpha=.2*l,gr(e,o,t,.15,30),e.globalAlpha=1,s>50&&(e.globalAlpha=.15*l,cr(e,o,t,2),e.globalAlpha=1),e.restore()}ee("garden",{colors:mn,gradients:bn,particles:gn,plants:yn,textures:Cn,recipes:pr});return _t(Ba);})();
